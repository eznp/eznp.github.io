

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/III.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Zer0">
  <meta name="keywords" content="">
  
    <meta name="description" content="PWN学习小记（1）汇编基础CPU结构和指令集CPU是名称为中央处理单元，简称处理器，主要的作用是从内存中读取指令，然后解码和执行。CPU架构就是CPU内部设计的结构，是一堆硬件组成，用于实现指令集所规定的操作，指令集包含了一系列的操作码以及特定的CPU执行的基本命令。根据现在指令集的特征，可以分为两类：CSSC（复杂指令集计算机，代表的是x86处理器）和RISC（精简指令集计算机，典型代表是AR">
<meta property="og:type" content="article">
<meta property="og:title" content="pwn学习小记（1）">
<meta property="og:url" content="https://eznp.github.io/2025/10/04/pwn%E5%AD%A6%E4%B9%A0%E5%B0%8F%E8%AE%B0%EF%BC%881%EF%BC%89/index.html">
<meta property="og:site_name" content="Zer0">
<meta property="og:description" content="PWN学习小记（1）汇编基础CPU结构和指令集CPU是名称为中央处理单元，简称处理器，主要的作用是从内存中读取指令，然后解码和执行。CPU架构就是CPU内部设计的结构，是一堆硬件组成，用于实现指令集所规定的操作，指令集包含了一系列的操作码以及特定的CPU执行的基本命令。根据现在指令集的特征，可以分为两类：CSSC（复杂指令集计算机，代表的是x86处理器）和RISC（精简指令集计算机，典型代表是AR">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-04T12:16:25.000Z">
<meta property="article:modified_time" content="2025-10-04T12:16:57.305Z">
<meta property="article:author" content="Zer0">
<meta property="article:tag" content="-pwn">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>pwn学习小记（1） - Zer0</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"eznp.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Zer0" type="application/atom+xml">
</head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Zer0</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/P.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="pwn学习小记（1）"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-04 20:16" pubdate>
          2025年10月4日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          54 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">pwn学习小记（1）</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="PWN学习小记（1）"><a href="#PWN学习小记（1）" class="headerlink" title="PWN学习小记（1）"></a>PWN学习小记（1）</h1><h2 id="汇编基础"><a href="#汇编基础" class="headerlink" title="汇编基础"></a>汇编基础</h2><h3 id="CPU结构和指令集"><a href="#CPU结构和指令集" class="headerlink" title="CPU结构和指令集"></a>CPU结构和指令集</h3><p><strong>CPU</strong>是名称为中央处理单元，简称处理器，主要的作用是从内存中读取指令，然后解码和执行。<br><strong>CPU</strong>架构就是<strong>CPU</strong>内部设计的结构，是一堆硬件组成，用于实现<code>指令集</code>所规定的操作，指令集包含了一系列的操作码以及特定的CPU执行的基本命令。根据现在指令集的特征，可以分为两类：<strong>CSSC</strong>（复杂指令集计算机，代表的是x86处理器）和<strong>RISC</strong>（精简指令集计算机，典型代表是ARM处理器）。<strong>RISC</strong>可以完全使用寄存器来传递参数，而<strong>CISC</strong>只能使用栈，或者是栈和寄存器结合起来使用</p>
<h3 id="语法风格"><a href="#语法风格" class="headerlink" title="语法风格"></a>语法风格</h3><p>x86汇编主要的语法有两种风格: <code>AT&amp;T</code>和<code>Intel</code>风格</p>
<p>通常在<code>Linux</code>中见到的<code>AT&amp;T</code>的风格比较多，常见的<code>GCC、GDB、objdump</code>都是使用的<code>AT&amp;T</code>风格，他们两个之间语法有一些简单的区别，我们主要了解Intel风格</p>
<p>有很多细节的不同，<code>AT&amp;T</code>的特征是寄存器和数字的前面通常会加入<code>% $</code>的符号，<code>Intel</code>没有，十六进制使用的是<code>0x</code>而<code>Intel</code>使用的是后方计入<code>h</code></p>
<h3 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h3><p>寄存器是 CPU 内部用于存放数据、地址和状态信息的高速存储单元，是 CPU 进行计算和控制的核心组成部分。</p>
<p>下面是8到64位寄存器的实例和说明</p>
<table>
<thead>
<tr>
<th>位数</th>
<th>通用寄存器示例</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>8 位</strong></td>
<td>AL, AH, BL, BH, CL, CH, DL, DH</td>
<td>8086 中 AX、BX、CX、DX 的高 8 位&#x2F;低 8 位拆分</td>
</tr>
<tr>
<td><strong>16 位</strong></td>
<td>AX, BX, CX, DX, SP, BP, SI, DI</td>
<td>8086 基本寄存器：累加、基址、计数、数据、堆栈指针、基址指针、变址寄存器</td>
</tr>
<tr>
<td><strong>32 位</strong></td>
<td>EAX, EBX, ECX, EDX, ESP, EBP, ESI, EDI</td>
<td>IA-32 架构：E 前缀表示扩展为 32 位</td>
</tr>
<tr>
<td><strong>64 位</strong></td>
<td>RAX, RBX, RCX, RDX, RSP, RBP, RSI, RDI，及 R8–R15</td>
<td>x86-64 架构：R 前缀表示 64 位，新增 R8–R15 共 16 个通用寄存器</td>
</tr>
</tbody></table>
<p>补充：</p>
<ul>
<li>在 64 位模式下，<strong>默认操作数大小是 32 位</strong>，如果要使用 64 位操作数，需要在指令中加上 REX 前缀（由汇编器自动生成）。</li>
<li><strong>R8–R15</strong> 的低 32 位、16 位和 8 位也能单独访问（如 R8D, R8W, R8B）。</li>
</ul>
<hr>
<h4 id="常量表示方法"><a href="#常量表示方法" class="headerlink" title="常量表示方法"></a>常量表示方法</h4><h5 id="（1）整数常量"><a href="#（1）整数常量" class="headerlink" title="（1）整数常量"></a>（1）整数常量</h5><ul>
<li><strong>十进制（默认）</strong>：直接写，例如 <code>1234</code>。</li>
<li><strong>十六进制</strong>：x86 汇编常用写法是 <strong>后缀 h</strong>，如 <code>1Ah</code>，如果首位是字母要在前加 <code>0</code>，如 <code>0ABCh</code>。<ul>
<li>C 语言风格：<code>0x1A</code>。</li>
</ul>
</li>
<li><strong>八进制</strong>：前缀 <code>0</code>，如 <code>0123</code>（等于十进制 83）。</li>
<li><strong>二进制</strong>：某些汇编器支持后缀 <code>b</code>，如 <code>1010b</code>。</li>
</ul>
<hr>
<h5 id="（2）浮点数常量（实数常量）"><a href="#（2）浮点数常量（实数常量）" class="headerlink" title="（2）浮点数常量（实数常量）"></a>（2）浮点数常量（实数常量）</h5><ul>
<li>必须有整数部分和小数部分至少一部分，比如：<ul>
<li><code>1.0</code></li>
<li><code>0.5</code></li>
<li><code>3.</code>（整数部分+小数点）</li>
<li><code>.25</code>（小数点+小数部分）</li>
</ul>
</li>
<li>可以带正负号：<code>+2.3</code>，<code>-3.14159</code>。</li>
<li>科学计数法：<code>26.E3</code>（即 26 × 10³）。</li>
</ul>
<hr>
<h5 id="（3）字符串常量"><a href="#（3）字符串常量" class="headerlink" title="（3）字符串常量"></a>（3）字符串常量</h5><ul>
<li><p>用 <strong>单引号 <code>&#39;</code></strong> 或 <strong>双引号 <code>&quot;</code></strong> 包裹：</p>
<ul>
<li><code>&#39;abc&#39;</code> 或 <code>&quot;abc&quot;</code></li>
</ul>
</li>
<li><p>在汇编中字符串常量通常是 <strong>一串 ASCII 字符</strong>，比如：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">msg</span> db <span class="hljs-string">&#x27;Hello, world!&#x27;</span>, <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>这里 <code>db</code> 定义字节数组，最后的 <code>0</code> 代表字符串结束符（C 风格）。</p>
</li>
</ul>
<h4 id="常见寄存器"><a href="#常见寄存器" class="headerlink" title="常见寄存器"></a>常见寄存器</h4><h4 id="32位CPU"><a href="#32位CPU" class="headerlink" title="32位CPU"></a>32位CPU</h4><h5 id="1-通用寄存器"><a href="#1-通用寄存器" class="headerlink" title="1. 通用寄存器"></a><strong>1. 通用寄存器</strong></h5><p>4 个最基本的通用寄存器，每个 32 位，可以拆分访问：</p>
<ul>
<li><strong>EAX</strong>：累加器（Accumulator），常用于算术运算、函数返回值。<ul>
<li>高 16 位：AX → AH（高 8 位）、AL（低 8 位）</li>
</ul>
</li>
<li><strong>EBX</strong>：基址寄存器（Base Register），常用作内存访问基址。</li>
<li><strong>ECX</strong>：计数寄存器（Counter Register），常用于循环、移位&#x2F;旋转操作。</li>
<li><strong>EDX</strong>：数据寄存器（Data Register），常配合 EAX 参与乘除法运算，高位存放结果。</li>
</ul>
<blockquote>
<p>特点：虽然称为“通用”，但在指令集里常有特定用途。</p>
</blockquote>
<hr>
<h5 id="2-段寄存器"><a href="#2-段寄存器" class="headerlink" title="2. 段寄存器"></a><strong>2. 段寄存器</strong></h5><p>8086 的分段机制在 32 位中仍保留，但在保护模式下意义有所变化。共有 6 个段寄存器，每个 16 位：</p>
<ul>
<li><strong>CS</strong>：代码段寄存器（Code Segment）</li>
<li><strong>DS</strong>：数据段寄存器（Data Segment）</li>
<li><strong>SS</strong>：堆栈段寄存器（Stack Segment）</li>
<li><strong>ES</strong>：附加数据段寄存器（Extra Segment）</li>
<li><strong>FS</strong>：附加段寄存器（常用于线程本地存储 TLS 等）</li>
<li><strong>GS</strong>：附加段寄存器（在操作系统和多任务环境中常有特殊用途）</li>
</ul>
<blockquote>
<p>在 32 位保护模式中，这些寄存器通常保存的是“段选择子”，对应 <strong>GDT&#x2F;LDT 表项</strong>。</p>
</blockquote>
<hr>
<h5 id="3-变址寄存器"><a href="#3-变址寄存器" class="headerlink" title="3. 变址寄存器"></a><strong>3. 变址寄存器</strong></h5><ul>
<li><strong>ESI</strong>（Extended Source Index）：扩展源变址寄存器</li>
<li><strong>EDI</strong>（Extended Destination Index）：扩展目的变址寄存器</li>
</ul>
<p>主要用于数组、字符串、内存块操作，常与 <code>MOVSx</code>、<code>CMPSx</code>、<code>SCASx</code> 等字符串指令配合。<br> 其低 16 位与 8086 的 <strong>SI、DI</strong> 兼容。</p>
<hr>
<h5 id="4-指针寄存器"><a href="#4-指针寄存器" class="headerlink" title="4. 指针寄存器"></a><strong>4. 指针寄存器</strong></h5><ul>
<li><strong>ESP</strong>（Extended Stack Pointer）：堆栈指针寄存器，指向当前栈顶。</li>
<li><strong>EBP</strong>（Extended Base Pointer）：基址指针寄存器，常用于访问栈帧中的参数和局部变量。</li>
</ul>
<hr>
<h5 id="5-指令指针寄存器"><a href="#5-指令指针寄存器" class="headerlink" title="5. 指令指针寄存器"></a><strong>5. 指令指针寄存器</strong></h5><ul>
<li><p><strong>EIP</strong>（Extended Instruction Pointer）：保存下一条即将执行指令的偏移地址。</p>
<blockquote>
<p>CPU 自动更新 EIP，程序员一般不能直接修改（必须用跳转、调用、返回等指令间接修改）。</p>
</blockquote>
</li>
</ul>
<hr>
<h5 id="6-标志寄存器"><a href="#6-标志寄存器" class="headerlink" title="6. 标志寄存器"></a><strong>6. 标志寄存器</strong></h5><p>32 位的标志寄存器，存放算术&#x2F;逻辑运算的状态信息和控制标志。<br> 常见标志位：</p>
<ul>
<li><strong>ZF</strong>：零标志（Zero Flag）</li>
<li><strong>CF</strong>：进位标志（Carry Flag）</li>
<li><strong>SF</strong>：符号标志（Sign Flag）</li>
<li><strong>OF</strong>：溢出标志（Overflow Flag）</li>
<li><strong>IF</strong>：中断允许标志（Interrupt Flag）</li>
<li><strong>DF</strong>：方向标志（Direction Flag）</li>
</ul>
<table>
<thead>
<tr>
<th>类别</th>
<th>寄存器</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>通用寄存器</td>
<td>EAX, EBX, ECX, EDX</td>
<td>算术、逻辑、计数、基址等</td>
</tr>
<tr>
<td>段寄存器</td>
<td>CS, DS, SS, ES, FS, GS</td>
<td>分段寻址（保护模式下为选择子）</td>
</tr>
<tr>
<td>变址寄存器</td>
<td>ESI, EDI</td>
<td>数组、字符串、块操作</td>
</tr>
<tr>
<td>指针寄存器</td>
<td>ESP, EBP</td>
<td>栈顶指针、栈帧基址</td>
</tr>
<tr>
<td>指令指针寄存器</td>
<td>EIP</td>
<td>指向下一条指令</td>
</tr>
<tr>
<td>标志寄存器</td>
<td>EFLAGS</td>
<td>记录结果状态、控制流程</td>
</tr>
</tbody></table>
<h4 id="16位CPU"><a href="#16位CPU" class="headerlink" title="16位CPU"></a>16位CPU</h4><p>8086 是经典的 <strong>16 位 CPU</strong>，内部所有寄存器宽度为 <strong>16 位</strong>。它的寄存器主要分为以下几类：</p>
<h5 id="（1）通用寄存器"><a href="#（1）通用寄存器" class="headerlink" title="（1）通用寄存器"></a>（1）通用寄存器</h5><p>共有 4 个，每个 16 位，可以再分为高 8 位和低 8 位：</p>
<ul>
<li><strong>AX</strong>（累加器，Accumulator） → AH（高 8 位）、AL（低 8 位）</li>
<li><strong>BX</strong>（基址寄存器，Base） → BH、BL</li>
<li><strong>CX</strong>（计数寄存器，Count） → CH、CL</li>
<li><strong>DX</strong>（数据寄存器，Data） → DH、DL</li>
</ul>
<p>作用：</p>
<ul>
<li><strong>AX</strong> 常用于算术逻辑运算，很多指令默认使用它。</li>
<li><strong>BX</strong> 常用作内存寻址的基址。</li>
<li><strong>CX</strong> 常用作循环&#x2F;移位的计数器（比如 <code>LOOP</code> 指令）。</li>
<li><strong>DX</strong> 常用于乘法、除法的扩展寄存器。</li>
</ul>
<hr>
<h5 id="（2）段寄存器"><a href="#（2）段寄存器" class="headerlink" title="（2）段寄存器"></a>（2）段寄存器</h5><p>8086 采用 <strong>分段存储管理</strong>，物理地址 &#x3D; 段基址（段寄存器 ×16） + 偏移量。</p>
<ul>
<li><strong>CS</strong>（代码段寄存器）</li>
<li><strong>DS</strong>（数据段寄存器）</li>
<li><strong>SS</strong>（堆栈段寄存器）</li>
<li><strong>ES</strong>（附加段寄存器）</li>
</ul>
<p>用途：</p>
<ul>
<li><strong>CS:IP</strong> 指定当前正在执行的指令地址。</li>
<li><strong>SS:SP</strong> 指定当前栈顶位置。</li>
<li><strong>DS、ES</strong> 常用于数据访问，ES 常配合字符串操作。</li>
</ul>
<hr>
<h5 id="（3）指针与变址寄存器"><a href="#（3）指针与变址寄存器" class="headerlink" title="（3）指针与变址寄存器"></a>（3）指针与变址寄存器</h5><ul>
<li><strong>SP</strong>（栈指针，Stack Pointer）：指向栈顶，配合 SS。</li>
<li><strong>BP</strong>（基址指针，Base Pointer）：主要用于访问栈中的参数和局部变量。</li>
<li><strong>SI</strong>（源变址寄存器，Source Index）：常用于数组、字符串操作（数据源）。</li>
<li><strong>DI</strong>（目的变址寄存器，Destination Index）：常用于数组、字符串操作（数据目的地）。</li>
</ul>
<hr>
<h5 id="（4）指令指针寄存器"><a href="#（4）指令指针寄存器" class="headerlink" title="（4）指令指针寄存器"></a>（4）指令指针寄存器</h5><ul>
<li><strong>IP</strong>（Instruction Pointer）：保存下一条要执行指令在代码段内的偏移量。<br>和 <strong>CS</strong> 配合：<strong>CS:IP</strong> 就是当前指令的物理地址。</li>
</ul>
<hr>
<h5 id="（5）标志寄存器"><a href="#（5）标志寄存器" class="headerlink" title="（5）标志寄存器"></a>（5）标志寄存器</h5><p>8086 的 <strong>FLAGS 寄存器（16 位）</strong> 保存运算状态和控制信息。<br> 常见标志位：</p>
<ul>
<li><strong>ZF</strong>（Zero Flag，零标志）</li>
<li><strong>CF</strong>（Carry Flag，进位标志）</li>
<li><strong>SF</strong>（Sign Flag，符号标志）</li>
<li><strong>OF</strong>（Overflow Flag，溢出标志）</li>
<li><strong>IF</strong>（Interrupt Enable，中断允许）</li>
<li><strong>DF</strong>（Direction Flag，字符串操作方向）</li>
</ul>
<table>
<thead>
<tr>
<th>类别</th>
<th>寄存器</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>通用寄存器</td>
<td>AX, BX, CX, DX（可拆 AH&#x2F;AL 等）</td>
<td>存放操作数、结果，部分有专用用途</td>
</tr>
<tr>
<td>段寄存器</td>
<td>CS, DS, SS, ES</td>
<td>用于分段寻址，提供段基址</td>
</tr>
<tr>
<td>指针寄存器</td>
<td>SP, BP</td>
<td>指向栈顶、基址（栈帧）</td>
</tr>
<tr>
<td>变址寄存器</td>
<td>SI, DI</td>
<td>用于字符串、数组操作</td>
</tr>
<tr>
<td>指令指针寄存器</td>
<td>IP</td>
<td>存放下一条指令偏移地址</td>
</tr>
<tr>
<td>标志寄存器</td>
<td>FLAGS</td>
<td>存放状态和控制标志</td>
</tr>
</tbody></table>
<p><strong>AX、BX、CX、DX</strong> → CPU 的“算术草稿本”。</p>
<p><strong>CS、DS、SS、ES</strong> → 指定不同“书本章节”（代码段、数据段、栈段）。</p>
<p><strong>SP、BP、SI、DI</strong> → 用来在“书中”翻页找具体数据。</p>
<p><strong>IP</strong> → 当前读到的“下一句”。</p>
<p><strong>FLAGS</strong> → CPU 计算结果的“批注标记”。</p>
<h4 id="64位CPU"><a href="#64位CPU" class="headerlink" title="64位CPU"></a>64位CPU</h4><p>64 位寄存器架构在 32 位的基础上扩展了通用寄存器数量与宽度，弱化了段寄存器功能，同时引入了更强大的 SIMD 寄存器体系。</p>
<h5 id="1-通用寄存器-1"><a href="#1-通用寄存器-1" class="headerlink" title="1. 通用寄存器"></a>1. 通用寄存器</h5><p>在 <strong>x86-64 架构</strong>中，共有 <strong>16 个 64 位通用寄存器</strong>：</p>
<ul>
<li><strong>原有的 8 个寄存器</strong>（由 32 位扩展而来）：<ul>
<li>RAX, RBX, RCX, RDX, RSP, RBP, RSI, RDI</li>
</ul>
</li>
<li><strong>新增的 8 个寄存器</strong>：<ul>
<li>R8, R9, R10, R11, R12, R13, R14, R15</li>
</ul>
</li>
</ul>
<p>特点：</p>
<ol>
<li>每个寄存器都是 <strong>64 位</strong>，并且可以分段访问：<ul>
<li>RAX → EAX (32位) → AX (16位) → AH&#x2F;AL (8位)</li>
<li>R8 → R8D (32位) → R8W (16位) → R8B (8位)</li>
</ul>
</li>
<li>使用方式完全兼容旧的 32 位和 16 位寄存器。</li>
</ol>
<hr>
<h5 id="2-指针与栈相关寄存器"><a href="#2-指针与栈相关寄存器" class="headerlink" title="2. 指针与栈相关寄存器"></a>2. 指针与栈相关寄存器</h5><ul>
<li><strong>RSP</strong>（Stack Pointer）：栈顶指针</li>
<li><strong>RBP</strong>（Base Pointer）：栈基址指针，常用于函数调用栈帧</li>
<li><strong>RIP</strong>（Instruction Pointer）：指向下一条即将执行的指令地址（在 64 位模式下是 64 位宽度）。</li>
</ul>
<hr>
<h5 id="3-段寄存器"><a href="#3-段寄存器" class="headerlink" title="3. 段寄存器"></a>3. 段寄存器</h5><p>虽然 <strong>x86-64 仍然保留了段寄存器（CS、DS、SS、ES、FS、GS）</strong>，<br> 但在 64 位长模式下，大部分段机制被弱化：</p>
<ul>
<li>CS、DS、SS、ES 基本被固定使用，几乎不起作用。</li>
<li><strong>FS、GS</strong> 仍然有用，常用于存放 <strong>线程本地存储（TLS）</strong> 或操作系统内核结构的基地址。</li>
</ul>
<hr>
<h5 id="4-标志寄存器"><a href="#4-标志寄存器" class="headerlink" title="4. 标志寄存器"></a>4. 标志寄存器</h5><ul>
<li>64 位扩展的 <strong>RFLAGS</strong>（以前是 EFLAGS&#x2F;FLAGS），保存运算状态与控制标志。</li>
<li>常见标志位：<ul>
<li>CF（进位标志）、ZF（零标志）、SF（符号标志）、OF（溢出标志）、IF（中断允许）、DF（方向标志）等。</li>
</ul>
</li>
</ul>
<hr>
<h5 id="5-控制寄存器"><a href="#5-控制寄存器" class="headerlink" title="5. 控制寄存器"></a>5. 控制寄存器</h5><ul>
<li><strong>CR0, CR2, CR3, CR4, CR8</strong> 等，用于存储分页机制、虚拟内存、保护模式和特权级信息。<ul>
<li>CR3：页目录基地址寄存器（内存分页关键）。</li>
<li>CR8：任务优先级控制（TLP）。</li>
</ul>
</li>
</ul>
<hr>
<h5 id="6-SIMD-浮点寄存器"><a href="#6-SIMD-浮点寄存器" class="headerlink" title="6. SIMD&#x2F;浮点寄存器"></a>6. SIMD&#x2F;浮点寄存器</h5><p>除了通用寄存器外，64 位 CPU 还包含丰富的 SIMD 和浮点扩展寄存器：</p>
<ul>
<li><strong>XMM0–XMM15</strong>（128 位，SSE 指令集）</li>
<li><strong>YMM0–YMM15</strong>（256 位，AVX 指令集）</li>
<li><strong>ZMM0–ZMM31</strong>（512 位，AVX-512 指令集，部分 CPU 支持）</li>
<li><strong>x87 FPU 寄存器栈</strong>（ST0–ST7，80 位浮点寄存器，兼容旧代码）</li>
</ul>
<table>
<thead>
<tr>
<th>类别</th>
<th>64 位寄存器</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>通用寄存器</td>
<td>RAX, RBX, RCX, RDX, RSI, RDI, RBP, RSP, R8–R15</td>
<td>16 个通用寄存器，64 位宽</td>
</tr>
<tr>
<td>指令指针</td>
<td>RIP</td>
<td>下一条执行指令地址</td>
</tr>
<tr>
<td>段寄存器</td>
<td>CS, DS, SS, ES, FS, GS</td>
<td>长模式下大多弱化，FS&#x2F;GS 仍常用</td>
</tr>
<tr>
<td>标志寄存器</td>
<td>RFLAGS</td>
<td>状态&#x2F;控制标志</td>
</tr>
<tr>
<td>控制寄存器</td>
<td>CR0, CR2, CR3, CR4, CR8…</td>
<td>内存管理、分页、特权控制</td>
</tr>
<tr>
<td>SIMD&#x2F;浮点寄存器</td>
<td>XMM0–XMM15, YMM0–YMM15, ZMM0–ZMM31, ST0–ST7</td>
<td>向量计算、浮点运算</td>
</tr>
</tbody></table>
<ul>
<li><strong>通用寄存器</strong>：CPU 的“草稿纸”。</li>
<li><strong>RIP</strong>：指令“书签”，告诉 CPU 读下一条指令。</li>
<li><strong>RSP&#x2F;RBP</strong>：函数调用的“栈工具”。</li>
<li><strong>FS&#x2F;GS</strong>：线程局部数据“起点”。</li>
<li><strong>SIMD 寄存器</strong>：并行计算的“高速计算器”。</li>
</ul>
<h4 id="基本指令"><a href="#基本指令" class="headerlink" title="基本指令"></a>基本指令</h4><p><strong>不同 CPU 有不同的指令集架构（Instruction Set Architecture, ISA）</strong>。汇编语言就是 ISA 的最底层表现形式，因此 CPU 架构不同，汇编指令也不同。所以汇编语言不是通用的，它紧密依赖 CPU 的指令集架构。换 CPU，汇编指令就会变化。</p>
<h4 id="16位CPU的基本命令"><a href="#16位CPU的基本命令" class="headerlink" title="16位CPU的基本命令"></a>16位CPU的基本命令</h4><p>16 位汇编指令（8086 指令集）是 x86 架构的最早版本，主要包括数据传送、算术逻辑、控制转移、字符串处理和处理机控制五大类。</p>
<h5 id="1-数据传送指令"><a href="#1-数据传送指令" class="headerlink" title="1. 数据传送指令"></a>1. 数据传送指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>MOV dst, src</strong></td>
<td>数据传送，把 <code>src</code> 的值送到 <code>dst</code></td>
</tr>
<tr>
<td><strong>XCHG a, b</strong></td>
<td>交换两个寄存器&#x2F;内存操作数的值</td>
</tr>
<tr>
<td><strong>PUSH reg&#x2F;mem&#x2F;imm</strong></td>
<td>将操作数压入栈，<code>SP</code> 自动减 2</td>
</tr>
<tr>
<td><strong>POP reg&#x2F;mem</strong></td>
<td>将栈顶数据弹出到目的操作数，<code>SP</code> 自动加 2</td>
</tr>
<tr>
<td><strong>IN AL&#x2F;AX, port</strong></td>
<td>从端口读入数据到 AL&#x2F;AX</td>
</tr>
<tr>
<td><strong>OUT port, AL&#x2F;AX</strong></td>
<td>将 AL&#x2F;AX 的内容输出到端口</td>
</tr>
<tr>
<td><strong>LEA reg, mem</strong></td>
<td>装入有效地址（即偏移量），常用于指针运算</td>
</tr>
<tr>
<td><strong>LDS reg, mem</strong></td>
<td>从内存中取一个 32 位的指针（段:偏移）到寄存器和 DS</td>
</tr>
<tr>
<td><strong>LES reg, mem</strong></td>
<td>同上，但段寄存器为 ES</td>
</tr>
</tbody></table>
<hr>
<h5 id="2-算术运算指令"><a href="#2-算术运算指令" class="headerlink" title="2. 算术运算指令"></a>2. 算术运算指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ADD dst, src</strong></td>
<td>加法，<code>dst = dst + src</code></td>
</tr>
<tr>
<td><strong>ADC dst, src</strong></td>
<td>带进位加法，<code>dst = dst + src + CF</code></td>
</tr>
<tr>
<td><strong>SUB dst, src</strong></td>
<td>减法，<code>dst = dst - src</code></td>
</tr>
<tr>
<td><strong>SBB dst, src</strong></td>
<td>带借位减法，<code>dst = dst - src - CF</code></td>
</tr>
<tr>
<td><strong>INC reg&#x2F;mem</strong></td>
<td>自增 1</td>
</tr>
<tr>
<td><strong>DEC reg&#x2F;mem</strong></td>
<td>自减 1</td>
</tr>
<tr>
<td><strong>MUL reg&#x2F;mem</strong></td>
<td>无符号乘法，隐含操作数 AX；结果放在 AX 或 DX:AX</td>
</tr>
<tr>
<td><strong>IMUL reg&#x2F;mem</strong></td>
<td>有符号乘法</td>
</tr>
<tr>
<td><strong>DIV reg&#x2F;mem</strong></td>
<td>无符号除法，结果：商在 AL&#x2F;AX，余数在 AH&#x2F;DX</td>
</tr>
<tr>
<td><strong>IDIV reg&#x2F;mem</strong></td>
<td>有符号除法</td>
</tr>
<tr>
<td><strong>NEG reg&#x2F;mem</strong></td>
<td>取负，等于 <code>0 - 操作数</code></td>
</tr>
<tr>
<td><strong>CMP a, b</strong></td>
<td>比较（执行 <code>a - b</code>，结果不保存，只修改标志位）</td>
</tr>
</tbody></table>
<hr>
<h5 id="3-逻辑与位操作指令"><a href="#3-逻辑与位操作指令" class="headerlink" title="3. 逻辑与位操作指令"></a>3. 逻辑与位操作指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>AND a, b</strong></td>
<td>按位与</td>
</tr>
<tr>
<td><strong>OR a, b</strong></td>
<td>按位或</td>
</tr>
<tr>
<td><strong>XOR a, b</strong></td>
<td>按位异或</td>
</tr>
<tr>
<td><strong>NOT a</strong></td>
<td>按位取反</td>
</tr>
<tr>
<td><strong>TEST a, b</strong></td>
<td>按位与，但结果不保存，仅修改标志位</td>
</tr>
<tr>
<td><strong>SHL&#x2F;SAL a, n</strong></td>
<td>左移（逻辑&#x2F;算术左移相同），低位补 0</td>
</tr>
<tr>
<td><strong>SHR a, n</strong></td>
<td>逻辑右移，高位补 0</td>
</tr>
<tr>
<td><strong>SAR a, n</strong></td>
<td>算术右移，高位补符号位</td>
</tr>
<tr>
<td><strong>ROL a, n</strong></td>
<td>循环左移</td>
</tr>
<tr>
<td><strong>ROR a, n</strong></td>
<td>循环右移</td>
</tr>
<tr>
<td><strong>RCL a, n</strong></td>
<td>带进位循环左移</td>
</tr>
<tr>
<td><strong>RCR a, n</strong></td>
<td>带进位循环右移</td>
</tr>
</tbody></table>
<hr>
<h5 id="4-控制转移指令"><a href="#4-控制转移指令" class="headerlink" title="4. 控制转移指令"></a>4. 控制转移指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>JMP label</strong></td>
<td>无条件跳转到指定地址</td>
</tr>
<tr>
<td><strong>CALL label</strong></td>
<td>调用子程序（压栈返回地址，然后跳转）</td>
</tr>
<tr>
<td><strong>RET</strong></td>
<td>从子程序返回（弹出返回地址并跳转）</td>
</tr>
<tr>
<td><strong>INT n</strong></td>
<td>触发软件中断 n（调用中断向量表中的服务程序）</td>
</tr>
<tr>
<td><strong>IRET</strong></td>
<td>从中断返回（恢复标志、CS、IP）</td>
</tr>
</tbody></table>
<p>条件跳转（根据标志位决定是否跳转）：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>条件（FLAGS）</th>
</tr>
</thead>
<tbody><tr>
<td><strong>JE&#x2F;JZ</strong></td>
<td>等于 &#x2F; 零标志 ZF&#x3D;1</td>
</tr>
<tr>
<td><strong>JNE&#x2F;JNZ</strong></td>
<td>不等 &#x2F; 非零 ZF&#x3D;0</td>
</tr>
<tr>
<td><strong>JC</strong></td>
<td>有进位 CF&#x3D;1</td>
</tr>
<tr>
<td><strong>JNC</strong></td>
<td>无进位 CF&#x3D;0</td>
</tr>
<tr>
<td><strong>JS</strong></td>
<td>负数 SF&#x3D;1</td>
</tr>
<tr>
<td><strong>JNS</strong></td>
<td>非负数 SF&#x3D;0</td>
</tr>
<tr>
<td><strong>JO</strong></td>
<td>溢出 OF&#x3D;1</td>
</tr>
<tr>
<td><strong>JNO</strong></td>
<td>无溢出 OF&#x3D;0</td>
</tr>
<tr>
<td><strong>JG&#x2F;JNLE</strong></td>
<td>大于（有符号）ZF&#x3D;0 且 SF&#x3D;OF</td>
</tr>
<tr>
<td><strong>JL&#x2F;JNGE</strong></td>
<td>小于（有符号）SF≠OF</td>
</tr>
<tr>
<td><strong>JGE&#x2F;JNL</strong></td>
<td>大于等于（有符号）SF&#x3D;OF</td>
</tr>
<tr>
<td><strong>JLE&#x2F;JNG</strong></td>
<td>小于等于（有符号）ZF&#x3D;1 或 SF≠OF</td>
</tr>
<tr>
<td><strong>JA</strong></td>
<td>大于（无符号）CF&#x3D;0 且 ZF&#x3D;0</td>
</tr>
<tr>
<td><strong>JB</strong></td>
<td>小于（无符号）CF&#x3D;1</td>
</tr>
<tr>
<td><strong>JAE</strong></td>
<td>大于等于（无符号）CF&#x3D;0</td>
</tr>
<tr>
<td><strong>JBE</strong></td>
<td>小于等于（无符号）CF&#x3D;1 或 ZF&#x3D;1</td>
</tr>
</tbody></table>
<hr>
<h5 id="5-字符串操作指令"><a href="#5-字符串操作指令" class="headerlink" title="5. 字符串操作指令"></a>5. 字符串操作指令</h5><p>和 <strong>SI（源）、DI（目的）、CX（计数器）、DF（方向标志）</strong> 联用，常配合 <strong>REP&#x2F;REPE&#x2F;REPNE</strong>。</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>MOVS&#x2F;MOVSB&#x2F;MOVSW</strong></td>
<td>从 DS:SI 指向的内存传送到 ES:DI，自动更新 SI&#x2F;DI</td>
</tr>
<tr>
<td><strong>CMPS&#x2F;CMPSB&#x2F;CMPSW</strong></td>
<td>比较 DS:SI 和 ES:DI 的数据</td>
</tr>
<tr>
<td><strong>SCAS&#x2F;SCASB&#x2F;SCASW</strong></td>
<td>用 AL&#x2F;AX 与 ES:DI 的数据比较</td>
</tr>
<tr>
<td><strong>LODS&#x2F;LODSB&#x2F;LODSW</strong></td>
<td>取 DS:SI 的数据放到 AL&#x2F;AX</td>
</tr>
<tr>
<td><strong>STOS&#x2F;STOSB&#x2F;STOSW</strong></td>
<td>把 AL&#x2F;AX 的数据存到 ES:DI</td>
</tr>
</tbody></table>
<p>前缀：</p>
<ul>
<li><strong>REP</strong>：重复执行，直到 CX&#x3D;0</li>
<li><strong>REPE&#x2F;REPZ</strong>：当相等且 CX≠0 时继续</li>
<li><strong>REPNE&#x2F;REPNZ</strong>：当不相等且 CX≠0 时继续</li>
</ul>
<hr>
<h5 id="6-处理机控制指令"><a href="#6-处理机控制指令" class="headerlink" title="6. 处理机控制指令"></a>6. 处理机控制指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CLC</strong></td>
<td>清除进位标志 CF&#x3D;0</td>
</tr>
<tr>
<td><strong>STC</strong></td>
<td>置位进位标志 CF&#x3D;1</td>
</tr>
<tr>
<td><strong>CMC</strong></td>
<td>进位标志取反 CF&#x3D;¬CF</td>
</tr>
<tr>
<td><strong>CLD</strong></td>
<td>清除方向标志 DF&#x3D;0（字符串操作递增）</td>
</tr>
<tr>
<td><strong>STD</strong></td>
<td>设置方向标志 DF&#x3D;1（字符串操作递减）</td>
</tr>
<tr>
<td><strong>CLI</strong></td>
<td>禁止中断 IF&#x3D;0</td>
</tr>
<tr>
<td><strong>STI</strong></td>
<td>允许中断 IF&#x3D;1</td>
</tr>
<tr>
<td><strong>HLT</strong></td>
<td>处理器停止，等待中断&#x2F;复位唤醒</td>
</tr>
<tr>
<td><strong>NOP</strong></td>
<td>空操作（占位用，不做任何事）</td>
</tr>
</tbody></table>
<h4 id="32位CPU的基本命令"><a href="#32位CPU的基本命令" class="headerlink" title="32位CPU的基本命令"></a>32位CPU的基本命令</h4><h5 id="1-数据传送指令-1"><a href="#1-数据传送指令-1" class="headerlink" title="1. 数据传送指令"></a>1. 数据传送指令</h5><p>和 16 位类似，只是寄存器换成 32 位（EAX、EBX、ECX、EDX、ESI、EDI、ESP、EBP）：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>MOV dst, src</strong></td>
<td>传送数据</td>
</tr>
<tr>
<td><strong>XCHG a, b</strong></td>
<td>交换两个操作数</td>
</tr>
<tr>
<td><strong>PUSH&#x2F;POP reg&#x2F;mem&#x2F;imm32</strong></td>
<td>压栈&#x2F;出栈，<code>ESP</code> 自动 ±4</td>
</tr>
<tr>
<td><strong>PUSHAD &#x2F; POPAD</strong></td>
<td>压入&#x2F;弹出所有 32 位通用寄存器</td>
</tr>
<tr>
<td><strong>IN&#x2F;OUT</strong></td>
<td>I&#x2F;O 端口读写</td>
</tr>
<tr>
<td><strong>LEA reg, [mem]</strong></td>
<td>装入有效地址（偏移量）</td>
</tr>
<tr>
<td><strong>MOVZX&#x2F;MOVSX</strong></td>
<td>零扩展&#x2F;符号扩展传送（从小操作数 → 大操作数）</td>
</tr>
</tbody></table>
<hr>
<h5 id="2-算术运算指令-1"><a href="#2-算术运算指令-1" class="headerlink" title="2. 算术运算指令"></a>2. 算术运算指令</h5><p>基本和 16 位一致，只是操作数可以是 32 位。</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ADD &#x2F; ADC</strong></td>
<td>加 &#x2F; 带进位加</td>
</tr>
<tr>
<td><strong>SUB &#x2F; SBB</strong></td>
<td>减 &#x2F; 带借位减</td>
</tr>
<tr>
<td><strong>INC &#x2F; DEC</strong></td>
<td>自增 &#x2F; 自减</td>
</tr>
<tr>
<td><strong>MUL &#x2F; IMUL</strong></td>
<td>乘法（无符号 &#x2F; 有符号）</td>
</tr>
<tr>
<td><strong>DIV &#x2F; IDIV</strong></td>
<td>除法（无符号 &#x2F; 有符号）</td>
</tr>
<tr>
<td><strong>NEG</strong></td>
<td>取负</td>
</tr>
<tr>
<td><strong>CMP</strong></td>
<td>比较（结果不保存，仅改标志位）</td>
</tr>
</tbody></table>
<p> 新增：</p>
<ul>
<li><strong>BSWAP reg32</strong>：字节反转（如 <code>12345678h → 78563412h</code>）</li>
<li><strong>IMUL reg, imm32</strong>：支持立即数乘法，简化了算式编译</li>
</ul>
<hr>
<h5 id="3-逻辑与位操作指令-1"><a href="#3-逻辑与位操作指令-1" class="headerlink" title="3. 逻辑与位操作指令"></a>3. 逻辑与位操作指令</h5><p>和 16 位相同，但支持 32 位操作数，另外增加了一些 <strong>位扫描&#x2F;测试类</strong>：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>AND &#x2F; OR &#x2F; XOR &#x2F; NOT</strong></td>
<td>与 &#x2F; 或 &#x2F; 异或 &#x2F; 取反</td>
</tr>
<tr>
<td><strong>TEST</strong></td>
<td>按位与，只改标志</td>
</tr>
<tr>
<td><strong>SHL&#x2F;SAL &#x2F; SHR &#x2F; SAR</strong></td>
<td>移位</td>
</tr>
<tr>
<td><strong>ROL &#x2F; ROR &#x2F; RCL &#x2F; RCR</strong></td>
<td>循环移位（可带进位）</td>
</tr>
<tr>
<td><strong>BT &#x2F; BTS &#x2F; BTR &#x2F; BTC</strong></td>
<td>位测试、置位、复位、取反（Bit Test &amp; Set&#x2F;Reset&#x2F;Complement）</td>
</tr>
<tr>
<td><strong>BSF &#x2F; BSR</strong></td>
<td>找到第一个&#x2F;最后一个置位的比特位</td>
</tr>
</tbody></table>
<hr>
<h5 id="4-控制转移指令-1"><a href="#4-控制转移指令-1" class="headerlink" title="4. 控制转移指令"></a>4. 控制转移指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>JMP label</strong></td>
<td>无条件跳转</td>
</tr>
<tr>
<td><strong>CALL &#x2F; RET</strong></td>
<td>子程序调用与返回</td>
</tr>
<tr>
<td><strong>INT n &#x2F; IRET</strong></td>
<td>中断调用与返回</td>
</tr>
<tr>
<td><strong>LOOP&#x2F;LOOPZ&#x2F;LOOPNZ</strong></td>
<td>用 ECX 循环计数器控制的循环跳转</td>
</tr>
<tr>
<td><strong>条件跳转 Jcc</strong></td>
<td>和 16 位一样，支持 JE&#x2F;JNE&#x2F;JG&#x2F;JL&#x2F;JA&#x2F;JB 等</td>
</tr>
</tbody></table>
<p>特点：</p>
<ul>
<li><strong>偏移量可以是 8 位或 32 位</strong>（16 位时代是 8 位或 16 位）。</li>
<li><strong>CALL &#x2F; JMP 支持远指针（段:偏移）</strong>，但保护模式下主要用选择子（Selector）。</li>
</ul>
<hr>
<h5 id="5-字符串操作指令（增强）"><a href="#5-字符串操作指令（增强）" class="headerlink" title="5. 字符串操作指令（增强）"></a>5. 字符串操作指令（增强）</h5><p>继承 16 位的串操作，但寄存器扩展为 32 位：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>MOVSD</strong></td>
<td>传送双字（4 字节）串</td>
</tr>
<tr>
<td><strong>STOSD</strong></td>
<td>存储双字</td>
</tr>
<tr>
<td><strong>LODSD</strong></td>
<td>装入双字</td>
</tr>
<tr>
<td><strong>SCASD</strong></td>
<td>扫描双字</td>
</tr>
<tr>
<td><strong>CMPSD</strong></td>
<td>比较双字</td>
</tr>
</tbody></table>
<p>可配合 <code>REP/REPE/REPNE</code>，和 16 位类似。</p>
<hr>
<h5 id="6-处理机控制指令-1"><a href="#6-处理机控制指令-1" class="headerlink" title="6. 处理机控制指令"></a>6. 处理机控制指令</h5><p>在 80386 引入了保护模式，因此多了一些控制类指令：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CLC&#x2F;STC&#x2F;CMC</strong></td>
<td>清除&#x2F;设置&#x2F;取反进位标志</td>
</tr>
<tr>
<td><strong>CLD&#x2F;STD</strong></td>
<td>清除&#x2F;设置方向标志</td>
</tr>
<tr>
<td><strong>CLI&#x2F;STI</strong></td>
<td>禁止&#x2F;允许中断</td>
</tr>
<tr>
<td><strong>HLT</strong></td>
<td>停机，等待中断</td>
</tr>
<tr>
<td><strong>NOP</strong></td>
<td>空操作</td>
</tr>
<tr>
<td><strong>LGDT &#x2F; SGDT</strong></td>
<td>加载&#x2F;保存全局描述符表寄存器 GDTR</td>
</tr>
<tr>
<td><strong>LIDT &#x2F; SIDT</strong></td>
<td>加载&#x2F;保存中断描述符表寄存器 IDTR</td>
</tr>
<tr>
<td><strong>LLDT &#x2F; SLDT</strong></td>
<td>加载&#x2F;保存局部描述符表寄存器 LDTR</td>
</tr>
<tr>
<td><strong>LTR &#x2F; STR</strong></td>
<td>加载&#x2F;保存任务寄存器 TR</td>
</tr>
<tr>
<td><strong>MOV CRx, reg &#x2F; MOV reg, CRx</strong></td>
<td>控制寄存器 CR0–CR4 的访问（分页、保护模式相关）</td>
</tr>
</tbody></table>
<h4 id="64位CPU的基本指令"><a href="#64位CPU的基本指令" class="headerlink" title="64位CPU的基本指令"></a>64位CPU的基本指令</h4><h5 id="1-数据传送指令-2"><a href="#1-数据传送指令-2" class="headerlink" title="1. 数据传送指令"></a>1. 数据传送指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>MOV r64, r&#x2F;m64 &#x2F; imm64</td>
<td>数据传送，支持 64 位立即数</td>
</tr>
<tr>
<td>XCHG r64, r&#x2F;m64</td>
<td>交换两个操作数</td>
</tr>
<tr>
<td>PUSH r64 &#x2F; POP r64</td>
<td>压栈&#x2F;出栈（栈指针 RSP ± 8）</td>
</tr>
<tr>
<td>PUSHFQ &#x2F; POPFQ</td>
<td>压栈&#x2F;出栈 RFLAGS（64 位）</td>
</tr>
<tr>
<td>LEA r64, [mem]</td>
<td>取内存有效地址（常用于指针&#x2F;数组计算）</td>
</tr>
<tr>
<td>MOVZX &#x2F; MOVSX &#x2F; MOVSXD</td>
<td>零扩展&#x2F;符号扩展（特别是 MOVSXD 从 32 位 → 64 位）</td>
</tr>
</tbody></table>
<hr>
<h5 id="2-算术运算指令-2"><a href="#2-算术运算指令-2" class="headerlink" title="2. 算术运算指令"></a>2. 算术运算指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ADD &#x2F; ADC</td>
<td>加 &#x2F; 带进位加</td>
</tr>
<tr>
<td>SUB &#x2F; SBB</td>
<td>减 &#x2F; 带借位减</td>
</tr>
<tr>
<td>INC &#x2F; DEC</td>
<td>自增 &#x2F; 自减</td>
</tr>
<tr>
<td>NEG</td>
<td>取负</td>
</tr>
<tr>
<td>CMP</td>
<td>比较（只修改标志位）</td>
</tr>
<tr>
<td>MUL &#x2F; IMUL</td>
<td>乘法（无符号&#x2F;有符号）</td>
</tr>
<tr>
<td>DIV &#x2F; IDIV</td>
<td>除法（无符号&#x2F;有符号）</td>
</tr>
<tr>
<td>BSWAP r64</td>
<td>字节反转（大端&#x2F;小端转换）</td>
</tr>
<tr>
<td>POPCNT</td>
<td>统计 1 的个数（SSE4.2+）</td>
</tr>
<tr>
<td>LZCNT &#x2F; TZCNT</td>
<td>前导零&#x2F;尾随零计数（BMI 指令集）</td>
</tr>
</tbody></table>
<hr>
<h5 id="3-逻辑与位操作指令-2"><a href="#3-逻辑与位操作指令-2" class="headerlink" title="3. 逻辑与位操作指令"></a>3. 逻辑与位操作指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>AND &#x2F; OR &#x2F; XOR &#x2F; NOT</td>
<td>按位逻辑运算</td>
</tr>
<tr>
<td>TEST</td>
<td>按位与，不保存结果，仅改标志</td>
</tr>
<tr>
<td>SHL &#x2F; SHR &#x2F; SAR</td>
<td>移位（逻辑&#x2F;算术）</td>
</tr>
<tr>
<td>ROL &#x2F; ROR &#x2F; RCL &#x2F; RCR</td>
<td>循环移位（可带进位）</td>
</tr>
<tr>
<td>BT &#x2F; BTS &#x2F; BTR &#x2F; BTC</td>
<td>位测试&#x2F;置位&#x2F;复位&#x2F;取反</td>
</tr>
<tr>
<td>BSF &#x2F; BSR</td>
<td>位扫描（找第一个&#x2F;最后一个 1 位）</td>
</tr>
</tbody></table>
<hr>
<h5 id="4-控制转移指令-2"><a href="#4-控制转移指令-2" class="headerlink" title="4. 控制转移指令"></a>4. 控制转移指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>JMP label</td>
<td>无条件跳转（支持 64 位地址）</td>
</tr>
<tr>
<td>CALL &#x2F; RET</td>
<td>调用子程序 &#x2F; 返回</td>
</tr>
<tr>
<td>INT n &#x2F; IRETQ</td>
<td>软件中断 &#x2F; 中断返回</td>
</tr>
<tr>
<td>Jcc</td>
<td>条件跳转（JE&#x2F;JNE&#x2F;JG&#x2F;JL&#x2F;JA&#x2F;JB 等）</td>
</tr>
<tr>
<td>LOOP &#x2F; LOOPE &#x2F; LOOPNE</td>
<td>用 RCX 控制循环</td>
</tr>
<tr>
<td>RIP 相对寻址</td>
<td>64 位特有，用于位置无关代码（PIC）</td>
</tr>
</tbody></table>
<hr>
<h5 id="5-字符串操作指令（64-位版本）"><a href="#5-字符串操作指令（64-位版本）" class="headerlink" title="5. 字符串操作指令（64 位版本）"></a>5. 字符串操作指令（64 位版本）</h5><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>MOVSQ</td>
<td>传送 8 字节（Quadword）</td>
</tr>
<tr>
<td>STOSQ</td>
<td>存储 8 字节</td>
</tr>
<tr>
<td>LODSQ</td>
<td>装入 8 字节</td>
</tr>
<tr>
<td>SCASQ</td>
<td>扫描 8 字节</td>
</tr>
<tr>
<td>CMPSQ</td>
<td>比较 8 字节</td>
</tr>
<tr>
<td>REP&#x2F;REPE&#x2F;REPNE 前缀</td>
<td>串操作重复执行（由 RCX 控制次数）</td>
</tr>
</tbody></table>
<hr>
<h5 id="6-处理机控制指令-2"><a href="#6-处理机控制指令-2" class="headerlink" title="6. 处理机控制指令"></a>6. 处理机控制指令</h5><table>
<thead>
<tr>
<th>指令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>CLC &#x2F; STC &#x2F; CMC</td>
<td>清除&#x2F;设置&#x2F;取反进位标志</td>
</tr>
<tr>
<td>CLD &#x2F; STD</td>
<td>清除&#x2F;设置方向标志</td>
</tr>
<tr>
<td>CLI &#x2F; STI</td>
<td>禁止&#x2F;允许中断</td>
</tr>
<tr>
<td>HLT</td>
<td>停机，等待中断</td>
</tr>
<tr>
<td>NOP</td>
<td>空操作</td>
</tr>
<tr>
<td>SYSCALL &#x2F; SYSRET</td>
<td>系统调用&#x2F;返回（64 位新增）</td>
</tr>
<tr>
<td>SYSENTER &#x2F; SYSEXIT</td>
<td>快速系统调用</td>
</tr>
<tr>
<td>SWAPGS</td>
<td>用户态&#x2F;内核态切换时交换 GS 基址</td>
</tr>
<tr>
<td>CPUID</td>
<td>查询 CPU 信息</td>
</tr>
<tr>
<td>RDMSR &#x2F; WRMSR</td>
<td>读&#x2F;写 MSR（模型特定寄存器）</td>
</tr>
<tr>
<td>RDTSC &#x2F; RDTSCP</td>
<td>读取时间戳计数器</td>
</tr>
</tbody></table>
<h2 id="C与汇编"><a href="#C与汇编" class="headerlink" title="C与汇编"></a>C与汇编</h2><p>下面是一个很简单的一个加法功能实现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)</span>&#123;<br>    <span class="hljs-keyword">return</span> a+b;<br>&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> a,b;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;a) != <span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;b) != <span class="hljs-number">1</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    sum(a,b);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这是所对应的汇编命令：</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><code class="hljs tap">$ objdump -d t<br><br>t：     文件格式 elf64-x86-64<br><br><br>Disassembly of section .init:<br><br>0000000000001000 &lt;_init&gt;:<br>    1000:       f3 0f 1e fa             endbr64 <br>    1004:      <span class="hljs-number"> 48 </span>83 ec<span class="hljs-number"> 08 </span>            sub    $0x8,%rsp<br>    1008:      <span class="hljs-number"> 48 </span>8b<span class="hljs-number"> 05 </span>d9 2f<span class="hljs-number"> 00 </span>00    mov    0x2fd9(%rip),%rax        <span class="hljs-comment"># 3fe8 &lt;__gmon_start__&gt;</span><br>    100f:      <span class="hljs-number"> 48 </span>85 c0                test   %rax,%rax<br>    1012:      <span class="hljs-number"> 74 </span>02                   je    <span class="hljs-number"> 1016 </span>&lt;_init+0x16&gt;<br>    1014:       ff d0                   callq  *%rax<br>    1016:      <span class="hljs-number"> 48 </span>83 c4<span class="hljs-number"> 08 </span>            add    $0x8,%rsp<br>    101a:       c3                      retq   <br><br>Disassembly of section .plt:<br><br>0000000000001020 &lt;.plt&gt;:<br>    1020:       ff<span class="hljs-number"> 35 </span>8a 2f<span class="hljs-number"> 00 </span>00       pushq  0x2f8a(%rip)        <span class="hljs-comment"># 3fb0 &lt;_GLOBAL_OFFSET_TABLE_+0x8&gt;</span><br>    1026:       f2 ff<span class="hljs-number"> 25 </span>8b 2f<span class="hljs-number"> 00 </span>00    bnd jmpq *0x2f8b(%rip)        <span class="hljs-comment"># 3fb8 &lt;_GLOBAL_OFFSET_TABLE_+0x10&gt;</span><br>    102d:       0f 1f<span class="hljs-number"> 00 </span>               nopl   (%rax)<br>    1030:       f3 0f 1e fa             endbr64 <br>    1034:      <span class="hljs-number"> 68 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>         pushq  $0x0<br>    1039:       f2 e9 e1 ff ff ff       bnd jmpq<span class="hljs-number"> 1020 </span>&lt;.plt&gt;<br>    103f:      <span class="hljs-number"> 90 </span>                     nop<br>    1040:       f3 0f 1e fa             endbr64 <br>    1044:      <span class="hljs-number"> 68 </span>01<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>         pushq  $0x1<br>    1049:       f2 e9 d1 ff ff ff       bnd jmpq<span class="hljs-number"> 1020 </span>&lt;.plt&gt;<br>    104f:      <span class="hljs-number"> 90 </span>                     nop<br>    1050:       f3 0f 1e fa             endbr64 <br>    1054:      <span class="hljs-number"> 68 </span>02<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>         pushq  $0x2<br>    1059:       f2 e9 c1 ff ff ff       bnd jmpq<span class="hljs-number"> 1020 </span>&lt;.plt&gt;<br>    105f:      <span class="hljs-number"> 90 </span>                     nop<br><br>Disassembly of section .plt.got:<br><br>0000000000001060 &lt;__cxa_finalize@plt&gt;:<br>    1060:       f3 0f 1e fa             endbr64 <br>    1064:       f2 ff<span class="hljs-number"> 25 </span>8d 2f<span class="hljs-number"> 00 </span>00    bnd jmpq *0x2f8d(%rip)        <span class="hljs-comment"># 3ff8 &lt;__cxa_finalize@GLIBC_2.2.5&gt;</span><br>    106b:       0f 1f<span class="hljs-number"> 44 </span>00<span class="hljs-number"> 00 </span>         nopl   0x0(%rax,%rax,1)<br><br>Disassembly of section .plt.sec:<br><br>0000000000001070 &lt;__stack_chk_fail@plt&gt;:<br>    1070:       f3 0f 1e fa             endbr64 <br>    1074:       f2 ff<span class="hljs-number"> 25 </span>45 2f<span class="hljs-number"> 00 </span>00    bnd jmpq *0x2f45(%rip)        <span class="hljs-comment"># 3fc0 &lt;__stack_chk_fail@GLIBC_2.4&gt;</span><br>    107b:       0f 1f<span class="hljs-number"> 44 </span>00<span class="hljs-number"> 00 </span>         nopl   0x0(%rax,%rax,1)<br><br>0000000000001080 &lt;__printf_chk@plt&gt;:<br>    1080:       f3 0f 1e fa             endbr64 <br>    1084:       f2 ff<span class="hljs-number"> 25 </span>3d 2f<span class="hljs-number"> 00 </span>00    bnd jmpq *0x2f3d(%rip)        <span class="hljs-comment"># 3fc8 &lt;__printf_chk@GLIBC_2.3.4&gt;</span><br>    108b:       0f 1f<span class="hljs-number"> 44 </span>00<span class="hljs-number"> 00 </span>         nopl   0x0(%rax,%rax,1)<br><br>0000000000001090 &lt;__isoc99_scanf@plt&gt;:<br>    1090:       f3 0f 1e fa             endbr64 <br>    1094:       f2 ff<span class="hljs-number"> 25 </span>35 2f<span class="hljs-number"> 00 </span>00    bnd jmpq *0x2f35(%rip)        <span class="hljs-comment"># 3fd0 &lt;__isoc99_scanf@GLIBC_2.7&gt;</span><br>    109b:       0f 1f<span class="hljs-number"> 44 </span>00<span class="hljs-number"> 00 </span>         nopl   0x0(%rax,%rax,1)<br><br>Disassembly of section .text:<br><br>00000000000010a0 &lt;_start&gt;:<br>    10a0:       f3 0f 1e fa             endbr64 <br>    10a4:      <span class="hljs-number"> 31 </span>ed                   xor    %ebp,%ebp<br>    10a6:      <span class="hljs-number"> 49 </span>89 d1                mov    %rdx,%r9<br>    10a9:       5e                      pop    %rsi<br>    10aa:      <span class="hljs-number"> 48 </span>89 e2                mov    %rsp,%rdx<br>    10ad:      <span class="hljs-number"> 48 </span>83 e4 f0             and    $0xfffffffffffffff0,%rsp<br>    10b1:      <span class="hljs-number"> 50 </span>                     push   %rax<br>    10b2:      <span class="hljs-number"> 54 </span>                     push   %rsp<br>    10b3:       4c 8d<span class="hljs-number"> 05 </span>f6<span class="hljs-number"> 01 </span>00<span class="hljs-number"> 00 </span>   lea    0x1f6(%rip),%r8        <span class="hljs-comment"># 12b0 &lt;__libc_csu_fini&gt;</span><br>    10ba:      <span class="hljs-number"> 48 </span>8d 0d 7f<span class="hljs-number"> 01 </span>00<span class="hljs-number"> 00 </span>   lea    0x17f(%rip),%rcx        <span class="hljs-comment"># 1240 &lt;__libc_csu_init&gt;</span><br>    10c1:      <span class="hljs-number"> 48 </span>8d 3d c9<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   lea    0xc9(%rip),%rdi        <span class="hljs-comment"># 1191 &lt;main&gt;</span><br>    10c8:       ff<span class="hljs-number"> 15 </span>12 2f<span class="hljs-number"> 00 </span>00       callq  *0x2f12(%rip)        <span class="hljs-comment"># 3fe0 &lt;__libc_start_main@GLIBC_2.2.5&gt;</span><br>    10ce:       f4                      hlt    <br>    10cf:      <span class="hljs-number"> 90 </span>                     nop<br><br>00000000000010d0 &lt;deregister_tm_clones&gt;:<br>    10d0:      <span class="hljs-number"> 48 </span>8d 3d<span class="hljs-number"> 39 </span>2f<span class="hljs-number"> 00 </span>00    lea    0x2f39(%rip),%rdi        <span class="hljs-comment"># 4010 &lt;__TMC_END__&gt;</span><br>    10d7:      <span class="hljs-number"> 48 </span>8d<span class="hljs-number"> 05 </span>32 2f<span class="hljs-number"> 00 </span>00    lea    0x2f32(%rip),%rax        <span class="hljs-comment"># 4010 &lt;__TMC_END__&gt;</span><br>    10de:      <span class="hljs-number"> 48 </span>39 f8                cmp    %rdi,%rax<br>    10e1:      <span class="hljs-number"> 74 </span>15                   je     10f8 &lt;deregister_tm_clones+0x28&gt;<br>    10e3:      <span class="hljs-number"> 48 </span>8b<span class="hljs-number"> 05 </span>ee 2e<span class="hljs-number"> 00 </span>00    mov    0x2eee(%rip),%rax        <span class="hljs-comment"># 3fd8 &lt;_ITM_deregisterTMCloneTable&gt;</span><br>    10ea:      <span class="hljs-number"> 48 </span>85 c0                test   %rax,%rax<br>    10ed:      <span class="hljs-number"> 74 </span>09                   je     10f8 &lt;deregister_tm_clones+0x28&gt;<br>    10ef:       ff e0                   jmpq   *%rax<br>    10f1:       0f 1f<span class="hljs-number"> 80 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   nopl   0x0(%rax)<br>    10f8:       c3                      retq   <br>    10f9:       0f 1f<span class="hljs-number"> 80 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   nopl   0x0(%rax)<br><br>0000000000001100 &lt;register_tm_clones&gt;:<br>    1100:      <span class="hljs-number"> 48 </span>8d 3d<span class="hljs-number"> 09 </span>2f<span class="hljs-number"> 00 </span>00    lea    0x2f09(%rip),%rdi        <span class="hljs-comment"># 4010 &lt;__TMC_END__&gt;</span><br>    1107:      <span class="hljs-number"> 48 </span>8d<span class="hljs-number"> 35 </span>02 2f<span class="hljs-number"> 00 </span>00    lea    0x2f02(%rip),%rsi        <span class="hljs-comment"># 4010 &lt;__TMC_END__&gt;</span><br>    110e:      <span class="hljs-number"> 48 </span>29 fe                sub    %rdi,%rsi<br>    1111:      <span class="hljs-number"> 48 </span>89 f0                mov    %rsi,%rax<br>    1114:      <span class="hljs-number"> 48 </span>c1 ee 3f             shr    $0x3f,%rsi<br>    1118:      <span class="hljs-number"> 48 </span>c1 f8<span class="hljs-number"> 03 </span>            sar    $0x3,%rax<br>    111c:      <span class="hljs-number"> 48 </span>01 c6                add    %rax,%rsi<br>    111f:      <span class="hljs-number"> 48 </span>d1 fe                sar    %rsi<br>    1122:      <span class="hljs-number"> 74 </span>14                   je    <span class="hljs-number"> 1138 </span>&lt;register_tm_clones+0x38&gt;<br>    1124:      <span class="hljs-number"> 48 </span>8b<span class="hljs-number"> 05 </span>c5 2e<span class="hljs-number"> 00 </span>00    mov    0x2ec5(%rip),%rax        <span class="hljs-comment"># 3ff0 &lt;_ITM_registerTMCloneTable&gt;</span><br>    112b:      <span class="hljs-number"> 48 </span>85 c0                test   %rax,%rax<br>    112e:      <span class="hljs-number"> 74 </span>08                   je    <span class="hljs-number"> 1138 </span>&lt;register_tm_clones+0x38&gt;<br>    1130:       ff e0                   jmpq   *%rax<br>    1132:      <span class="hljs-number"> 66 </span>0f 1f<span class="hljs-number"> 44 </span>00<span class="hljs-number"> 00 </span>      nopw   0x0(%rax,%rax,1)<br>    1138:       c3                      retq   <br>    1139:       0f 1f<span class="hljs-number"> 80 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   nopl   0x0(%rax)<br><br>0000000000001140 &lt;__do_global_dtors_aux&gt;:<br>    1140:       f3 0f 1e fa             endbr64 <br>    1144:      <span class="hljs-number"> 80 </span>3d c5 2e<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   cmpb   $0x0,0x2ec5(%rip)        <span class="hljs-comment"># 4010 &lt;__TMC_END__&gt;</span><br>    114b:      <span class="hljs-number"> 75 </span>2b                   jne   <span class="hljs-number"> 1178 </span>&lt;__do_global_dtors_aux+0x38&gt;<br>    114d:      <span class="hljs-number"> 55 </span>                     push   %rbp<br>    114e:      <span class="hljs-number"> 48 </span>83 3d a2 2e<span class="hljs-number"> 00 </span>00    cmpq   $0x0,0x2ea2(%rip)        <span class="hljs-comment"># 3ff8 &lt;__cxa_finalize@GLIBC_2.2.5&gt;</span><br>    1155:      <span class="hljs-number"> 00 </span><br>    1156:      <span class="hljs-number"> 48 </span>89 e5                mov    %rsp,%rbp<br>    1159:      <span class="hljs-number"> 74 </span>0c                   je    <span class="hljs-number"> 1167 </span>&lt;__do_global_dtors_aux+0x27&gt;<br>    115b:      <span class="hljs-number"> 48 </span>8b 3d a6 2e<span class="hljs-number"> 00 </span>00    mov    0x2ea6(%rip),%rdi        <span class="hljs-comment"># 4008 &lt;__dso_handle&gt;</span><br>    1162:       e8 f9 fe ff ff          callq <span class="hljs-number"> 1060 </span>&lt;__cxa_finalize@plt&gt;<br>    1167:       e8<span class="hljs-number"> 64 </span>ff ff ff          callq  10d0 &lt;deregister_tm_clones&gt;<br>    116c:       c6<span class="hljs-number"> 05 </span>9d 2e<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 01 </span>   movb   $0x1,0x2e9d(%rip)        <span class="hljs-comment"># 4010 &lt;__TMC_END__&gt;</span><br>    1173:       5d                      pop    %rbp<br>    1174:       c3                      retq   <br>    1175:       0f 1f<span class="hljs-number"> 00 </span>               nopl   (%rax)<br>    1178:       c3                      retq   <br>    1179:       0f 1f<span class="hljs-number"> 80 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   nopl   0x0(%rax)<br><br>0000000000001180 &lt;frame_dummy&gt;:<br>    1180:       f3 0f 1e fa             endbr64 <br>    1184:       e9<span class="hljs-number"> 77 </span>ff ff ff          jmpq  <span class="hljs-number"> 1100 </span>&lt;register_tm_clones&gt;<br><br>0000000000001189 &lt;sum&gt;:<br>    1189:       f3 0f 1e fa             endbr64 <br>    118d:       8d<span class="hljs-number"> 04 </span>37                lea    (%rdi,%rsi,1),%eax<br>    1190:       c3                      retq   <br><br>0000000000001191 &lt;main&gt;:<br>    1191:       f3 0f 1e fa             endbr64 <br>    1195:      <span class="hljs-number"> 53 </span>                     push   %rbx<br>    1196:      <span class="hljs-number"> 48 </span>83 ec<span class="hljs-number"> 10 </span>            sub    $0x10,%rsp<br>    119a:      <span class="hljs-number"> 64 </span>48 8b<span class="hljs-number"> 04 </span>25<span class="hljs-number"> 28 </span>00    mov    %fs:0x28,%rax<br>    11a1:      <span class="hljs-number"> 00 </span>00 <br>    11a3:      <span class="hljs-number"> 48 </span>89<span class="hljs-number"> 44 </span>24<span class="hljs-number"> 08 </span>         mov    %rax,0x8(%rsp)<br>    11a8:      <span class="hljs-number"> 31 </span>c0                   xor    %eax,%eax<br>    11aa:      <span class="hljs-number"> 48 </span>89 e6                mov    %rsp,%rsi<br>    11ad:      <span class="hljs-number"> 48 </span>8d 3d<span class="hljs-number"> 50 </span>0e<span class="hljs-number"> 00 </span>00    lea    0xe50(%rip),%rdi        <span class="hljs-comment"># 2004 &lt;_IO_stdin_used+0x4&gt;</span><br>    11b4:       e8 d7 fe ff ff          callq <span class="hljs-number"> 1090 </span>&lt;__isoc99_scanf@plt&gt;<br>    11b9:      <span class="hljs-number"> 83 </span>f8<span class="hljs-number"> 01 </span>               cmp    $0x1,%eax<br>    11bc:      <span class="hljs-number"> 74 </span>33                   je     11f1 &lt;main+0x60&gt;<br>    11be:      <span class="hljs-number"> 48 </span>8d<span class="hljs-number"> 35 </span>42 0e<span class="hljs-number"> 00 </span>00    lea    0xe42(%rip),%rsi        <span class="hljs-comment"># 2007 &lt;_IO_stdin_used+0x7&gt;</span><br>    11c5:       bf<span class="hljs-number"> 01 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x1,%edi<br>    11ca:       b8<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x0,%eax<br>    11cf:       e8 ac fe ff ff          callq <span class="hljs-number"> 1080 </span>&lt;__printf_chk@plt&gt;<br>    11d4:       bb<span class="hljs-number"> 01 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x1,%ebx<br>    11d9:      <span class="hljs-number"> 48 </span>8b<span class="hljs-number"> 44 </span>24<span class="hljs-number"> 08 </span>         mov    0x8(%rsp),%rax<br>    11de:      <span class="hljs-number"> 64 </span>48<span class="hljs-number"> 33 </span>04<span class="hljs-number"> 25 </span>28<span class="hljs-number"> 00 </span>   xor    %fs:0x28,%rax<br>    11e5:      <span class="hljs-number"> 00 </span>00 <br>    11e7:      <span class="hljs-number"> 75 </span>44                   jne    122d &lt;main+0x9c&gt;<br>    11e9:      <span class="hljs-number"> 89 </span>d8                   mov    %ebx,%eax<br>    11eb:      <span class="hljs-number"> 48 </span>83 c4<span class="hljs-number"> 10 </span>            add    $0x10,%rsp<br>    11ef:       5b                      pop    %rbx<br>    11f0:       c3                      retq   <br>    11f1:      <span class="hljs-number"> 89 </span>c3                   mov    %eax,%ebx<br>    11f3:      <span class="hljs-number"> 48 </span>8d<span class="hljs-number"> 74 </span>24<span class="hljs-number"> 04 </span>         lea    0x4(%rsp),%rsi<br>    11f8:      <span class="hljs-number"> 48 </span>8d 3d<span class="hljs-number"> 05 </span>0e<span class="hljs-number"> 00 </span>00    lea    0xe05(%rip),%rdi        <span class="hljs-comment"># 2004 &lt;_IO_stdin_used+0x4&gt;</span><br>    11ff:       b8<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x0,%eax<br>    1204:       e8<span class="hljs-number"> 87 </span>fe ff ff          callq <span class="hljs-number"> 1090 </span>&lt;__isoc99_scanf@plt&gt;<br>    1209:      <span class="hljs-number"> 83 </span>f8<span class="hljs-number"> 01 </span>               cmp    $0x1,%eax<br>    120c:      <span class="hljs-number"> 75 </span>07                   jne   <span class="hljs-number"> 1215 </span>&lt;main+0x84&gt;<br>    120e:       bb<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x0,%ebx<br>    1213:       eb c4                   jmp    11d9 &lt;main+0x48&gt;<br>    1215:      <span class="hljs-number"> 48 </span>8d<span class="hljs-number"> 35 </span>eb 0d<span class="hljs-number"> 00 </span>00    lea    0xdeb(%rip),%rsi        <span class="hljs-comment"># 2007 &lt;_IO_stdin_used+0x7&gt;</span><br>    121c:       bf<span class="hljs-number"> 01 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x1,%edi<br>    1221:       b8<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00          mov    $0x0,%eax<br>    1226:       e8<span class="hljs-number"> 55 </span>fe ff ff          callq <span class="hljs-number"> 1080 </span>&lt;__printf_chk@plt&gt;<br>    122b:       eb ac                   jmp    11d9 &lt;main+0x48&gt;<br>    122d:       e8 3e fe ff ff          callq <span class="hljs-number"> 1070 </span>&lt;__stack_chk_fail@plt&gt;<br>    1232:      <span class="hljs-number"> 66 </span>2e 0f 1f<span class="hljs-number"> 84 </span>00<span class="hljs-number"> 00 </span>   nopw   %cs:0x0(%rax,%rax,1)<br>    1239:      <span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span><br>    123c:       0f 1f<span class="hljs-number"> 40 </span>00             nopl   0x0(%rax)<br><br>0000000000001240 &lt;__libc_csu_init&gt;:<br>    1240:       f3 0f 1e fa             endbr64 <br>    1244:      <span class="hljs-number"> 41 </span>57                   push   %r15<br>    1246:       4c 8d 3d 5b 2b<span class="hljs-number"> 00 </span>00    lea    0x2b5b(%rip),%r15        <span class="hljs-comment"># 3da8 &lt;__frame_dummy_init_array_entry&gt;</span><br>    124d:      <span class="hljs-number"> 41 </span>56                   push   %r14<br>    124f:      <span class="hljs-number"> 49 </span>89 d6                mov    %rdx,%r14<br>    1252:      <span class="hljs-number"> 41 </span>55                   push   %r13<br>    1254:      <span class="hljs-number"> 49 </span>89 f5                mov    %rsi,%r13<br>    1257:      <span class="hljs-number"> 41 </span>54                   push   %r12<br>    1259:      <span class="hljs-number"> 41 </span>89 fc                mov    %edi,%r12d<br>    125c:      <span class="hljs-number"> 55 </span>                     push   %rbp<br>    125d:      <span class="hljs-number"> 48 </span>8d 2d 4c 2b<span class="hljs-number"> 00 </span>00    lea    0x2b4c(%rip),%rbp        <span class="hljs-comment"># 3db0 &lt;__do_global_dtors_aux_fini_array_entry&gt;</span><br>    1264:      <span class="hljs-number"> 53 </span>                     push   %rbx<br>    1265:       4c<span class="hljs-number"> 29 </span>fd                sub    %r15,%rbp<br>    1268:      <span class="hljs-number"> 48 </span>83 ec<span class="hljs-number"> 08 </span>            sub    $0x8,%rsp<br>    126c:       e8 8f fd ff ff          callq <span class="hljs-number"> 1000 </span>&lt;_init&gt;<br>    1271:      <span class="hljs-number"> 48 </span>c1 fd<span class="hljs-number"> 03 </span>            sar    $0x3,%rbp<br>    1275:      <span class="hljs-number"> 74 </span>1f                   je    <span class="hljs-number"> 1296 </span>&lt;__libc_csu_init+0x56&gt;<br>    1277:      <span class="hljs-number"> 31 </span>db                   xor    %ebx,%ebx<br>    1279:       0f 1f<span class="hljs-number"> 80 </span>00<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>   nopl   0x0(%rax)<br>    1280:       4c<span class="hljs-number"> 89 </span>f2                mov    %r14,%rdx<br>    1283:       4c<span class="hljs-number"> 89 </span>ee                mov    %r13,%rsi<br>    1286:      <span class="hljs-number"> 44 </span>89 e7                mov    %r12d,%edi<br>    1289:      <span class="hljs-number"> 41 </span>ff<span class="hljs-number"> 14 </span>df             callq  *(%r15,%rbx,8)<br>    128d:      <span class="hljs-number"> 48 </span>83 c3<span class="hljs-number"> 01 </span>            add    $0x1,%rbx<br>    1291:      <span class="hljs-number"> 48 </span>39 dd                cmp    %rbx,%rbp<br>    1294:      <span class="hljs-number"> 75 </span>ea                   jne   <span class="hljs-number"> 1280 </span>&lt;__libc_csu_init+0x40&gt;<br>    1296:      <span class="hljs-number"> 48 </span>83 c4<span class="hljs-number"> 08 </span>            add    $0x8,%rsp<br>    129a:       5b                      pop    %rbx<br>    129b:       5d                      pop    %rbp<br>    129c:      <span class="hljs-number"> 41 </span>5c                   pop    %r12<br>    129e:      <span class="hljs-number"> 41 </span>5d                   pop    %r13<br>    12a0:      <span class="hljs-number"> 41 </span>5e                   pop    %r14<br>    12a2:      <span class="hljs-number"> 41 </span>5f                   pop    %r15<br>    12a4:       c3                      retq   <br>    12a5:      <span class="hljs-number"> 66 </span>66 2e 0f 1f<span class="hljs-number"> 84 </span>00    data16 nopw %cs:0x0(%rax,%rax,1)<br>    12ac:      <span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>00 <br><br>00000000000012b0 &lt;__libc_csu_fini&gt;:<br>    12b0:       f3 0f 1e fa             endbr64 <br>    12b4:       c3                      retq   <br><br>Disassembly of section .fini:<br><br>00000000000012b8 &lt;_fini&gt;:<br>    12b8:       f3 0f 1e fa             endbr64 <br>    12bc:      <span class="hljs-number"> 48 </span>83 ec<span class="hljs-number"> 08 </span>            sub    $0x8,%rsp<br>    12c0:      <span class="hljs-number"> 48 </span>83 c4<span class="hljs-number"> 08 </span>            add    $0x8,%rsp<br>    12c4:       c3                      retq   <br></code></pre></td></tr></table></figure>

<p>C 代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">sum</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span>&#123;<br>    <span class="hljs-keyword">return</span> a+b;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>汇编（反汇编片段）：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0000000000001189</span> &lt;sum&gt;:<br>    <span class="hljs-attribute">1189</span>:   f3 <span class="hljs-number">0</span>f <span class="hljs-number">1</span>e fa             endbr64 <br>    <span class="hljs-attribute">118d</span>:   <span class="hljs-number">8</span>d <span class="hljs-number">04</span> <span class="hljs-number">37</span>                lea    (%rdi,%rsi,<span class="hljs-number">1</span>),%eax<br>    <span class="hljs-attribute">1190</span>:   c3                      retq<br></code></pre></td></tr></table></figure>

<p>解释：</p>
<ul>
<li><code>rdi</code> 和 <code>rsi</code> 在 x86-64 System V ABI 中是 <strong>前两个整数参数</strong>（<code>a</code> 和 <code>b</code>）。</li>
<li><code>lea (%rdi,%rsi,1),%eax</code> 计算 <code>rdi + rsi</code>，结果放进 <code>eax</code>（函数返回值寄存器）。</li>
<li><code>retq</code> 返回。</li>
</ul>
<p>C 代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">int</span> a,b;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;a);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;b);<br>    sum(a,b);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>汇编关键部分：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">0000000000001191</span> &lt;main&gt;:<br>    <span class="hljs-number">1191</span>:   f<span class="hljs-number">3</span> <span class="hljs-number">0</span>f <span class="hljs-number">1</span>e fa             endbr<span class="hljs-number">64</span> <br>    <span class="hljs-number">1195</span>:   <span class="hljs-number">53</span>                      push   <span class="hljs-variable">%rbx</span><br>    <span class="hljs-number">1196</span>:   <span class="hljs-number">48</span> <span class="hljs-number">83</span> ec <span class="hljs-number">10</span>             <span class="hljs-keyword">sub</span>    $<span class="hljs-number">0x10</span><span class="hljs-punctuation">,</span><span class="hljs-variable">%rsp</span>   <span class="hljs-comment">; 栈上分配16字节，给局部变量用</span><br><br>    <span class="hljs-comment">; --- 第一次 scanf ---</span><br>    <span class="hljs-number">11</span>aa:   <span class="hljs-number">48</span> <span class="hljs-number">89</span> e<span class="hljs-number">6</span>                mov    <span class="hljs-variable">%rsp</span><span class="hljs-punctuation">,</span><span class="hljs-variable">%rsi</span>    <span class="hljs-comment">; 把 &amp;a 放到 rsi（第二个参数）</span><br>    <span class="hljs-number">11</span>ad:   <span class="hljs-number">48</span> <span class="hljs-number">8</span>d <span class="hljs-number">3</span>d <span class="hljs-number">50</span> <span class="hljs-number">0</span>e <span class="hljs-number">00</span> <span class="hljs-number">00</span>    lea    <span class="hljs-number">0xe50</span>(<span class="hljs-variable">%rip</span>)<span class="hljs-punctuation">,</span><span class="hljs-variable">%rdi</span> <span class="hljs-comment">; rdi = &quot;%d&quot; 的地址</span><br>    <span class="hljs-number">11</span>b<span class="hljs-number">4</span>:   e<span class="hljs-number">8</span> d<span class="hljs-number">7</span> fe ff ff          callq  <span class="hljs-number">1090</span> &lt;__isoc<span class="hljs-number">99</span>_scanf<span class="hljs-title">@plt</span>&gt;<br><br>    <span class="hljs-comment">; --- 检查返回值（如果 scanf 没读到数，会走 printf）---</span><br>    <span class="hljs-number">11</span>b<span class="hljs-number">9</span>:   <span class="hljs-number">83</span> f<span class="hljs-number">8</span> <span class="hljs-number">01</span>                cmp    $<span class="hljs-number">0x1</span><span class="hljs-punctuation">,</span><span class="hljs-variable">%eax</span>    <span class="hljs-comment">; scanf 返回值和 1 比较</span><br>    <span class="hljs-number">11</span>bc:   <span class="hljs-number">74</span> <span class="hljs-number">33</span>                   je     <span class="hljs-number">11</span>f<span class="hljs-number">1</span> &lt;main<span class="hljs-number">+0</span><span class="hljs-keyword">x</span><span class="hljs-number">60</span>&gt;<br><br>    <span class="hljs-comment">; --- 错误时打印 ---</span><br>    <span class="hljs-number">11</span><span class="hljs-keyword">c</span><span class="hljs-number">5</span>:   bf <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>          mov    $<span class="hljs-number">0x1</span><span class="hljs-punctuation">,</span><span class="hljs-variable">%edi</span><br>    <span class="hljs-number">11</span>cf:   e<span class="hljs-number">8</span> ac fe ff ff          callq  <span class="hljs-number">1080</span> &lt;__printf_chk<span class="hljs-title">@plt</span>&gt;<br>    ...<br><br>    <span class="hljs-comment">; --- 第二次 scanf ---</span><br>    <span class="hljs-number">11</span>f<span class="hljs-number">3</span>:   <span class="hljs-number">48</span> <span class="hljs-number">8</span>d <span class="hljs-number">74</span> <span class="hljs-number">24</span> <span class="hljs-number">04</span>          lea    <span class="hljs-number">0x4</span>(<span class="hljs-variable">%rsp</span>)<span class="hljs-punctuation">,</span><span class="hljs-variable">%rsi</span>   <span class="hljs-comment">; &amp;b</span><br>    <span class="hljs-number">11</span>f<span class="hljs-number">8</span>:   <span class="hljs-number">48</span> <span class="hljs-number">8</span>d <span class="hljs-number">3</span>d <span class="hljs-number">05</span> <span class="hljs-number">0</span>e <span class="hljs-number">00</span> <span class="hljs-number">00</span>    lea    <span class="hljs-number">0xe05</span>(<span class="hljs-variable">%rip</span>)<span class="hljs-punctuation">,</span><span class="hljs-variable">%rdi</span> <span class="hljs-comment">; &quot;%d&quot;</span><br>    <span class="hljs-number">1204</span>:   e<span class="hljs-number">8</span> <span class="hljs-number">87</span> fe ff ff          callq  <span class="hljs-number">1090</span> &lt;__isoc<span class="hljs-number">99</span>_scanf<span class="hljs-title">@plt</span>&gt;<br>    ...<br>    <span class="hljs-comment">; --- 调 sum ---</span><br>    (这里调用 sum 结果其实被优化掉了，因为你没用 sum(a<span class="hljs-punctuation">,</span>b) 的返回值)<br></code></pre></td></tr></table></figure>

<hr>
<p><strong>结合 C 和汇编的理解</strong></p>
<ol>
<li><strong>C 里的局部变量 <code>a, b</code> → 栈上分配</strong><ul>
<li><code>sub $0x10,%rsp</code> 给 <code>a</code> 和 <code>b</code> 留了空间</li>
<li><code>&amp;a</code> → <code>rsp</code></li>
<li><code>&amp;b</code> → <code>rsp+4</code></li>
</ul>
</li>
<li><strong>scanf(“%d”, &amp;a) → 调用外部函数</strong><ul>
<li><code>%d</code> 的格式字符串地址放到 <code>rdi</code>（第1参数）</li>
<li><code>&amp;a</code> 放到 <code>rsi</code>（第2参数）</li>
<li>然后 <code>call __isoc99_scanf@plt</code></li>
</ul>
</li>
<li><strong>函数调用规范（System V AMD64 ABI）</strong><ul>
<li>前 6 个整数参数：<code>rdi, rsi, rdx, rcx, r8, r9</code></li>
<li>返回值：放在 <code>rax</code></li>
</ul>
</li>
<li><strong>sum(a, b) → 内联优化</strong><ul>
<li><code>sum</code> 的实现就是 <code>a+b</code></li>
<li>编译器可能直接用 <code>lea</code> 计算了，不会真的存储调用结果（因为没用它）。</li>
</ul>
</li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/pwn/" class="print-no-link">#-pwn</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>pwn学习小记（1）</div>
      <div>https://eznp.github.io/2025/10/04/pwn学习小记（1）/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Zer0</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月4日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/22/java%E5%85%A5%E9%97%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="java入门反序列化">
                        <span class="hidden-mobile">java入门反序列化</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
